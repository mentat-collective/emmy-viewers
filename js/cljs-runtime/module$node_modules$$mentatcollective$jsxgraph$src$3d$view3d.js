shadow$provide.module$node_modules$$mentatcollective$jsxgraph$src$3d$view3d=function(global,require,module,exports){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0});exports.default=void 0;var _jxg=_interopRequireDefault(require("module$node_modules$$mentatcollective$jsxgraph$src$jxg"));_interopRequireDefault(require("module$node_modules$$mentatcollective$jsxgraph$src$options"));var _constants=_interopRequireDefault(require("module$node_modules$$mentatcollective$jsxgraph$src$base$constants")),
_type=_interopRequireDefault(require("module$node_modules$$mentatcollective$jsxgraph$src$utils$type")),_math=_interopRequireDefault(require("module$node_modules$$mentatcollective$jsxgraph$src$math$math"));global=_interopRequireDefault(require("module$node_modules$$mentatcollective$jsxgraph$src$base$element"));var _composition=_interopRequireDefault(require("module$node_modules$$mentatcollective$jsxgraph$src$base$composition"));_jxg.default.View3D=function(board,parents,attributes){this.constructor(board,
attributes,_constants.default.OBJECT_TYPE_VIEW3D,_constants.default.OBJECT_CLASS_3D);this.objects={};this.objectsList=[];this.elementsByName={};this.defaultAxes=null;this.matrix3D=[[1,0,0,0],[0,1,0,0],[0,0,1,0]];this.llftCorner=parents[0];this.size=parents[1];this.bbox3D=parents[2];this.r=-1;this.timeoutAzimuth=null;this.id=this.board.setId(this,"V");this.board.finalizeAdding(this);this.elType="view3d";this.methodMap=_type.default.deepCopy(this.methodMap,{})};_jxg.default.View3D.prototype=new global.default;
_jxg.default.extend(_jxg.default.View3D.prototype,{create:function(elementType,parents,attributes){var prefix=[];0<elementType.indexOf("3d")&&prefix.push(this);return this.board.create(elementType,prefix.concat(parents),attributes)},select:function(str,onlyByIdOrName){var i;if(null===str)return str;if(_type.default.isString(str)&&""!==str)_type.default.exists(this.objects[str])?str=this.objects[str]:_type.default.exists(this.elementsByName[str])&&(str=this.elementsByName[str]);else if(!onlyByIdOrName&&
(_type.default.isFunction(str)||_type.default.isObject(str)&&!_type.default.isFunction(str.setAttribute))){onlyByIdOrName=_type.default.filterElements(this.objectsList,str);str={};var l=onlyByIdOrName.length;for(i=0;i<l;i++)str[onlyByIdOrName[i].id]=onlyByIdOrName[i];str=new _composition.default(str)}else _type.default.isObject(str)&&_type.default.exists(str.id)&&!_type.default.exists(this.objects[str.id])&&(str=null);return str},update:function(){if(!_type.default.exists(this.el_slide)||!_type.default.exists(this.az_slide)||
!this.needsUpdate)return this;var e=this.el_slide.Value();var r=this.r;var a=this.az_slide.Value();var f=r*Math.sin(e);var mat=[[1,0,0],[0,1,0],[0,0,1]];this.matrix3D=[[1,0,0,0],[0,1,0,0],[0,0,1,0]];this.matrix3D[1][1]=r*Math.cos(a);this.matrix3D[1][2]=-r*Math.sin(a);this.matrix3D[2][1]=f*Math.sin(a);this.matrix3D[2][2]=f*Math.cos(a);this.matrix3D[2][3]=Math.cos(e);mat[1][1]=this.size[0]/(this.bbox3D[0][1]-this.bbox3D[0][0]);mat[2][2]=this.size[1]/(this.bbox3D[1][1]-this.bbox3D[1][0]);mat[1][0]=this.llftCorner[0]-
mat[1][1]*this.bbox3D[0][0];mat[2][0]=this.llftCorner[1]-mat[2][2]*this.bbox3D[1][0];this.matrix3D=_math.default.matMatMult(mat,this.matrix3D);return this},updateRenderer:function(){this.needsUpdate=!1;return this},project3DTo2D:function(x,y,z){var vec=3===arguments.length?[1,x,y,z]:3===x.length?[1].concat(x):x;return _math.default.matVecMult(this.matrix3D,vec)},project2DTo3DPlane:function(point2d,normal,foot){var n=normal.slice(1);normal=[1,0,0,0];foot=foot||[1,0,0,0];var d=_math.default.norm(n,
3);d=_math.default.innerProduct(foot.slice(1),n,3)/d;foot=this.matrix3D.slice(0,3);foot.push([0].concat(n));point2d=point2d.coords.usrCoords.concat([d]);try{1===foot[2][3]&&(foot[2][1]=foot[2][2]=.001*_math.default.eps),normal=_math.default.Numerics.Gauss(foot,point2d)}catch(err){normal=[0,NaN,NaN,NaN]}return normal},project3DToCube:function(c3d){var cube=this.bbox3D;c3d[1]<cube[0][0]&&(c3d[1]=cube[0][0]);c3d[1]>cube[0][1]&&(c3d[1]=cube[0][1]);c3d[2]<cube[1][0]&&(c3d[2]=cube[1][0]);c3d[2]>cube[1][1]&&
(c3d[2]=cube[1][1]);c3d[3]<cube[2][0]&&(c3d[3]=cube[2][0]);c3d[3]>cube[2][1]&&(c3d[3]=cube[2][1]);return c3d},intersectionLineCube:function(p,d,r){var i;var rnew=r;for(i=0;3>i;i++)if(0!==d[i]){var r0=(this.bbox3D[i][0]-p[i])/d[i];var r1=(this.bbox3D[i][1]-p[i])/d[i];rnew=0>r?Math.max(rnew,Math.min(r0,r1)):Math.min(rnew,Math.max(r0,r1))}return rnew},isInCube:function(q){return q[0]>this.bbox3D[0][0]-_math.default.eps&&q[0]<this.bbox3D[0][1]+_math.default.eps&&q[1]>this.bbox3D[1][0]-_math.default.eps&&
q[1]<this.bbox3D[1][1]+_math.default.eps&&q[2]>this.bbox3D[2][0]-_math.default.eps&&q[2]<this.bbox3D[2][1]+_math.default.eps},intersectionPlanePlane:function(plane1,plane2,d){var ret=[[],[]];d=d||plane2.d;d=_math.default.Geometry.meet3Planes(plane1.normal,plane1.d,plane2.normal,d,_math.default.crossProduct(plane1.normal,plane2.normal),0);plane1=_math.default.Geometry.meetPlanePlane(plane1.vec1,plane1.vec2,plane2.vec1,plane2.vec2);plane2=this.intersectionLineCube(d,plane1,Infinity);plane2=_math.default.axpy(plane2,
plane1,d);this.isInCube(plane2)&&(ret[0]=plane2);plane2=this.intersectionLineCube(d,plane1,-Infinity);plane2=_math.default.axpy(plane2,plane1,d);this.isInCube(plane2)&&(ret[1]=plane2);return ret},getMesh:function(func,interval_u,interval_v){var i_u,i_v,steps_u=interval_u[2],steps_v=interval_v[2],dataX=[],dataY=[];var delta_u=(_type.default.evaluate(interval_u[1])-_type.default.evaluate(interval_u[0]))/steps_u;var delta_v=(_type.default.evaluate(interval_v[1])-_type.default.evaluate(interval_v[0]))/
steps_v;for(i_u=0;i_u<=steps_u;i_u++){var u=interval_u[0]+delta_u*i_u;for(i_v=0;i_v<=steps_v;i_v++){var v=interval_v[0]+delta_v*i_v;var c2d=_type.default.isFunction(func)?func(u,v):[func[0](u,v),func[1](u,v),func[2](u,v)];c2d=this.project3DTo2D(c2d);dataX.push(c2d[1]);dataY.push(c2d[2])}dataX.push(NaN);dataY.push(NaN)}for(i_v=0;i_v<=steps_v;i_v++){v=interval_v[0]+delta_v*i_v;for(i_u=0;i_u<=steps_u;i_u++)u=interval_u[0]+delta_u*i_u,c2d=_type.default.isFunction(func)?func(u,v):[func[0](u,v),func[1](u,
v),func[2](u,v)],c2d=this.project3DTo2D(c2d),dataX.push(c2d[1]),dataY.push(c2d[2]);dataX.push(NaN);dataY.push(NaN)}return[dataX,dataY]},animateAzimuth:function(){var s=this.az_slide._smin,sdiff=this.az_slide._smax-s,newVal=this.az_slide.Value()+.1;this.az_slide.position=(newVal-s)/sdiff;1<this.az_slide.position&&(this.az_slide.position=0);this.board.update();this.timeoutAzimuth=setTimeout(function(){this.animateAzimuth()}.bind(this),200)},stopAzimuth:function(){clearTimeout(this.timeoutAzimuth);this.timeoutAzimuth=
null}});_jxg.default.createView3D=function(board,parents,attributes){var y$jscomp$0=parents[0];var h=parents[1];var attr=_type.default.copyAttributes(attributes,board.options,"view3d");var view=new _jxg.default.View3D(board,parents,attr);view.defaultAxes=view.create("axes3d",parents,attributes);parents=y$jscomp$0[0];y$jscomp$0=y$jscomp$0[1];attributes=h[0];h=h[1];view.az_slide=board.create("slider",[[parents-1,y$jscomp$0-2],[parents+attributes+1,y$jscomp$0-2],[0,1,2*Math.PI]],{style:6,name:"az",point1:{frozen:!0},
point2:{frozen:!0}});view.el_slide=board.create("slider",[[parents-1,y$jscomp$0],[parents-1,y$jscomp$0+h],[0,.3,Math.PI/2]],{style:6,name:"el",point1:{frozen:!0},point2:{frozen:!0}});view.board.highlightInfobox=function(x,y,el){var i,brd=el.board,p=null;for(i=0;i<el.parents.length&&(p=brd.objects[el.parents[i]],!p.is3D);i++);p?(x=[1,0,0,p.coords[3]],x=view.project2DTo3DPlane(p.element2D,[1,0,0,1],x),view.isInCube(x)?(x=_type.default.evaluate(p.visProp.infoboxdigits),"auto"===x?view.board.highlightCustomInfobox("("+
_type.default.autoDigits(p.X())+" | "+_type.default.autoDigits(p.Y())+" | "+_type.default.autoDigits(p.Z())+")",p):view.board.highlightCustomInfobox("("+_type.default.toFixed(p.X(),x)+" | "+_type.default.toFixed(p.Y(),x)+" | "+_type.default.toFixed(p.Z(),x)+")",p)):view.board.highlightCustomInfobox("",p)):view.board.highlightCustomInfobox("("+x+", "+y+")",el)};view.board.update();return view};_jxg.default.registerElement("view3d",_jxg.default.createView3D);exports.default=_jxg.default.View3D}
//# sourceMappingURL=module$node_modules$$mentatcollective$jsxgraph$src$3d$view3d.js.map
