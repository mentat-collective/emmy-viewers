{"version":3,"sources":["nextjournal/viewer/mathjax.cljs"],"mappings":";;AAKA;;;;;2CAAA,3CAAKA;AAOL,wCAAA,2CAAA,qDAAA,gKAAA,kDAAA,1VAAKC;AAIL,0CAAA,1CAAMC,4FAASC;AAAf,AACE,IAAAC,gBAAA,AAAAC,8BAAA;AAAA,AAAA,IAAAC,2BAAAC;AAAA,AAAA,GAAA,CAAAD,4BAAA;AAAA;AAAA,IAAAE,yBAAAF;AAAA,AAAA,GAAA,CAAA,AAAAF,6BAAA,AAAAI;AAAA,AAAA,GAAAC;AAAA,AAAA,AAAA,EAAAC,wBAAAC,4BAAAC,eAAA,CAAA,iDAAA;;AAAA;;AAAA;;AAAA,CAAA,AAAAR,2BAAA,AAAAI;;;AAAA,IAAAK,YAAA,CAAA,AAAAT,yBAAA;eAAA,EAAA,EAAAS,eAAA,AAAAC,cAAA,AAAAV,6BAAA,SAAA,CAAAA,cAAA,8DAAA,CAAAA,cAAA,9KAAaY,wGAAI,gDAAA,hDAACC;oBAAlB,EAAA,EAAAJ,eAAA,AAAAC,cAAA,AAAAV,6BAAA,SAAA,CAAAA,cAAA,8DAAA,CAAAA,cAAA,nLACac,6GAAS,gDAAA,hDAACD;IADvBF,WAAA;+BAEM,AAACI,uDAAW,CAAClB,sEAAAA,gHAAAA,5CAAWD,4FAAAA,7TACxB,IAAAoB;IAAAC,yBAAA,CAAAD,yBAAA;AAAA,AAAA,AAAAC,4BAAAD,yBAAA;AAAA,AAAe,OAACE,sBAAOJ,cAAS,AAAWK;;;AAC/C,oBAAM,iBAAAC,oBAAA,AAAAC,gBAAMT;AAAN,AAAA,oBAAAQ;AAAA,IAAAA,wBAAA,AAAAC,gBAAWP;AAAX,AAAA,oBAAAM;AAAoBrB;;AAApBqB;;;AAAAA;;;AAAN,AACE,IAAME,UAAE,iBAAAC,WAAM3B;IAAN2B,eAAA,EAAA,CAAAA,oBAAAC,oBAAA,AAAAD,aAAA;AAAA,AAAA,QAAAA;KAAA;AACO,OAAU,AAAAF,gBAAKP,uBAASf;;;KAD/B;AAEQ,OAAY,AAAAsB,gBAAKP,yBAASf;;;;AAFlC,MAAA,KAAA0B,MAAA,CAAA,mEAAAF;;;;AAAR,AAGE,IAAAG,2BAAW,AAAA,AAAAL,gBAAeT;AAA1B,AAAA,oBAAAc;AAAA,cAAAA,VAASC;AAAT,AACE,AAAA,AAAAN,gBAAgBT,uBAAIU,QAAEK;;AACtB,AAAA,AAAAN,gBAAeT,sBAAIU;;;AANzB;;AAJF,0FAAA,mDAAA,2CAAA,mDAWc,WAAKM;AAAL,AAAS,oBAAMA;AAAN,AAAS,OAACV,sBAAON,SAAIgB;;AAArB;;;;;AAXvB,AAAAjB;;AAaF,oCAAA,pCAAMkB,gFAAQ9B;AAAd,AAAA,2BAAA,yIAAA,2CAAA,6EAAA,9KACmCD,wCAAQC","names":["nextjournal.viewer.mathjax/output-format","nextjournal.viewer.mathjax/bundle-url","nextjournal.viewer.mathjax/viewer*","value","with-let89708","reagent.ratom/with-let-values","temp__5757__auto__","reagent.ratom/*ratom-context*","c__85826__auto__","reagent.debug/has-console","reagent.debug/tracking","reagent.debug/track-console","js/console","init89709","cljs.core/not","res89710","!el","reagent.core.atom","!mathjax","js/module$node_modules$d3_require$dist$d3_require.require","obj__84046__auto__","f__84047__auto__","cljs.core/reset!","js/window","and__4251__auto__","cljs.core/deref","r","G__89717","cljs.core/Keyword","js/Error","temp__5751__auto__","c","el","nextjournal.viewer.mathjax/viewer"],"sourcesContent":["(ns nextjournal.viewer.mathjax\n  (:require [applied-science.js-interop :as j]\n            [\"d3-require\" :as d3]\n            [reagent.core :as r]))\n\n(def output-format\n  \"the output format to use. Either `:svg` or `:html`. See\n  http://docs.mathjax.org/en/latest/output/index.html for a discussion of\n  tradeoffs. `:html` is currently not showing up.\"\n  :svg)\n\n;; generated from https://nextjournal.com/a/NSFQvyN7UnNdGKoc3QMC9\n(def bundle-url\n  {:html \"https://run.nextjournalusercontent.com/data/QmaH3kKYJoHuVwUx7MYmxRFdFdvEyeJcGYFWChB3UUeDT3?filename=es5/tex-chtml-full.js&content-type=application/javascript\"\n   :svg \"https://run.nextjournalusercontent.com/data/QmQadTUYtF4JjbwhUFzQy9BQiK52ace3KqVHreUqL7ohoZ?filename=es5/tex-svg-full.js&content-type=application/javascript\"})\n\n(defn viewer* [value]\n  (r/with-let [!el (r/atom nil)\n               !mathjax (r/atom nil)]\n    (-> (d3/require (bundle-url output-format))\n        (j/call :then #(reset! !mathjax (.-MathJax js/window))))\n    (when (and @!el @!mathjax value)\n      (let [r (case output-format\n                :svg (.tex2svg ^js @!mathjax value)\n                :html (.tex2chtml ^js @!mathjax value))]\n        (if-let [c (.-firstChild @!el)]\n          (.replaceChild @!el r c)\n          (.appendChild @!el r))))\n    [:div {:ref (fn [el] (when el (reset! !el el)))}]))\n\n(defn viewer [value]\n  ^{:nextjournal/viewer :reagent} [viewer* value])\n"]}