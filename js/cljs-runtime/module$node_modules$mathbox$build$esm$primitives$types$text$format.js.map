{
"version":3,
"file":"module$node_modules$mathbox$build$esm$primitives$types$text$format.js",
"lineCount":6,
"mappings":"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",
"sources":["node_modules/mathbox/build/esm/primitives/types/text/format.js"],
"sourcesContent":["shadow$provide[\"module$node_modules$mathbox$build$esm$primitives$types$text$format\"] = function(global,require,module,exports) {\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Format = void 0;\n\nvar _constants = require(\"three/src/constants.js\");\n\nvar _operator = require(\"../operator/operator.js\");\n\n// TODO: This file was created by bulk-decaffeinate.\n// Sanity-check the conversion and remove this comment.\n\n/*\n * decaffeinate suggestions:\n * DS102: Remove unnecessary code created because of implicit returns\n * DS206: Consider reworking classes to avoid initClass\n * DS207: Consider shorter variations of null checks\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/master/docs/suggestions.md\n */\nclass Format extends _operator.Operator {\n  static initClass() {\n    this.traits = [\"node\", \"bind\", \"operator\", \"texture\", \"text\", \"format\", \"font\"];\n    this.defaults = {\n      minFilter: \"linear\",\n      magFilter: \"linear\"\n    };\n  }\n\n  init() {\n    super.init();\n    this.atlas = this.buffer = this.used = this.time = null;\n    return this.filled = false;\n  }\n\n  sourceShader(shader) {\n    return this.buffer.shader(shader);\n  }\n\n  textShader(shader) {\n    return this.atlas.shader(shader);\n  }\n\n  textIsSDF() {\n    return this.props.sdf > 0;\n  }\n\n  textHeight() {\n    return this.props.detail;\n  }\n\n  make() {\n    // Bind to attached data sources    # super()\n    this._helpers.bind.make([{\n      to: \"operator.source\",\n      trait: \"raw\"\n    }]); // Read sampling parameters\n\n\n    let {\n      minFilter,\n      magFilter,\n      type\n    } = this.props; // Read font parameters\n\n    const {\n      font,\n      style,\n      variant,\n      weight,\n      detail,\n      sdf\n    } = this.props; // Prepare text atlas\n\n    this.atlas = this._renderables.make(\"textAtlas\", {\n      font,\n      size: detail,\n      style,\n      variant,\n      weight,\n      outline: sdf,\n      minFilter,\n      magFilter,\n      type\n    }); // Underlying data buffer needs no filtering\n\n    minFilter = _constants.NearestFilter;\n    magFilter = _constants.NearestFilter;\n    type = _constants.FloatType; // Fetch geometry dimensions\n\n    const dims = this.bind.source.getDimensions();\n    const {\n      items,\n      width,\n      height,\n      depth\n    } = dims; // Create voxel buffer for text atlas coords\n\n    this.buffer = this._renderables.make(\"voxelBuffer\", {\n      width,\n      height,\n      depth,\n      channels: 4,\n      items,\n      minFilter,\n      magFilter,\n      type\n    }); // Hook buffer emitter to map atlas text\n\n    const {\n      atlas\n    } = this;\n    const {\n      emit\n    } = this.buffer.streamer;\n\n    this.buffer.streamer.emit = t => atlas.map(t, emit); // Grab parent clock\n\n\n    this.clockParent = this._inherit(\"clock\");\n    return this._listen(\"root\", \"root.update\", this.update);\n  }\n\n  made() {\n    super.made();\n    return this.resize();\n  }\n\n  unmake() {\n    super.unmake();\n\n    if (this.buffer) {\n      this.buffer.dispose();\n      this.buffer = null;\n    }\n\n    if (this.atlas) {\n      this.atlas.dispose();\n      return this.atlas = null;\n    }\n  }\n\n  update() {\n    if (this.filled && !this.props.live || !this.through) {\n      return;\n    }\n\n    this.time = this.clockParent.getTime();\n    const {\n      used\n    } = this;\n    this.atlas.begin();\n    this.used = this.through();\n    this.buffer.write(this.used);\n    this.atlas.end();\n    this.filled = true;\n\n    if (used !== this.used) {\n      return this.trigger({\n        type: \"source.resize\"\n      });\n    }\n  }\n\n  change(changed, touched, init) {\n    if (touched[\"font\"]) {\n      return this.rebuild();\n    }\n\n    if (changed[\"format.expr\"] || changed[\"format.digits\"] || changed[\"format.data\"] || init) {\n      let map;\n      let {\n        expr\n      } = this.props;\n      const {\n        digits,\n        data\n      } = this.props;\n\n      if (expr == null) {\n        if (data != null) {\n          expr = (x, y, z, w, i) => data[i];\n        } else {\n          expr = x => x;\n        }\n      }\n\n      const {\n        length\n      } = expr;\n\n      if (digits != null) {\n        expr = (expr => (x, y, z, w, i, j, k, l, t, d) => +expr(x, y, z, w, i, j, k, l, t, d).toPrecision(digits))(expr);\n      } // Stream raw source data and format it with expression\n\n\n      if (length > 8) {\n        map = (emit, x, y, z, w, i, j, k, l, _t, _d) => {\n          return emit(expr(x, y, z, w, i, j, k, l, this.time.clock, this.time.step));\n        };\n      } else {\n        map = (emit, x, y, z, w, i, j, k, l) => {\n          return emit(expr(x, y, z, w, i, j, k, l));\n        };\n      }\n\n      return this.through = this.bind.source.rawBuffer().through(map, this.buffer);\n    }\n  }\n\n}\n\nexports.Format = Format;\nFormat.initClass();\n};"],
"names":["shadow$provide","global","require","module","exports","Object","defineProperty","value","Format","_constants","_operator","Operator","initClass","traits","defaults","minFilter","magFilter","init","atlas","buffer","used","time","filled","sourceShader","shader","textShader","textIsSDF","props","sdf","textHeight","detail","make","_helpers","bind","to","trait","type","font","style","variant","weight","_renderables","size","outline","NearestFilter","FloatType","dims","source","getDimensions","items","width","height","depth","channels","emit","streamer","t","this.buffer.streamer.emit","map","clockParent","_inherit","_listen","update","made","resize","unmake","dispose","live","through","getTime","begin","write","end","trigger","change","changed","touched","rebuild","expr","digits","data","x","y","z","w","i","length","j","k","l","d","toPrecision","_t","_d","clock","step","rawBuffer"]
}
