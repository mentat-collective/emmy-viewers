{"version":3,"sources":["sicmutils/polynomial.cljc"],"mappings":"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,UAAA;;;KAAA;AAAA,OAAAA,qCAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA;;;KAAA;AAAA,OAAAA,qCAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA;;;KAAA;AAAA,OAAAA,qCAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA;;;KAAA;AAAA,OAAAA,qCAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA;;;KAAA;AAAA,OAAAA,qCAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA;;;KAAA;AAAA,OAAAA,qCAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA;;;KAAA;AAAA,OAAAA,sCAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA;;;KAAA;AAAA,OAAAA,sCAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,OAAA,CAAA,UAAA;;;KAAA;AAAA,OAAAA,sCAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,OAAA,CAAA,UAAA,OAAA,CAAA,UAAA;;;KAAA;AAAA,OAAAA,sCAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,OAAA,CAAA,UAAA,OAAA,CAAA,UAAA,OAAA,CAAA,UAAA;;;KAAA;AAAA,OAAAA,sCAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,OAAA,CAAA,UAAA,OAAA,CAAA,UAAA,OAAA,CAAA,UAAA,OAAA,CAAA,UAAA;;;KAAA;AAAA,OAAAA,sCAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,OAAA,CAAA,UAAA,OAAA,CAAA,UAAA,OAAA,CAAA,UAAA,OAAA,CAAA,UAAA,OAAA,CAAA,UAAA;;;KAAA;AAAA,OAAAA,sCAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,OAAA,CAAA,UAAA,OAAA,CAAA,UAAA,OAAA,CAAA,UAAA,OAAA,CAAA,UAAA,OAAA,CAAA,UAAA,OAAA,CAAA,UAAA;;;KAAA;AAAA,OAAAA,sCAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,OAAA,CAAA,UAAA,OAAA,CAAA,UAAA,OAAA,CAAA,UAAA,OAAA,CAAA,UAAA,OAAA,CAAA,UAAA,OAAA,CAAA,UAAA,OAAA,CAAA,UAAA;;;KAAA;AAAA,OAAAA,sCAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,OAAA,CAAA,UAAA,OAAA,CAAA,UAAA,OAAA,CAAA,UAAA,OAAA,CAAA,UAAA,OAAA,CAAA,UAAA,OAAA,CAAA,UAAA,OAAA,CAAA,UAAA,OAAA,CAAA,UAAA;;;KAAA;AAAA,OAAAA,sCAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,OAAA,CAAA,UAAA,OAAA,CAAA,UAAA,OAAA,CAAA,UAAA,OAAA,CAAA,UAAA,OAAA,CAAA,UAAA,OAAA,CAAA,UAAA,OAAA,CAAA,UAAA,OAAA,CAAA,UAAA,OAAA,CAAA,UAAA;;;KAAA;AAAA,OAAAA,sCAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,OAAA,CAAA,UAAA,OAAA,CAAA,UAAA,OAAA,CAAA,UAAA,OAAA,CAAA,UAAA,OAAA,CAAA,UAAA,OAAA,CAAA,UAAA,OAAA,CAAA,UAAA,OAAA,CAAA,UAAA,OAAA,CAAA,UAAA,OAAA,CAAA,UAAA;;;KAAA;AAAA,OAAAA,sCAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA,OAAA,CAAA,UAAA,OAAA,CAAA,UAAA,OAAA,CAAA,UA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","names":["cljs.core/PROTOCOL_SENTINEL","cljs.core.sequence","cljs.core/seq","cljs.core.concat","cljs.core/List","unused__20572__auto__","self__","G__86267","js/Error","args86206","cljs.core/aclone","this__4491__auto__","writer__4492__auto__","opt__4493__auto__","cljs.core/-write","sicmutils.polynomial/Polynomial","sicmutils.polynomial/->Polynomial","arity","terms","m","_","coefs","cljs.core.map","sicmutils.polynomial.impl/coefficient","cljs.core/boolean","cljs.core/some","sicmutils.differential/perturbed?","this","old","new","G__86208","p1__86203#","G__86209","sicmutils.polynomial/map-coefficients","sicmutils.differential/replace-tag","tag","G__86210","p1__86204#","G__86211","sicmutils.differential/extract-tangent","cljs.core/empty?","and__4251__auto__","cljs.core._EQ_","cljs.core/count","vec__86224","cljs.core.nth","term","sicmutils.polynomial.impl/constant-term?","sicmutils.value/one?","vec__86217","sicmutils.polynomial.impl/exponents","temp__5751__auto__","sicmutils.value/zero-like","sicmutils.value/one-like","one","sicmutils.polynomial.impl.make_term","sicmutils.polynomial.exponent/make","p","sicmutils.polynomial/->str","that","sicmutils.polynomial/eq","G__86278","G__86279","sicmutils.polynomial/evaluate","a","G__86280","G__86281","b","G__86282","G__86283","c","G__86284","G__86285","d","G__86286","G__86287","e","G__86288","G__86289","f","G__86290","G__86291","g","G__86293","G__86294","h","G__86296","G__86297","i","G__86298","G__86299","j","G__86302","G__86303","k","G__86313","G__86314","l","G__86317","G__86318","G__86320","G__86321","n","G__86325","G__86326","o","G__86330","G__86331","G__86332","G__86333","q","G__86336","G__86337","r","G__86338","G__86339","s","G__86340","G__86341","t","G__86345","G__86346","rest","G__86347","G__86348","cljs.core.into","x","writer","cljs.core.write_all","sicmutils.polynomial/polynomial?","sicmutils.polynomial/coeff?","sicmutils.polynomial/bare-arity","sicmutils.polynomial/bare-terms","sicmutils.polynomial/terms->polynomial","var_args","G__86354","sicmutils.polynomial/make","dense-coefficients","sicmutils.polynomial.impl/dense->terms","expts->coef","sicmutils.polynomial.impl.sparse__GT_terms","G__86361","sicmutils.polynomial/constant","sicmutils.polynomial.constant","sicmutils.polynomial.impl/constant->terms","G__86367","sicmutils.polynomial/identity","sicmutils.polynomial.identity","expts","sicmutils.polynomial/new-variables","p1__86370#","cljs.core.range","sicmutils.polynomial/from-points","xs","sicmutils.generic/simplify","sicmutils.polynomial.interpolate/lagrange","sicmutils.polynomial/linear","root","sicmutils.value/zero?","G__86374","G__86375","sicmutils.polynomial/add","sicmutils.generic/negate","sicmutils.polynomial/c*xn","sicmutils.polynomial/touchard","sicmutils.polynomial.make","p1__86379#","sicmutils.special.factorial/stirling-second-kind","sicmutils.polynomial/coeff-arity","sicmutils.polynomial/zero-degree","sicmutils.polynomial/arity","sicmutils.polynomial/->terms","cljs.core/vector?","sicmutils.polynomial/check-same-arity","poly-p?","poly-q?","ap","aq","sicmutils.util/arithmetic-ex","sicmutils.polynomial/valid-arity?","sicmutils.polynomial/validate-arity!","G__86384","sicmutils.polynomial/degree","sicmutils.polynomial.exponent.monomial_degree","sicmutils.polynomial/leading-term","cljs.core.transduce","i-degree","cljs.core/max","sicmutils.value/=","cljs.core/peek","G__86386","sicmutils.polynomial.__GT_str","n-terms","term-strs","cljs.core.take","sicmutils.polynomial.impl/term->str","suffix","clojure.string.join","sicmutils.polynomial/coefficients","or__4253__auto__","sicmutils.polynomial.exponent/empty","sicmutils.polynomial/leading-coefficient","sicmutils.polynomial/leading-exponents","sicmutils.polynomial/leading-base-coefficient","sicmutils.polynomial/trailing-coefficient","sicmutils.polynomial/lowest-degree","sicmutils.polynomial/monomial?","sicmutils.polynomial/monic?","sicmutils.polynomial/univariate?","sicmutils.polynomial/multivariate?","sicmutils.polynomial/negative?","sicmutils.generic/negative?","sicmutils.polynomial.impl/map-coefficients","G__86399","sicmutils.polynomial/map-exponents","sicmutils.polynomial.map_exponents","new-arity","sicmutils.util/illegal","f-expts","force-arity","iter__4652__auto__","s__86401","cljs.core/LazySeq","temp__5753__auto__","cljs.core/chunked-seq?","c__4650__auto__","size__4651__auto__","b__86403","cljs.core/chunk-buffer","i__86402","vec__86404","cljs.core/-nth","cljs.core/chunk-append","cljs.core/chunk-cons","cljs.core/chunk","iter__86400","cljs.core/chunk-rest","vec__86407","cljs.core/first","cljs.core/cons","cljs.core/rest","handle-constant","G__86411","sicmutils.polynomial/univariate->dense","sicmutils.polynomial.univariate__GT_dense","sicmutils.polynomial.degree","x-degree","cljs.core.repeat","acc","cljs.core/transient","cljs.core/persistent!","md","cljs.core.conj_BANG_","sicmutils.polynomial/->power-series","sicmutils.series/power-series?","sicmutils.series/power-series*","sicmutils.series.constant","sicmutils.polynomial/from-power-series","G__86418","sicmutils.series/sum","sicmutils.polynomial/scale","p1__86419#","sicmutils.generic._STAR_","sicmutils.polynomial/scale-l","p1__86420#","G__86422","sicmutils.polynomial/normalize","sicmutils.polynomial.normalize","sicmutils.polynomial/evenly-divide","sicmutils.generic/invert","G__86424","sicmutils.polynomial/reciprocal","sicmutils.polynomial.reciprocal","v","v'","sicmutils.polynomial.exponent/assoc","sicmutils.polynomial/drop-leading-term","cljs.core/pop","args__4870__auto__","len__4864__auto__","i__4865__auto__","argseq__4871__auto__","cljs.core/IndexedSeq","sicmutils.polynomial/binary-combine","p__86430","map__86431","cljs.core/--destructure-map","cljs.core.get","seq86425","G__86426","cljs.core/next","G__86427","G__86428","G__86429","self__4851__auto__","coeff-op","terms-op","->poly","l-poly?","r-poly?","G__86432","G__86433","G__86434","G__86435","G__86436","G__86437","G__86438","G__86439","G__86440","G__86441","G__86442","G__86443","sicmutils.polynomial/negate","sicmutils.polynomial/abs","sicmutils.generic/add","sicmutils.polynomial.impl/add","sicmutils.polynomial/sub","sicmutils.generic/sub","sicmutils.polynomial.impl/sub","sicmutils.polynomial/mul","sicmutils.generic/mul","sicmutils.polynomial.impl/mul","sicmutils.polynomial/square","sicmutils.polynomial/cube","sicmutils.polynomial/expt","answer","cljs.core/even?","cljs.core/quot","sicmutils.generic/expt","sicmutils.value/native-integral?","expt-iter","sicmutils.polynomial/divide","u","sicmutils.generic/quotient","sicmutils.generic/remainder","sicmutils.polynomial.binary_combine","coeff:div","sicmutils.polynomial.impl/div","p__86446","vec__86447","sicmutils.polynomial/divisible?","vec__86453","vec__86456","sicmutils.util/illegal-state","sicmutils.polynomial/->big","sicmutils.value/integral?","sicmutils.util/bigint","sicmutils.polynomial/pseudo-remainder","vec__86459","vn-expts","vn-coeff","*vn","remainder","sicmutils.polynomial/contractible?","sicmutils.polynomial/contract","p1__86464#","sicmutils.polynomial.exponent.lower","sicmutils.polynomial/extend","cljs.core/meta","p1__86467#","sicmutils.polynomial.exponent.raise","sicmutils.polynomial/lower-arity","A","s__86482","b__86484","i__86483","vec__86485","iter__86481","vec__86488","p1__86468#","cljs.core/group-by","p__86491","vec__86492","lower-terms","sicmutils.polynomial/raise-arity","s__86496","xs__6308__auto__","vec__86502","iterys__4648__auto__","s__86498","b__86500","i__86499","vec__86506","iter__86497","vec__86509","fs__4649__auto__","iter__86495","ys","sicmutils.polynomial/with-lower-arity","continue","result","G__86517","G__86518","sicmutils.polynomial/evaluate-1","x**e","vec__86528","e'","x**e'","sicmutils.generic._PLUS_","L","G__86537","sicmutils.polynomial/horner-with-error","z","sicmutils.polynomial.horner_with_error","cljs.core/vector","cont","next-degree","finish","np","nq","nr","ne","call","G__86548","G__86549","G__86550","G__86551","sicmutils.value/machine-epsilon","Math/abs","z-n","az-n","z-n-2","z-n-1","lc","sicmutils.polynomial/arg-scale","factors","cljs.core/=","sicmutils.polynomial/arg-shift","shifts","sicmutils.polynomial/partial-derivative","s__86563","b__86565","i__86564","vec__86566","iter__86562","vec__86578","xi","cljs.core.not_EQ_","cljs.core.dissoc","cljs.core.update","cljs.core/dec","coeff","sicmutils.polynomial/partial-derivatives","s__86592","b__86594","i__86593","iter__86591","sicmutils.polynomial/operator-table","sicmutils.util.aggregate.monoid","sicmutils.util.aggregate.group","sicmutils.generic/square","sicmutils.generic/cube","sicmutils.generic/gcd","sicmutils.generic/lcm","sicmutils.polynomial/operators-known","sicmutils.util/keyset","G__86597","sicmutils.polynomial/expression->","expr","sicmutils.polynomial.expression__GT_","cljs.core/compare","v-compare","vars","sicmutils.expression/variables-in","clojure.set.difference","sorted","cljs.core.sort","sym->var","cljs.core/zipmap","poly","sicmutils.expression/evaluate","*","sicmutils.numsymb/symbolic-operator","+","expt","sicmutils.polynomial/->expression","sicmutils.expression/expression-of","xform","p__86598","vec__86599","cljs.core.map_indexed","pow","high->low","cljs.core/rseq","sicmutils.polynomial/analyzer","js/sicmutils","js/sicmutils.polynomial","js/sicmutils.polynomial.t_sicmutils$polynomial86602","sicmutils.polynomial/t_sicmutils$polynomial86602","_86604","meta86603","sicmutils.polynomial/->t_sicmutils$polynomial86602","cljs.core/contains?","cljs.core.derive","sicmutils.polynomial/defbinary","generic-op","pairs","seq__86607","chunk__86608","count__86609","i__86610","vec__86617","c__4679__auto__","cljs.core/chunk-first","vec__86620","sicmutils.generic/abs","sicmutils.generic/exact-divide","sicmutils.generic/partial-derivative","sicmutils.value/seqtype","selectors","sicmutils.structure/down*"],"sourcesContent":["#_\"SPDX-License-Identifier: GPL-3.0\"\n\n(ns sicmutils.polynomial\n  (:refer-clojure :exclude [extend divide identity abs])\n  (:require [clojure.set :as set]\n            [clojure.string :as cs]\n            [sicmutils.collection]\n            [sicmutils.differential :as sd]\n            [sicmutils.expression :as x]\n            [sicmutils.expression.analyze :as a]\n            [sicmutils.function :as f]\n            [sicmutils.generic :as g]\n            [sicmutils.modint :as mi]\n            [sicmutils.numsymb :as sym]\n            [sicmutils.polynomial.exponent :as xpt]\n            [sicmutils.polynomial.impl :as i]\n            [sicmutils.polynomial.interpolate :as pi]\n            [sicmutils.series :as series]\n            [sicmutils.special.factorial :as sf]\n            [sicmutils.structure :as ss]\n            [sicmutils.util :as u]\n            [sicmutils.util.aggregate :as ua]\n            [sicmutils.value :as v])\n  #?(:clj\n     (:import (clojure.lang AFn IFn IObj Seqable))))\n\n;; # Flat Polynomial Form, for Commutative Rings\n;;\n;; This namespace builds up an implementation of a\n;; multivariate [polynomial](https://en.wikipedia.org/wiki/Polynomial) data\n;; structure and installs it into the tower of generic operations.\n;;\n;; Summarizing the [Wikipedia entry](https://en.wikipedia.org/wiki/Polynomial),\n;; a polynomial is an expression of any number of 'variables', or\n;; 'indeterminates' and concrete 'coefficients', combined using only the\n;; operations of addition, subtraction and multiplication of coefficients and\n;; variables.\n;;\n;; Here's an example of a polynomial of arity 2, ie, a polynomial in two\n;; variables:\n;;\n;; $$4 + 3x^2y + 5y^3 + 6x^4$$\n;;\n;; ## Terminology\n;;\n;; In the above example:\n;;\n;; - The full expression is called a 'polynomial'.\n;;\n;; - A polynomial is a sum of\n;;   many ['monomial'](https://en.wikipedia.org/wiki/Monomial) terms; these are\n;;   $4$, $3x^2y$, $5y^3$ and $6x^4$ in the example above.\n;;\n;; - Each monomial term is a product of a coefficient and a sequence of\n;;   'exponents', some product of the term's variables. The monomial $3x^2y$ has\n;;   coefficient $3$ and exponents $x^2y$.\n;;\n;; NOTE that sometimes the exponents here are called \"monomials\", without the\n;; coefficient. If you find that usage, the full 'coefficient * exponents' is\n;; usually called a 'polynomial term'.\n;;\n;; - The number of variables present in a polynomial is called the 'arity' of\n;;   the polynomial. (The arity of our example is 2.)\n;;\n;; - A polynomial with a single variable is called a 'univariate' polynomial; a\n;;   multivariable polynomial is called a 'multivariate' polynomial.\n;;\n;; - The [degree](https://en.wikipedia.org/wiki/Degree_of_a_polynomial#Multiplication)\n;;   of a monomial term is the sum of the exponents of each variable in the\n;;   term, with the special case that the [degree of a 0\n;;   term](https://en.wikipedia.org/wiki/Degree_of_a_polynomial#Degree_of_the_zero_polynomial)\n;;   is defined as -1. The degrees of each term in our example are 0, 3, 3 and\n;;   4, respectively.\n;;\n;; - The degree of a polynomial is the maximum of the degrees of the\n;;   polynomial's terms.\n;;\n;; There are, of course, more definitions! Whenever these come up in the\n;; implementation below, see the documentation for explanation.\n;;\n;; ## Implementation\n;;\n;; SICMUtils makes the following implementation choices:\n;;\n;; - The exponents of a monomial are represented by an ordered mapping of\n;;   variable index => the exponent of that variable. $x^2z^3$ is represented as\n;;   `{0 2, 2 3}`, for example. See `sicmutils.polynomial.exponent` for the full\n;;   set of operations you can perform on a term's exponents.\n;;\n;;  This representation is called `sparse` because variables with a 0 exponent\n;;  aren't included.\n;;\n;; - A monomial term is a vector of the form `[<exponents>, <coefficient>]`. The\n;;   coefficient can be any type! It's up to the user to supply coefficients\n;;   drawn from a commutative ring. See [[sicmutils.laws/ring]] for a\n;;   description of the properties coefficients should satisfy.\n;;\n;; - A polynomial is a sorted vector of monomials, sorted in some\n;;   consistent [Monomial order](https://en.wikipedia.org/wiki/Monomial_order).\n;;   See [[sicmutils.polynomial.impl/*monomial-order*]] for the current default.\n;;\n;; `sicmutils.polynomial.impl` builds up polynomial arithmetic on bare vectors\n;; of monomials, for efficiency's sake. This namespace builds this base out into\n;; a full [[Polynomial]] data structure with a fleshed-out API.\n;;\n;; To follow along in full, first read `sicmutils.polynomial.exponent`, then\n;; `sicmutils.polynomial.impl`... then come back and continue from here.\n;;\n;; ## Polynomial Type Definition\n;;\n;; As noted above, a polynomial is defined by a sorted vector of terms.\n;; The [[Polynomial]] type wraps up these `terms`, the `arity` of the polynomial\n;; and optional metadata `m`.\n\n(declare evaluate constant ->str eq map-coefficients)\n\n(deftype Polynomial [arity terms m]\n  ;; Polynomial evaluation works for any number of arguments up to and including\n  ;; the full arity. Evaluating a polynomial with fewer arguments `n` than arity\n  ;; triggers a partial evaluation of the first `n` indeterminates.\n  f/IArity\n  (arity [_] [:between 0 arity])\n\n  sd/IPerturbed\n  (perturbed? [_]\n    (let [coefs (map i/coefficient terms)]\n      (boolean (some sd/perturbed? coefs))))\n\n  (replace-tag [this old new]\n    (map-coefficients #(sd/replace-tag % old new) this))\n\n  (extract-tangent [this tag]\n    (map-coefficients #(sd/extract-tangent % tag) this))\n\n  v/Value\n  (zero? [_]\n    (empty? terms))\n\n  (one? [_]\n    (and (= (count terms) 1)\n         (let [[term] terms]\n           (and (i/constant-term? term)\n                (v/one? (i/coefficient term))))))\n\n  (identity? [_]\n    (and (v/one? arity)\n         (= (count terms) 1)\n         (let [[term] terms]\n           (and (= {0 1} (i/exponents term))\n                (v/one? (i/coefficient term))))))\n\n  (zero-like [_]\n    (if-let [term (nth terms 0)]\n      (v/zero-like (i/coefficient term))\n      0))\n\n  (one-like [_]\n    (if-let [term (nth terms 0)]\n      (v/one-like (i/coefficient term))\n      1))\n\n  (identity-like [_]\n    (assert (v/one? arity)\n            \"identity-like unsupported on multivariate monomials!\")\n    (let [one (if-let [term (nth terms 0)]\n                (v/one-like (i/coefficient term))\n                1)\n          term (i/make-term (xpt/make 0 1) one)]\n      (Polynomial. 1 [term] m)))\n\n  (exact? [_] false)\n  (freeze [_] `(~'polynomial ~arity ~terms))\n  (kind [_] ::polynomial)\n\n  #?@(:clj\n      [Object\n       (equals [this that] (eq this that))\n       (toString [p] (->str p))\n\n       IObj\n       (meta [_] m)\n       (withMeta [_ meta] (Polynomial. arity terms meta))\n\n       Seqable\n       (seq [_] (seq terms))\n\n       IFn\n       (invoke [this]\n               (evaluate this []))\n       (invoke [this a]\n               (evaluate this [a]))\n       (invoke [this a b]\n               (evaluate this [a b]))\n       (invoke [this a b c]\n               (evaluate this [a b c]))\n       (invoke [this a b c d]\n               (evaluate this [a b c d]))\n       (invoke [this a b c d e]\n               (evaluate this [a b c d e]))\n       (invoke [this a b c d e f]\n               (evaluate this [a b c d e f]))\n       (invoke [this a b c d e f g]\n               (evaluate this [a b c d e f g]))\n       (invoke [this a b c d e f g h]\n               (evaluate this [a b c d e f g h]))\n       (invoke [this a b c d e f g h i]\n               (evaluate this [a b c d e f g h i]))\n       (invoke [this a b c d e f g h i j]\n               (evaluate this [a b c d e f g h i j]))\n       (invoke [this a b c d e f g h i j k]\n               (evaluate this [a b c d e f g h i j k]))\n       (invoke [this a b c d e f g h i j k l]\n               (evaluate this [a b c d e f g h i j k l]))\n       (invoke [this a b c d e f g h i j k l m]\n               (evaluate this [a b c d e f g h i j k l m]))\n       (invoke [this a b c d e f g h i j k l m n]\n               (evaluate this [a b c d e f g h i j k l m n]))\n       (invoke [this a b c d e f g h i j k l m n o]\n               (evaluate this [a b c d e f g h i j k l m n o]))\n       (invoke [this a b c d e f g h i j k l m n o p]\n               (evaluate this [a b c d e f g h i j k l m n o p]))\n       (invoke [this a b c d e f g h i j k l m n o p q]\n               (evaluate this [a b c d e f g h i j k l m n o p q]))\n       (invoke [this a b c d e f g h i j k l m n o p q r]\n               (evaluate this [a b c d e f g h i j k l m n o p q r]))\n       (invoke [this a b c d e f g h i j k l m n o p q r s]\n               (evaluate this [a b c d e f g h i j k l m n o p q r s]))\n       (invoke [this a b c d e f g h i j k l m n o p q r s t]\n               (evaluate this [a b c d e f g h i j k l m n o p q r s t]))\n       (invoke [this a b c d e f g h i j k l m n o p q r s t rest]\n               (evaluate this (into [a b c d e f g h i j k l m n o p q r s t] rest)))\n       (applyTo [this xs] (AFn/applyToHelper this xs))]\n\n      :cljs\n      [Object\n       (toString [p] (->str p))\n\n       IEquiv\n       (-equiv [this that] (eq this that))\n\n       IMeta\n       (-meta [_] m)\n\n       IWithMeta\n       (-with-meta [_ m] (Polynomial. arity terms m))\n\n       ISeqable\n       (-seq [_] (seq terms))\n\n       IFn\n       (-invoke [this]\n                (evaluate this []))\n       (-invoke [this a]\n                (evaluate this [a]))\n       (-invoke [this a b]\n                (evaluate this [a b]))\n       (-invoke [this a b c]\n                (evaluate this [a b c]))\n       (-invoke [this a b c d]\n                (evaluate this [a b c d]))\n       (-invoke [this a b c d e]\n                (evaluate this [a b c d e]))\n       (-invoke [this a b c d e f]\n                (evaluate this [a b c d e f]))\n       (-invoke [this a b c d e f g]\n                (evaluate this [a b c d e f g]))\n       (-invoke [this a b c d e f g h]\n                (evaluate this [a b c d e f g h]))\n       (-invoke [this a b c d e f g h i]\n                (evaluate this [a b c d e f g h i]))\n       (-invoke [this a b c d e f g h i j]\n                (evaluate this [a b c d e f g h i j]))\n       (-invoke [this a b c d e f g h i j k]\n                (evaluate this [a b c d e f g h i j k]))\n       (-invoke [this a b c d e f g h i j k l]\n                (evaluate this [a b c d e f g h i j k l]))\n       (-invoke [this a b c d e f g h i j k l m]\n                (evaluate this [a b c d e f g h i j k l m]))\n       (-invoke [this a b c d e f g h i j k l m n]\n                (evaluate this [a b c d e f g h i j k l m n]))\n       (-invoke [this a b c d e f g h i j k l m n o]\n                (evaluate this [a b c d e f g h i j k l m n o]))\n       (-invoke [this a b c d e f g h i j k l m n o p]\n                (evaluate this [a b c d e f g h i j k l m n o p]))\n       (-invoke [this a b c d e f g h i j k l m n o p q]\n                (evaluate this [a b c d e f g h i j k l m n o p q]))\n       (-invoke [this a b c d e f g h i j k l m n o p q r]\n                (evaluate this [a b c d e f g h i j k l m n o p q r]))\n       (-invoke [this a b c d e f g h i j k l m n o p q r s]\n                (evaluate this [a b c d e f g h i j k l m n o p q r s]))\n       (-invoke [this a b c d e f g h i j k l m n o p q r s t]\n                (evaluate this [a b c d e f g h i j k l m n o p q r s t]))\n       (-invoke [this a b c d e f g h i j k l m n o p q r s t rest]\n                (evaluate this (into [a b c d e f g h i j k l m n o p q r s t] rest)))\n\n       IPrintWithWriter\n       (-pr-writer [x writer _]\n                   (write-all writer\n                              \"#object[sicmutils.polynomial.Polynomial \\\"\"\n                              (.toString x)\n                              \"\\\"]\"))]))\n\n(defn polynomial?\n  \"Returns true if the supplied argument is an instance of [[Polynomial]], false\n  otherwise.\"\n  [x]\n  (instance? Polynomial x))\n\n(defn coeff?\n  \"Returns true if the input `x` is explicitly _not_ an instance\n  of [[Polynomial]], false otherwise.\n\n  Equivalent to `(not (polynomial? x))`.\"\n  [x]\n  (not (polynomial? x)))\n\n(defn ^:no-doc bare-arity\n  \"Given a [[Polynomial]] instance `p`, returns the `arity` field.\"\n  [p]\n  {:pre [(polynomial? p)]}\n  (.-arity ^Polynomial p))\n\n(defn ^:no-doc bare-terms\n  \"Given a [[Polynomial]] instance `p`, returns the `terms` field.\"\n  [p]\n  {:pre [(polynomial? p)]}\n  (.-terms ^Polynomial p))\n\n;; ## Constructors\n\n(defn ^:no-doc terms->polynomial\n  \"Accepts an explicit `arity` and a vector of terms and returns either:\n\n  - `0`, in the case of an empty list\n  - a bare coefficient, given a singleton term list with a constant term\n  - else, a [[Polynomial]] instance.\n\n  In the second case, if the coefficient is _itself_ a [[Polynomial]], wraps\n  that [[Polynomial]] instance up in an explicit [[Polynomial]]. In cases where\n  polynomials have polynomial coefficients, this flattening should never happen\n  automatically.\n\n  NOTE this method assumes that the terms are properly sorted, and contain no\n  zero coefficients.\"\n  [arity terms]\n  (cond (empty? terms) 0\n\n        (and (= (count terms) 1)\n             (i/constant-term? (nth terms 0)))\n        (let [c (i/coefficient (nth terms 0))]\n          (if (polynomial? c)\n            (->Polynomial arity terms nil)\n            c))\n\n        :else (->Polynomial arity terms nil)))\n\n(defn make\n  \"Generates a [[Polynomial]] instance (or a bare coefficient!) from either:\n\n  - a sequence of dense coefficients of a univariate polynomial (in ascending\n  order)\n  - an explicit `arity`, and a sparse mapping (or sequence of pairs) of exponent\n  => coefficient\n\n  In the first case, the sequence is interpreted as a dense sequence of\n  coefficients of an arity-1 (univariate) polynomial. The coefficients begin\n  with the constant term and proceed to each higher power of the indeterminate.\n  For example, x^2 - 1 can be constructed by (make [-1 0 1]).\n\n  In the 2-arity case,\n\n  - `arity` is the number of indeterminates\n  - `expts->coef` is a map of an exponent representation to a coefficient.\n\n  The `exponent` portion of the mapping can be any of:\n\n  - a proper exponent entry created by `sicmutils.polynomial.exponent`\n  - a map of the form `{variable-index, power}`\n  - a dense vector of variable powers, like `[3 0 1]` for $x^3z$. The length of\n    each vector should be equal to `arity`, in this case.\n\n  For example, any of the following would generate $4x^2y + 5xy^2$:\n\n  ```clojure\n  (make 2 [[[2 1] 4] [[1 2] 5]])\n  (make 2 {[2 1] 4, [1 2] 5})\n  (make 2 {{0 2, 1 1} 4, {0 1, 1 2} 5})\n  ```\n\n  NOTE: [[make]] will try and return a bare coefficient if possible. For\n  example, the following form will return a constant, since there are no\n  explicit indeterminates with powers > 0:\n\n  ```clojure\n  (make 10 {{} 1 {} 2})\n  ;;=> 3\n  ```\n\n  See [[constant]] if you need an explicit [[Polynomial]] instance wrapping a\n  constant.\"\n  ([dense-coefficients]\n   (let [terms (i/dense->terms dense-coefficients)]\n     (terms->polynomial 1 terms)))\n  ([arity expts->coef]\n   (let [terms (i/sparse->terms expts->coef)]\n     (terms->polynomial arity terms))))\n\n(defn constant\n  \"Given some coefficient `c`, returns a [[Polynomial]] instance with a single\n  constant term referencing `c`.\n\n  `arity` defaults to 1; supply it to set the arity of the\n  returned [[Polynomial]].\"\n  ([c] (constant 1 c))\n  ([arity c]\n   (->Polynomial arity (i/constant->terms c) nil)))\n\n(defn identity\n  \"Generates a [[Polynomial]] instance representing a single indeterminate with\n  constant 1.\n\n  When called with no arguments, returns a monomial of arity 1 that acts as\n  identity in the first indeterminate.\n\n  The one-argument version takes an explicit `arity`, but still sets the\n  identity to the first indeterminate.\n\n  The two-argument version takes an explicit `i` and returns a monomial of arity\n  `arity` with an exponent of 1 in the `i`th indeterminate.\"\n  ([]\n   (identity 1 0))\n  ([arity]\n   (identity arity 0))\n  ([arity i]\n   {:pre [(and (>= i 0) (< i arity))]}\n   (let [expts (xpt/make i 1)]\n     (->Polynomial arity [(i/make-term expts 1)] nil))))\n\n(defn new-variables\n  \"Returns a sequence of `n` monomials of arity `n`, each with an exponent of `1`\n  for the `i`th indeterminate (where `i` matches the position in the returned\n  sequence).\"\n  [n]\n  (map #(identity n %)\n       (range 0 n)))\n\n(defn from-points\n  \"Given a sequence of points of the form `[x, f(x)]`, returns a univariate\n  polynomial that passes through each input point.\n\n  The degree of the returned polynomial is equal to `(dec (count xs))`.\"\n  [xs]\n  (g/simplify\n   (pi/lagrange xs (identity))))\n\n(declare add)\n\n(defn linear\n  \"Given some `arity`, an indeterminate index `i` and some constant `root`,\n  returns a polynomial of the form `x_i - root`. The returned polynomial\n  represents a linear equation in the `i`th indeterminate.\n\n  If `root` is 0, [[linear]] is equivalent to the two-argument version\n  of [[identity]].\"\n  [arity i root]\n  (if (v/zero? root)\n    (identity arity i)\n    (add (constant arity (g/negate root))\n         (identity arity i))))\n\n(defn c*xn\n  \"Given some `arity`, a coefficient `c` and an exponent `n`, returns a monomial\n  representing $c{x_0}^n$. The first indeterminate is always exponentiated.\n\n  Similar to [[make]], this function attempts to drop down to scalar-land if\n  possible:\n\n  - If `c` is [[sicmutils.value/zero?]], returns `c`\n  - if `n` is `zero?`, returns `(constant arity c)`\n\n  NOTE that negative exponents are not allowed.\"\n  [arity c n]\n  {:pre [(>= n 0)]}\n  (cond (v/zero? c) c\n        (zero? n)   (constant arity c)\n        :else\n        (let [term (i/make-term (xpt/make 0 n) c)]\n          (->Polynomial arity [term] nil))))\n\n;; ## Constructors of Special Polynomials\n\n(defn touchard\n  \"Returns the nth [Touchard\n  polynomial](https://en.wikipedia.org/wiki/Touchard_polynomials).\n\n  These are also called [Bell\n  polynomials](https://mathworld.wolfram.com/BellPolynomial.html) (in\n  Mathematica, implemented as `BellB`) or /exponential polynomials/.\"\n  [n]\n  (make\n   (map #(sf/stirling-second-kind n %)\n        (range (inc n)))))\n\n;; ###  Accessors, Predicates\n;;\n;; The functions in the next section all work on both explicit [[Polynomial]]\n;; instances _and_ on bare coefficients. Any non-polynomial type is treated as a\n;; constant polynomial.\n\n(def ^:no-doc coeff-arity 0)\n(def ^:no-doc zero-degree -1)\n\n(defn arity\n  \"Returns the declared arity of the supplied [[Polynomial]], or `0` for\n  non-polynomial arguments.\"\n  [p]\n  (if (polynomial? p)\n    (bare-arity p)\n    coeff-arity))\n\n(defn ->terms\n  \"Given some [[Polynomial]], returns the `terms` entry of the type. Handles other types as well:\n\n  - Acts as identity on vectors, interpreting them as vectors of terms\n  - any zero-valued `p` returns `[]`\n  - any other coefficient returns a vector of a single constant term.\"\n  [p]\n  (cond (polynomial? p) (bare-terms p)\n        (vector? p) p\n        (v/zero? p) []\n        :else [(i/make-term p)]))\n\n(defn ^:no-doc check-same-arity\n  \"Given two polynomials (or coefficients) `p` and `q`, checks that their arities\n  are equal and returns the value, or throws an exception if not.\n\n  If either `p` or `q` is a coefficient, [[check-same-arity]] successfully\n  returns the other argument's arity.\"\n  [p q]\n  (let [poly-p? (polynomial? p)\n        poly-q? (polynomial? q)]\n    (cond (and poly-p? poly-q?)\n          (let [ap (bare-arity p)\n                aq (bare-arity q)]\n            (if (= ap aq)\n              ap\n              (u/arithmetic-ex\n               (str \"mismatched polynomial arity: \" ap \", \" aq))))\n          poly-p? (bare-arity p)\n          poly-q? (bare-arity q)\n          :else coeff-arity)))\n\n(defn valid-arity?\n  \"Given some input `p` and an indeterminate index `i`, returns true if `0 <= i\n  < (arity p)`, false otherwise.\"\n  [p i]\n  (and (>= i 0)\n       (< i (arity p))))\n\n(defn ^:no-doc validate-arity!\n  \"Given some input `p` and an indeterminate index `i`, returns `i` if `0 <= i\n  < (arity p)`, and throws an exception otherwise.\n\n  NOTE [[validate-arity]] is meant to validate indeterminate indices; thus it\n  will always throw for non-[[Polynomial]] inputs.\"\n  [p i]\n  (if (valid-arity? p i)\n    i\n    (u/arithmetic-ex\n     (str \"Supplied i \" i \" outside the bounds of arity \" (arity p) \" for input \" p))))\n\n(declare leading-term)\n\n(defn degree\n  \"Returns the [degree](https://en.wikipedia.org/wiki/Degree_of_a_polynomial) of\n  the supplied polynomial.\n\n  the degree of a polynomial is the highest of the degrees of the polynomial's\n  individual terms with non-zero coefficients. The degree of an individual term\n  is the sum of all exponents in the term.\n\n  Optionally, [[degree]] takes an indeterminate index `i`; in this\n  case, [[degree]] returns the maximum power found for the `i`th indeterminate\n  across all terms.\n\n  NOTE when passed either a `0` or a zero-polynomial, [[degree]] returns -1. See\n  Wikipedia's ['degree of the zero\n  polynomial'](https://en.wikipedia.org/wiki/Degree_of_a_polynomial#Degree_of_the_zero_polynomial)\n  for color on why this is the case.\n  \"\n  ([p]\n   (cond (v/zero? p) zero-degree\n         (polynomial? p)\n         (xpt/monomial-degree\n          (i/exponents\n           (leading-term p)))\n         :else coeff-arity))\n  ([p i]\n   (let [i (validate-arity! p i)]\n     (cond (v/zero? p) zero-degree\n           (polynomial? p)\n           (letfn [(i-degree [term]\n                     (-> (i/exponents term)\n                         (xpt/monomial-degree i)))]\n             (transduce (map i-degree)\n                        max\n                        0\n                        (bare-terms p)))\n           :else coeff-arity))))\n\n(defn eq\n  \"Returns true if the [[Polynomial]] this is equal to `that`. If `that` is\n  a [[Polynomial]], `this` and `that` are equal if they have equal terms and\n  equal arity. Coefficients are compared using [[sicmutils.value/=]].\n\n  If `that` is non-[[Polynomial]], `eq` only returns true if `this` is a\n  monomial and its coefficient is equal to `that` (again\n  using [[sicmutils.value/=]]).\"\n  [^Polynomial this that]\n  (if (instance? Polynomial that)\n    (let [p ^Polynomial that]\n      (and (= (.-arity this) (.-arity p))\n           (v/= (.-terms this)\n                (.-terms p))))\n\n    (let [terms (.-terms this)]\n      (and (<= (count terms) 1)\n           (let [term (peek terms)]\n             (and (i/constant-term? term)\n                  (v/= that (i/coefficient term))))))))\n\n(defn ->str\n  \"Returns a string representation of the supplied [[Polynomial]] instance `p`.\n\n  The optional argument `n` specifies how many terms to include in the returned\n  string before an ellipsis cuts them off.\"\n  ([p] (->str p 10))\n  ([p n]\n   {:pre [polynomial? p]}\n   (let [terms     (bare-terms p)\n         arity     (bare-arity p)\n         n-terms   (count terms)\n         term-strs (take n (map i/term->str terms))\n         suffix    (when (> n-terms n)\n                     (str \"... and \" (- n-terms n) \" more terms\"))]\n     (str arity  \": (\" (cs/join \" + \" term-strs) suffix \")\"))))\n\n(defn coefficients\n  \"Returns a sequence of the coefficients of the supplied polynomial `p`. A\n  coefficient is treated here as a monomial, and returns a sequence of itself.\n\n  If `p` is zero, returns an empty list.\"\n  [p]\n  (cond (polynomial? p) (map i/coefficient (->terms p))\n        (v/zero? p) []\n        :else [p]))\n\n(defn leading-term\n  \"Returns the leading (highest degree) term of the [[Polynomial]] `p`.\n\n  If `p` is a non-[[Polynomial]] coefficient, returns a term with zero exponents\n  and `p` as its coefficient.\"\n  [p]\n  (or (peek (->terms p))\n      [xpt/empty 0]))\n\n(defn leading-coefficient\n  \"Returns the coefficient of the leading (highest degree) term of\n  the [[Polynomial]] `p`.\n\n  If `p` is a non-[[Polynomial]] coefficient, acts as identity.\"\n  [p]\n  (if (polynomial? p)\n    (i/coefficient\n     (peek (bare-terms p)))\n    p))\n\n(defn leading-exponents\n  \"Returns the exponents of the leading (highest degree) term of\n  the [[Polynomial]] `p`.\n\n  If `p` is a non-[[Polynomial]] coefficient, returns [[exponent/empty]].\"\n  [p]\n  (if (polynomial? p)\n    (i/exponents\n     (peek (bare-terms p)))\n    xpt/empty))\n\n(defn leading-base-coefficient\n  \"Similar to [[leading-coefficient]], but of the coefficient itself is\n  a [[Polynomial]], recurses down until it reaches a non-[[Polynomial]] lead\n  coefficient.\n\n  If `p` is a non-[[Polynomial]] coefficient, acts as identity.\"\n  [p]\n  (if (polynomial? p)\n    (recur (leading-coefficient p))\n    p))\n\n(defn trailing-coefficient\n  \"Returns the coefficient of the trailing (lowest degree) term of\n  the [[Polynomial]] `p`.\n\n  If `p` is a non-[[Polynomial]] coefficient, acts as identity.\"\n  [p]\n  (if (polynomial? p)\n    (i/coefficient\n     (nth (bare-terms p) 0 []))\n    p))\n\n(defn lowest-degree\n  \"Returns the lowest degree found across any term in the supplied [[Polynomial]].\n  If a non-[[Polynomial]] is supplied, returns either `0` or `-1` if the input\n  is itself a `0`.\n\n  See [[degree]] for a discussion of this `-1` case.\"\n  [p]\n  (cond (polynomial? p)\n        (xpt/monomial-degree\n         (i/exponents\n          (nth (bare-terms p) 0)))\n        (v/zero? p) zero-degree\n        :else coeff-arity))\n\n(defn monomial?\n  \"Returns true if `p` is either:\n\n  - a [[Polynomial]] instance with a single term, or\n  - a non-[[Polynomial]] coefficient,\n\n  false otherwise.\"\n  [p]\n  (or (not (polynomial? p))\n      (= 1 (count (bare-terms p)))))\n\n(defn monic?\n  \"Returns true if `p` is a [monic\n  polynomial](https://en.wikipedia.org/wiki/Monic_polynomial), false otherwise.\n\n  A monic polynomial is a univariate polynomial with a leading coefficient that\n  responds `true` to [[sicmutils.value/one?]]. This means that any coefficient\n  that responds `true` to [[sicmutils.value/one?]] also qualifies as a monic\n  polynomial.\"\n  [p]\n  (if (polynomial? p)\n    (and (= 1 (arity p))\n         (v/one?\n          (leading-coefficient p)))\n    (v/one? p)))\n\n(defn univariate?\n  \"Returns true if `p` is a [[Polynomial]] of arity 1, false otherwise.\"\n  [p]\n  (and (polynomial? p)\n       (= (bare-arity p) 1)))\n\n(defn multivariate?\n  \"Returns true if `p` is a [[Polynomial]] of arity > 1, false otherwise.\"\n  [p]\n  (and (polynomial? p)\n       (> (bare-arity p) 1)))\n\n(defn negative?\n  \"Returns true if the [[leading-base-coefficient]] of `p`\n  is [[generic/negative?]], false otherwise.\"\n  [p]\n  (g/negative?\n   (leading-base-coefficient p)))\n\n;; ## Polynomial API\n\n(defn map-coefficients\n  \"Given a [[Polynomial]], returns a new [[Polynomial]] instance generated by\n  applying `f` to the coefficient of each term in `p` and filtering out all\n  resulting zeros.\n\n  Given a non-[[Polynomial]] coefficient, returns `(f p)`.\n\n  NOTE that [[map-coefficients]] will return a non-[[Polynomial]] if the result\n  of the mapping has only a constant term.\"\n  [f p]\n  (if (polynomial? p)\n    (terms->polynomial\n     (bare-arity p)\n     (i/map-coefficients f (bare-terms p)))\n    (f p)))\n\n(defn map-exponents\n  \"Given a [[Polynomial]], returns a new [[Polynomial]] instance generated by\n  applying `f` to the exponents of each term in `p` and filtering out all\n  resulting zeros. The resulting [[Polynomial]] will have either the\n  same [[arity]] as `p`, or the explicit, optional `new-arity` argument. (This\n  is because `f` might increase or decrease the total arity.)\n\n  Given a non-[[Polynomial]] coefficient, if `(f empty-exponents)` produces a\n  non-zero result, errors without an explicit `new-arity` argument..\n\n  NOTE that [[map-exponents]] will return a non-[[Polynomial]] if the result\n  of the mapping has only a constant term.\"\n  ([f p]\n   (map-exponents f p nil))\n  ([f p new-arity]\n   (letfn [(force-arity []\n             (or new-arity\n                 (u/illegal\n                  \"`new-arity` argument to `map-exponents` required when promoting constant.\")))\n           (handle-constant []\n             (let [f-expts (f xpt/empty)]\n               (if (empty? f-expts)\n                 p\n                 (let [arity (force-arity)]\n                   (->Polynomial arity [(i/make-term f-expts p)] nil)))))]\n     (cond (polynomial? p)\n           (make (or new-arity (bare-arity p))\n                 (for [[expts c] (bare-terms p)\n                       :let [f-expts (f expts)]]\n                   (i/make-term f-expts c)))\n           (v/zero? p) p\n           :else (handle-constant)))))\n\n;; ## Manipulations\n\n(defn univariate->dense\n  \"Given a univariate [[Polynomial]] (see [[univariate?]]) returns a dense vector\n  of the coefficients of each term in ascending order.\n\n  For example:\n\n  ```clojure\n  (univariate->dense (make [1 0 0 2 3 4]))\n  ;;=> [1 0 0 2 3 4]\n  ```\n\n  Supplying the second argument `x-degree` will pad the right side of the\n  returning coefficient vector to be the max of `x-degree` and `(degree x)`.\n\n  NOTE use [[lower-arity]] to generate a univariate polynomial in the first\n  indeterminate, given a multivariate polynomial.\"\n  ([x] (univariate->dense x (degree x)))\n  ([x x-degree]\n   (if (coeff? x)\n     (into [x] (repeat x-degree 0))\n     (do (assert (univariate? x))\n         (let [d (degree x)]\n           (loop [terms (bare-terms x)\n                  acc (transient [])\n                  i 0]\n             (if (> i d)\n               (into (persistent! acc)\n                     (repeat (- x-degree d) 0))\n               (let [t  (first terms)\n                     e  (i/exponents t)\n                     md (xpt/monomial-degree e 0)]\n                 (if (= md i)\n                   (recur (rest terms)\n                          (conj! acc (i/coefficient t))\n                          (inc i))\n                   (recur terms\n                          (conj! acc 0)\n                          (inc i)))))))))))\n\n(defn ->power-series\n  \"Given a univariate polynomial `p`, returns a [[series/PowerSeries]]\n  representation of the supplied [[Polynomial]].\n\n  Given a [[series/PowerSeries]], acts as identity.\n\n  Non-[[Polynomial]] coefficients return [[series/PowerSeries]] instances\n  via [[series/constant]]; any multivariate [[Polynomial]] throws an exception.\n\n  NOTE use [[lower-arity]] to generate a univariate polynomial in the first\n  indeterminate, given a multivariate polynomial.\"\n  [p]\n  (cond (series/power-series? p) p\n\n        (univariate? p)\n        (series/power-series*\n         (univariate->dense p))\n\n        (polynomial? p)\n        (u/illegal\n         \"Only univariate polynomials can be converted to [[PowerSeries]].\n         Use [[polynomial/lower]] to generate a univariate.\")\n\n        :else (series/constant p)))\n\n(defn from-power-series\n  \"Returns a univariate polynomial of all terms in the\n  supplied [[series/PowerSeries]] instance, up to (and including) order\n  `n-terms`.\n\n  ```clojure\n  (g/simplify\n    ((from-power-series series/exp-series 3) 'x))\n  ;; => (+ (* 1/6 (expt x 3)) (* 1/2 (expt x 2)) x 1)\n  ```\"\n  [s n-terms]\n  {:pre [(series/power-series? s)]}\n  (-> (s (identity))\n      (series/sum n-terms)))\n\n(defn scale\n  \"Given some polynomial `p` and a coefficient `c`, returns a new [[Polynomial]]\n  generated by multiplying each coefficient of `p` by `c` (on the right).\n\n  See [[scale-l]] if left multiplication is important.\n\n  NOTE that [[scale]] will return a non-[[Polynomial]] if the result of the\n  mapping has only a constant term.\"\n  [p c]\n  (if (v/zero? c)\n    c\n    (map-coefficients #(g/* % c) p)))\n\n(defn scale-l\n  \"Given some polynomial `p` and a coefficient `c`, returns a new [[Polynomial]]\n  generated by multiplying each coefficient of `p` by `c` (on the left).\n\n  See [[scale]] if right multiplication is important.\n\n  NOTE that [[scale-l]] will return a non-[[Polynomial]] if the result of the\n  mapping has only a constant term.\"\n  [c p]\n  (if (v/zero? c)\n    c\n    (map-coefficients #(g/* c %) p)))\n\n(declare evenly-divide)\n\n(defn normalize\n  \"Given a polynomial `p`, returns a normalized polynomial generated by dividing\n  through either the [[leading-coefficient]] of `p` or an optional, explicitly\n  supplied scaling factor `c`.\n\n  For example:\n\n  ```clojure\n  (let [p (make [5 3 2 2 10])]\n    (univariate->dense (normalize p)))\n  ;;=> [1/2 3/10 1/5 1/5 1]\n  ```\"\n  ([p]\n   (normalize p (leading-coefficient p)))\n  ([p c]\n   (cond (v/one? c) p\n         (v/zero? c) (u/arithmetic-ex\n                      (str \"Divide by zero: \" p c))\n         (polynomial? c) (evenly-divide p c)\n         :else (scale p (g/invert c)))))\n\n(defn reciprocal\n  \"Given a polynomial `p`, returns the [reciprocal\n  polynomial](https://en.wikipedia.org/wiki/Reciprocal_polynomial) with respect\n  to the `i`th indeterminate. `i` defaults to 0.\n\n  The reciprocal polynomial of `p` with respect to `i` is generated by\n\n  - treating the polynomial as univariate with respect to `i` and pushing all\n    other terms into the coefficients of the polynomial\n  - reversing the order of these coefficients\n  - flattening the polynomial out again\n\n  For example, note that the entries for the first indeterminate are reversed:\n\n  ```clojure\n  (= (make 3 {[3 0 0] 5 [2 0 1] 2 [0 2 1] 3})\n     (reciprocal\n       (make 3 {[0 0 0] 5 [1 0 1] 2 [3 2 1] 3})))\n  ```\"\n  ([p] (reciprocal p 0))\n  ([p i]\n   (if (polynomial? p)\n     (let [d (degree p i)]\n       (if (zero? d)\n         p\n         (map-exponents\n          (fn [m]\n            (let [v (xpt/monomial-degree m i)\n                  v' (- d v)]\n              (xpt/assoc m i v')))\n          p)))\n     p)))\n\n(defn drop-leading-term\n  \"Given some [[Polynomial]] `p`, returns `p` without its [[leading-term]].\n  non-[[Polynomial]] `p` inputs are treated at constant polynomials and return\n  `0`.\n\n  NOTE that [[drop-leading-term]] will return a non-[[Polynomial]] if the result\n  of the mapping has only a constant term.\"\n  [p]\n  (if (polynomial? p)\n    (let [a (bare-arity p)\n          terms (pop (bare-terms p))]\n      (terms->polynomial a terms))\n    0))\n\n;; ## Polynomial Arithmetic\n\n(defn- binary-combine\n  \"Accepts\n\n  - two inputs `l` and `r`\n  - A `coeff-op`, used when both inputs are non-[[Polynomial]]\n  - a `terms-op` that acts on two vectors of bare terms\n\n  And returns:\n\n  - `(coeff-op l r)` when both inputs are non-[[Polynomial]],\n\n  - `(terms-op l r)` otherwise, appropriately converting `l` or `r` into a\n    singleton term vector when needed.\n\n  The result is converted back to a [[Polynomial]] (or dropped to a coefficient)\n  via [[terms->polynomial]], or a custom function supplied by the optional\n  `:->poly` argument.\"\n  [l r coeff-op terms-op\n   & {:keys [->poly]\n      :or {->poly terms->polynomial}}]\n  (let [l-poly? (polynomial? l)\n        r-poly? (polynomial? r)]\n    (cond (and l-poly? r-poly?)\n          (->poly\n           (check-same-arity l r)\n           (terms-op (bare-terms l)\n                     (bare-terms r)))\n\n          l-poly?\n          (->poly\n           (bare-arity l)\n           (terms-op (bare-terms l)\n                     (i/constant->terms r)))\n\n          r-poly?\n          (->poly\n           (bare-arity r)\n           (terms-op (i/constant->terms l)\n                     (bare-terms r)))\n\n          :else (coeff-op l r))))\n\n(defn negate\n  \"Returns the negation of polynomial `p`, ie, a polynomial with all coefficients\n  negated.\"\n  [p]\n  (map-coefficients g/negate p))\n\n(defn abs\n  \"If the [[leading-coefficient]] of `p` is negative, returns `(negate p)`, else\n  acts as identity.\"\n  [p]\n  (if (negative? p)\n    (negate p)\n    p))\n\n(defn add\n  \"Returns the sum of polynomials `p` and `q`, with appropriate handling for\n  non-[[Polynomial]] coefficient inputs on either or both sides.\"\n  [p q]\n  (binary-combine p q g/add i/add))\n\n(defn sub\n  \"Returns the difference of polynomials `p` and `q`, with appropriate handling\n  for non-[[Polynomial]] coefficient inputs on either or both sides.\"\n  [p q]\n  (binary-combine p q g/sub i/sub))\n\n(defn mul\n  \"Returns the product of polynomials `p` and `q`, with appropriate handling for\n  non-[[Polynomial]] coefficient inputs on either or both sides.\"\n  [p q]\n  (binary-combine p q g/mul i/mul))\n\n(defn square\n  \"Returns the square of polynomial `p`. Equivalent to `(mul p p)`.\"\n  [p]\n  (mul p p))\n\n(defn cube\n  \"Returns the cube of polynomial `p`. Equivalent to `(mul p (mul p p))`.\"\n  [p]\n  (mul p (mul p p)))\n\n(defn expt\n  \"Returns a polynomial generated by raising the input polynomial `p` to\n  the (integer) power `n`.\n\n  Negative exponents are not supported. For negative polynomial exponentation,\n  see [[rational-function/expt]].\"\n  [p n]\n  (letfn [(expt-iter [x n answer]\n            (cond (zero? n) answer\n                  (even? n) (recur (mul x x) (quot n 2) answer)\n                  :else     (recur x (dec n) (mul x answer))))]\n    (cond\n      (coeff? p) (g/expt p n)\n\n      (not (v/native-integral? n))\n      (u/illegal\n       (str \"Can only raise an FPF to an exact integer power: \" p n))\n\n      (neg? n)\n      (u/illegal (str \"No inverse -- FPF:EXPT:\" p n))\n\n      (v/one? p)  p\n      (v/zero? p) (if (v/zero? n)\n                    (u/arithmetic-ex \"poly 0^0\")\n                    p)\n\n      :else (expt-iter p n 1))))\n\n(defn divide\n  \"Given two polynomials `u` and `v`, returns a pair of polynomials of the form\n  `[quotient, remainder]` using [polynomial long\n  division](https://en.wikipedia.org/wiki/Polynomial_long_division).\n\n  The contract satisfied by this returned pair is that\n\n  ```\n  u == (add (mul quotient v) remainder)\n  ```\"\n  [u v]\n  (cond (v/zero? v)\n        (u/illegal \"internal polynomial division by zero\")\n\n        (or (v/zero? u) (v/one? v))\n        [u 0]\n\n        :else\n        (letfn [(coeff:div [l r]\n                  [(g/quotient l r) (g/remainder l r)])]\n          (binary-combine u v coeff:div i/div\n                          :->poly\n                          (fn [a [q r]]\n                            [(terms->polynomial a q)\n                             (terms->polynomial a r)])))))\n\n(defn divisible?\n  \"Returns true if the numerator `n` is evenly divisible by `d` (ie, leaves no\n  remainder), false otherwise.\n\n  NOTE that this performs a full division with [[divide]]. If you're planning on\n  doing this, you may as well call [[divide]] and check that the remainder\n  satisfies [[sicmutils.value/zero?]].\"\n  [n d]\n  (let [[_ r] (divide n d)]\n    (v/zero? r)))\n\n(defn evenly-divide\n  \"Returns the result of dividing the polynomial `u` by `v` (non-[[Polynomial]]\n  instances are allowed).\n\n  Throws an exception if the division leaves a remainder. Else, returns the\n  quotient.\"\n  [u v]\n  (if (v/one? v)\n    u\n    (let [[q r] (divide u v)]\n      (when-not (v/zero? r)\n        (u/illegal-state\n         (str \"expected even division left a remainder! \" u \" / \" v \" r \" r)))\n      q)))\n\n;; A comment from GJS on the next function: \"Pseudo division produces only a\n;; remainder--no quotient. This can be used to generalize Euclid's algorithm for\n;; polynomials over a [unique factorization\n;; domain](https://en.wikipedia.org/wiki/Unique_factorization_domain) (UFD).\"\n\n\n#?(:cljs\n   (defn- ->big\n     \"Clojurescript multiplication doesn't autopromote; we expect large values\n     in [[pseudo-remainder]], and use [[->big]] to pre-cast the factors\n     to [[util/bigint]] so they don't overflow.\"\n     [c]\n     (if (v/integral? c)\n       (u/bigint c)\n       c)))\n\n(defn pseudo-remainder\n  \"Returns the pseudo-remainder of univariate polynomials `u` and `v`.\n\n  NOTE: Fractions won't appear in the result; instead the divisor is multiplied\n  by the leading coefficient of the dividend before quotient terms are generated\n  so that division will not result in fractions.\n\n  Returns a pair of\n\n  - the remainder\n  - the integerizing factor needed to make this happen.\n\n  Similar in spirit to Knuth's algorithm 4.6.1R, except we don't multiply the\n  remainder through during gaps in the remainder. Since you don't know up front\n  how many times the integerizing multiplication will be done, we also return\n  the number d for which d * u = q * v + r.\"\n  [u v]\n  {:pre [(univariate? u)\n         (univariate? v)\n         (not (v/zero? v))]}\n  (let [[vn-expts vn-coeff] (leading-term v)\n        #?@(:cljs [vn-coeff (->big vn-coeff)])\n        *vn (fn [p] (scale p vn-coeff))\n        n (xpt/monomial-degree vn-expts)]\n    (loop [remainder u\n           d 0]\n      (let [m (degree remainder)\n            c (leading-coefficient remainder)\n            #?@(:cljs [c (->big c)])]\n        (if (< m n)\n          [remainder d]\n          ;; this handles symbolic coefficients.\n          (recur (g/simplify\n                  (sub (*vn remainder)\n                       (mul (c*xn 1 c (- m n))\n                            v)))\n                 (inc d)))))))\n\n;; ## Polynomial Contraction and Expansion\n;;\n;; The following functions are helpful for modifying the arity and variable\n;; assignment within a polynomial, either by expanding and contracting a\n;; flattened polynomial (adding new variable indices, or removing unused\n;; indices) or by pushing some of the variables into the coefficient slots of a\n;; new univariate polynomial.\n\n(defn contractible?\n  \"Returns true if `n` is a valid variable index for the [[Polynomial]] `p`, and\n  the variable with that index has no powers greater than `0` in `p`, false\n  otherwise.\"\n  [p n]\n  (and (valid-arity? p n)\n       (zero?\n        (degree p n))))\n\n(defn contract\n  \"If `p` is [[contractible?]] at index `n`, returns a new [[Polynomial]] instance\n  of [[arity]] `1` less than `p` with all variable indices > `n` decremented.\n\n  For non-[[Polynomial]] inputs, acts as identity. Throws if `p` is not\n  explicitly [[contractible?]].\n\n  For example:\n\n  ```clojure\n  (= (make 2 {[1 2] 3 [3 4] 5})\n     (contract\n       (make 3 {[0 1 2] 3 [0 3 4] 5}) 0))\n  ```\"\n  [p n]\n  (cond (not (polynomial? p)) p\n\n        (contractible? p n)\n        (map-exponents #(xpt/lower % n)\n                       p\n                       (dec (bare-arity p)))\n\n        :else\n        (u/illegal\n         (str \"Polynomial not contractible: \" p \" in position \" n))))\n\n(defn extend\n  \"Interpolates a new variable into the supplied [[Polynomial]] `p` at index `n`\n  by incrementing any existing variable index >= `n`.\n\n  Returns a new [[Polynomial]] of [[arity]] 1 greater than the [[arity]] of `p`,\n  or equal to `(inc n)` if `n` is greater than the [[arity]] of `p`.\n\n  For non-[[Polynomial]] inputs (or negative `n`), acts as identity.\"\n  [p n]\n  (if (or (not (polynomial? p))\n          (< n 0))\n    p\n    (let [a (bare-arity p)]\n      (if (> n a)\n        (->Polynomial (inc n) (bare-terms p) (meta p))\n        (map-exponents #(xpt/raise % n 0)\n                       p\n                       (inc a))))))\n\n;; The next two functions allow you to pivot a multivariate polynomial into a\n;; univariate polynomial in the first variable. All other variables are pushed\n;; into [[Polynomial]] instances attached as coefficients.\n\n(defn lower-arity\n  \"Given a multivariate [[Polynomial]] `p`, returns an equivalent\n  univariate [[Polynomial]] whose coefficients are polynomials of [[arity]]\n  equal to one less than the [[arity]] of `p`.\n\n  Use [[raise-arity]] to undo this transformation. See [[with-lower-arity]] for\n  a function that packages these two transformations.\n\n  NOTE that [[lower-arity]] will drop a coefficient down to a non-[[Polynomial]]\n  if the result of extracting the first variable leaves a constant term.\"\n  [p]\n  {:pre [(multivariate? p)]}\n  (let [A (bare-arity p)]\n    (letfn [(lower-terms [terms]\n              (make (dec A)\n                    (for [[xs c] terms]\n                      [(xpt/lower xs 0) c])))]\n      (->> (bare-terms p)\n           (group-by #(xpt/monomial-degree (i/exponents %) 0))\n           (map (fn [[x terms]]\n                  (let [expts (if (zero? x)\n                                xpt/empty\n                                (xpt/make 0 x))]\n                    (i/make-term expts (lower-terms terms)))))\n           (make 1)))))\n\n(defn raise-arity\n  \"Given either a non-[[Polynomial]] coefficient or a univariate [[Polynomial]]\n  with possibly-[[Polynomial]] coefficients, returns a new [[Polynomial]] of\n  arity `a` generated by attaching the polynomial coefficients back as variables\n  starting with `1`.\n\n  [[raise-arity]] undoes the transformation of [[lower-arity]].\n  See [[with-lower-arity]] for a function that packages these two\n  transformations.\"\n  [p a]\n  (if (polynomial? p)\n    (do (assert (= (bare-arity p) 1))\n        (let [terms (i/sparse->terms\n                     (for [[x q] (bare-terms p)\n                           [ys c] (->terms q)\n                           :let [expts (xpt/raise\n                                        ys 0 (xpt/monomial-degree x 0))]]\n                       (i/make-term expts c)))]\n          (->Polynomial a terms (meta p))))\n    (constant a p)))\n\n(defn with-lower-arity\n  \"Given:\n\n  - multivariate [[Polynomial]]s `u` and `v`\n  - a `continue` function that accepts two univariate [[Polynomial]]s with\n    possibly-[[Polynomial]] coefficients,\n\n  Returns the result of calling [[lower-arity]] on `u` and `v`, passing the\n  results to `continue` and using [[raise-arity]] to raise the result back to\n  the original shared [[arity]] of `u` and `v`.\n\n  The exception is that if `continue` returns a\n  non-[[Polynomial]], [[with-lower-arity]] will not attempt to re-package it as\n  a [[Polynomial]].\"\n  [u v continue]\n  (let [a (check-same-arity u v)\n        result (continue\n                (lower-arity u)\n                (lower-arity v))]\n    (if (polynomial? result)\n      (raise-arity result a)\n      result)))\n\n;; ## Evaluation\n\n(defn- evaluate-1\n  \"Returns the result of evaluating the univariate [[Polynomial]] `p` at `x`\n  using [Horner's rule](https://en.wikipedia.org/wiki/Horner%27s_method).\n\n  If `p` is a non-[[Polynomial]] coefficient, acts as identity.\n\n  NOTE In general, the coefficients of the `p` will themselves\n  be [[Polynomial]]s, which must then evaluated with values for their\n  indeterminates. See [[evaluate]] for a multivariate version\n  of [[evaluate-1]].\"\n  [p x]\n  (if-not (polynomial? p)\n    p\n    (do (assert (= 1 (bare-arity p))\n                \"`evaluate-1` requires a univariate polynomial!\")\n        (loop [terms (bare-terms p)\n               result 0\n               x**e   1\n               e      0]\n          (if-let [[expts c] (nth terms 0)]\n            (let [e' (xpt/monomial-degree expts 0)\n                  x**e' (g/* x**e (g/expt x (- e' e)))]\n              (recur (next terms)\n                     (g/+ result (g/* c x**e'))\n                     x**e'\n                     e'))\n            result)))))\n\n(defn evaluate\n  \"Returns the result of evaluating a multivariate [[Polynomial]] `p` at the\n  values in the sequence `xs` using [Horner's\n  rule](https://en.wikipedia.org/wiki/Horner%27s_method).\n\n  If `p` is a non-[[Polynomial]] coefficient, acts as identity.\n\n  Supplying too many arguments in `xs` (ie, a greater number than the [[arity]]\n  of `p`) will throw an exception. Too few arguments will result in a partial\n  evaluation of `p`, leaving the remaining indeterminates with their variable\n  indices shifted down.\n\n  For example:\n\n  ```clojure\n  (= (make [0 0 '(* 3 (expt x 2) y) 0 '(* 5 (expt x 2) (expt y 3))])\n     (simplify\n       (evaluate\n         (make 3 {[2 1 2] 3 [2 3 4] 5}) ['x 'y])))\n  ```\"\n  [p xs]\n  (if-not (polynomial? p)\n    p\n    (let [a (bare-arity p)]\n      (assert (<= (count xs) a)\n              (str \"Too many args: \" xs))\n      (cond (empty? xs) p\n            (v/zero? p) 0\n            :else\n            (let [x (first xs)\n                  x (if (and (polynomial? x) (> a 1))\n                      (constant (dec a) x)\n                      x)]\n              (if (= a 1)\n                (evaluate-1 p x)\n                (let [L (evaluate-1 (lower-arity p) x)]\n                  (if (polynomial? L)\n                    (recur L (next xs))\n                    L))))))))\n\n(defn horner-with-error\n  \"Takes a univariate polynomial `a`, an argument `z` and a continuation\n  `cont` (`vector` by default) and calls the continuation with (SEE BELOW).\n\n  This Horner's rule evaluator is restricted to numerical coefficients and\n  univariate polynomials. It returns by calling `cont` with 4 arguments:\n\n  - the computed value\n  - the values of the first two derivatives\n  - an estimate of the roundoff error incurred in computing the value\n\n  The recurrences used are from Kahan's 18 Nov 1986 paper ['Roundoff in\n  Polynomial\n  Evaluation'](https://people.eecs.berkeley.edu/~wkahan/Math128/Poly.pdf),\n  generalized for sparse representations and another derivative by GJS.\n\n  For $p = A(z)$, $q = A'(z)$, $r = A''(z)$, and $e$ = error in $A(x)$,\n\n  $$p_{j+n} = z^n p_j + a_{j+n}$$\n\n  $$e_{j+n} = |z|^n ( e_j + (n-1) p_j ) + |p_{j+n}|$$\n\n  $$q_{j+n} = z^n q_j + n z^{n-1} p_j$$\n\n  $$r_{j+n} = z^n r_j + n z^{n-1} q_j + 1/2 n (n-1) z^{n-2} p_j$$\"\n  ([a z]\n   (horner-with-error a z vector))\n  ([a z cont]\n   {:pre [(univariate? a)\n          (number? z)]}\n   (letfn [(call [d p q r e a]\n             (let [next-degree (degree a)\n                   n (if (polynomial? a)\n                       (- d next-degree)\n                       d)\n                   finish (fn [np nq nr ne]\n                            (if (polynomial? a)\n                              (call next-degree np nq nr ne\n                                    (drop-leading-term a))\n                              (cont np nq (* 2 nr)\n                                    (* v/machine-epsilon\n                                       (+ (- ne (Math/abs ^double np)) ne)))))]\n               (cond (= n 1)\n                     (let [np (+ (* z p) (leading-coefficient a))\n                           nq (+ (* z q) p)\n                           nr (+ (* z r) q)\n                           ne (+ (* (Math/abs ^double z) e) (Math/abs ^double np))]\n                       (finish np nq nr ne))\n                     (= n 2)\n                     (let [z-n (* z z)\n                           az-n (Math/abs ^double z-n)\n                           np (+ (* z-n p) (leading-coefficient a))\n                           nq (+ (* z-n q) (* 2 (* z p)))\n                           nr (+ (* z-n r) (* 2 z q) p)\n                           ne (+ (* az-n (+ e p)) (Math/abs ^double np))]\n                       (finish np nq nr ne))\n                     :else\n                     (let [z-n-2 (expt z (- n 2))\n                           z-n-1 (* z-n-2 z)\n                           z-n (* z-n-1 z)\n                           az-n (Math/abs ^double z-n)\n                           np (+ (* z-n p)\n                                 (leading-coefficient a))\n                           nq (+ (* z-n q)\n                                 (* n (* z-n-1 p)))\n                           nr (+ (* z-n r)\n                                 (* n z-n-1 q)\n                                 (* (/ 1 2) n (- n 1) z-n-2 p))\n                           ne (+ (* az-n (+ e (* (- n 1) p)))\n                                 (Math/abs ^double np))]\n                       (finish np nq nr ne)))))]\n     (let [lc (leading-coefficient a)]\n       (call (degree a)\n             lc\n             0\n             0\n             (* (/ 1 2) (Math/abs ^double lc))\n             (drop-leading-term a))))))\n\n;; ## Scale and Shift\n\n(defn arg-scale\n  \"Given some [[Polynomial]] `p`, returns a new [[Polynomial]] generated by\n  substituting each indeterminate `x_i` for `f_i * x_i`, where `f_i` is a factor\n  supplied in the `factors` sequence.\n\n  When `p` is a multivariate [[Polynomial]], each factor must be either a\n  non-[[Polynomial]] or a [[Polynomial]] with the same [[arity]] as `p`.\"\n  [p factors]\n  {:pre (= (arity p) (count factors))}\n  (evaluate p (map mul\n                   factors\n                   (new-variables (arity p)))))\n\n(defn arg-shift\n  \"Given some [[Polynomial]] `p`, returns a new [[Polynomial]] generated by\n  substituting each indeterminate `x_i` for `s_i + x_i`, where `s_i` is a shift\n  supplied in the `shifts` sequence.\n\n  When `p` is a multivariate [[Polynomial]], each shift must be either a\n  non-[[Polynomial]] or a [[Polynomial]] with the same [[arity]] as `p`.\"\n  [p shifts]\n  {:pre (= (arity p) (count shifts))}\n  (evaluate p (map add\n                   shifts\n                   (new-variables (arity p)))))\n\n;; ## Derivatives\n\n(defn partial-derivative\n  \"Given some [[Polynomial]] `p`, returns the partial derivative of `p` with\n  respect to the `i`th indeterminate. Throws if `i` is an invalid indeterminate\n  index for `p`.\n\n  For non-[[Polynomial]] inputs, returns `0`.\"\n  [p i]\n  (if-not (polynomial? p)\n    0\n    (do (validate-arity! p i)\n        (make (bare-arity p)\n              (for [[xs c] (bare-terms p)\n                    :let [xi (xs i 0)]\n                    :when (not= 0 xi)]\n                (let [expts (if (= 1 xi)\n                              (dissoc xs i)\n                              (update xs i dec))\n                      coeff (g/* xi c)]\n                  (i/make-term expts coeff)))))))\n\n(defn partial-derivatives\n  \"Returns the sequence of partial derivatives of [[Polynomial]] `p` with respect\n  to each indeterminate. The returned sequence has length equal to the [[arity]]\n  of `p`.\n\n  For non-[[Polynomial]] inputs, returns an empty sequence.\"\n  [p]\n  (if-not (polynomial? p)\n    []\n    (for [i (range (bare-arity p))]\n      (partial-derivative p i))))\n\n;; ## Canonicalizer\n;;\n;; This section defines functions that allow conversion back and forth\n;; between [[Polynomial]] instances and symbolic expressions.\n;;\n;; The `operator-table` represents the operations that can be understood from\n;; the point of view of a polynomial over a commutative ring.\n\n(def ^{:no-doc true\n       :doc \"These operations are those allowed between [[Polynomial]] and\n       coefficient instances.\"}\n  operator-table\n  {'+ (ua/monoid g/add 0)\n   '- (ua/group g/sub g/add g/negate 0)\n   '* (ua/monoid g/mul 1 v/zero?)\n   'negate g/negate\n   'expt g/expt\n   'square g/square\n   'cube g/cube\n   'gcd (ua/monoid g/gcd 0)\n   'lcm (ua/monoid g/lcm 1 v/zero?)})\n\n(def ^{:no-doc true\n       :doc \"Set of all arithmetic functions allowed between [[Polynomial]] and\n       coefficient instances.\"}\n  operators-known\n  (u/keyset operator-table))\n\n(defn expression->\n  \"Converts the supplied symbolic expression `expr` into Flat Polynomial canonical\n  form (ie, a [[Polynomial]] instance). `expr` should be a bare, unwrapped\n  expression built out of Clojure data structures.\n\n  Returns the result of calling continuation `cont` with the [[Polynomial]] and\n  the list of variables corresponding to each indeterminate in\n  the [[Polynomial]]. (`cont `defaults to `vector`).\n\n  The second optional argument `v-compare` allows you to provide a Comparator\n  between variables. Sorting indeterminates by `v-compare` will determine the\n  order of the indeterminates in the generated [[Polynomial]]. The list of\n  variables passed to `cont` will be sorted using `v-compare`.\n\n  Absorbing an expression with [[expression->]] and emitting it again\n  with [[->expression]] will generate the canonical form of an expression, with\n  respect to the operations in the [[operators-known]] set.\n\n  This kind of simplification proceeds purely symbolically over the known Flat\n  Polynomial operations; other operations outside the arithmetic available in\n  polynomials over commutative rings should be factored out by an expression\n  analyzer (see [[sicmutils.expression.analyze/make-analyzer]]) before\n  calling [[expression->]].\n\n  NOTE See [[analyzer]] for an instance usable\n  by [[sicmutils.expression.analyze/make-analyzer]].\"\n  ([expr]\n   (expression-> expr vector compare))\n  ([expr cont]\n   (expression-> expr cont compare))\n  ([expr cont v-compare]\n   (let [vars     (-> (x/variables-in expr)\n                      (set/difference operators-known))\n         arity    (count vars)\n         sorted   (sort v-compare vars)\n         sym->var (zipmap sorted (new-variables arity))\n         poly     (x/evaluate expr sym->var operator-table)]\n     (cont poly sorted))))\n\n(let [* (sym/symbolic-operator '*)\n      + (sym/symbolic-operator '+)\n      expt (sym/symbolic-operator 'expt)]\n  (defn ->expression\n    \"Accepts a [[Polynomial]] `p` and a sequence of symbols for each indeterminate,\n  and emits the canonical form of the symbolic expression that\n  represents [[Polynomial]] `p`.\n\n  A similar result could be achieved by calling `(apply p vars)`;\n  but [[Polynomial]] application uses [Horner's\n  rule](https://en.wikipedia.org/wiki/Horner%27s_method), and form of the\n  returned result will be different.\n\n  NOTE: this is the output stage of Flat Polynomial canonical form\n  simplification. The input stage is handled by [[expression->]].\n\n  NOTE See [[analyzer]] for an instance usable\n  by [[sicmutils.expression.analyze/make-analyzer]].\"\n    [p vars]\n    (if-not (polynomial? p)\n      (x/expression-of p)\n      (let [xform (map (fn [[expts c]]\n                         (transduce\n                          (map-indexed\n                           (fn [i v]\n                             (let [pow (xpt/monomial-degree expts i)]\n                               (expt v pow))))\n                          *\n                          (x/expression-of c)\n                          vars)))\n            high->low (rseq (bare-terms p))]\n        (transduce xform + high->low)))))\n\n(def ^{:doc \"Singleton [[sicmutils.expression.analyze/ICanonicalize]]\n  instance.\"}\n  analyzer\n  (reify a/ICanonicalize\n    (expression-> [_ expr cont]\n      (expression-> expr cont))\n\n    (expression-> [_ expr cont v-compare]\n      (expression-> expr cont v-compare))\n\n    (->expression [_ p vars]\n      (->expression p vars))\n\n    (known-operation? [_ o]\n      (contains? operators-known o))))\n\n;; ## Generic Implementations\n;;\n;; The functions above were written to handle any non-[[Polynomial]]\n;; coefficient; it's up to the user to provide only commutative rings.\n;;\n;; The `::coeff` keyword allows the SICMUtils generic dispatch system to act as\n;; a guard here. By default, modular integers and anything deriving from\n;; `::v/scalar` will interact with [[Polynomial]] instances when they meet via\n;; generic `+`, `-`, `*` and a few other functions defined below. To install\n;; another type, simply use a `derive` form like those below.\n\n(derive ::v/scalar ::coeff)\n(derive ::mi/modint ::coeff)\n\n(defn ^:no-doc defbinary\n  \"Installs the supplied function `f` into `generic-op` such that it will act\n  between [[Polynomial]] instances, or allow non-[[Polynomial]] coefficients on\n  either side.\"\n  [generic-op f]\n  (let [pairs [[::polynomial ::polynomial]\n               [::coeff ::polynomial]\n               [::polynomial ::coeff]]]\n    (doseq [[l r] pairs]\n      (defmethod generic-op [l r] [r s]\n        (f r s)))))\n\n;; `v/=` is not implemented with [[defbinary]] because the variable order needs\n;; to change so that a [[Polynomial]] is always on the left.\n\n(defmethod v/= [::polynomial ::polynomial] [l r] (eq l r))\n(defmethod v/= [::polynomial ::coeff] [l r] (eq l r))\n(defmethod v/= [::coeff ::polynomial] [l r] (eq r l))\n\n(defbinary g/add add)\n(defbinary g/sub sub)\n(defbinary g/mul mul)\n(defbinary g/quotient (fn [p q] (nth (divide p q) 0)))\n(defbinary g/remainder (fn [p q] (nth (divide p q) 1)))\n\n;; NOTE: What about `g/modulo`? Does that belong for [[Polynomial]] instances?\n;; How does it differ from `g/remainder`?\n\n(defmethod g/negative? [::polynomial] [a] (negative? a))\n(defmethod g/abs [::polynomial] [a] (abs a))\n(defmethod g/negate [::polynomial] [a] (negate a))\n(defmethod g/square [::polynomial] [a] (square a))\n(defmethod g/cube [::polynomial] [a] (cube a))\n\n(defmethod g/expt [::polynomial ::v/native-integral] [b x] (expt b x))\n\n(defmethod g/exact-divide [::polynomial ::polynomial] [p q] (evenly-divide p q))\n(defmethod g/exact-divide [::polynomial ::coeff] [p c] (evenly-divide p c))\n\n(defmethod g/simplify [::polynomial] [p]\n  (map-coefficients g/simplify p))\n\n(defmethod g/partial-derivative [::polynomial v/seqtype] [p selectors]\n  (cond (empty? selectors)\n        (if (= 1 (bare-arity p))\n          (partial-derivative p 0)\n          (ss/down* (partial-derivatives p)))\n\n        (= 1 (count selectors))\n        (partial-derivative p (first selectors))\n\n        :else\n        (u/illegal\n         (str \"Invalid selector! Only 1 deep supported.\"))))\n"]}