shadow$provide.module$node_modules$mathbox$build$esm$render$buffer$texture$datatexture=function(global,require,module,exports){function _getRequireWildcardCache(nodeInterop$jscomp$0){if("function"!==typeof WeakMap)return null;var cacheBabelInterop=new WeakMap,cacheNodeInterop=new WeakMap;return(_getRequireWildcardCache=function(nodeInterop){return nodeInterop?cacheNodeInterop:cacheBabelInterop})(nodeInterop$jscomp$0)}function _interopRequireWildcard(obj,nodeInterop){if(!nodeInterop&&obj&&obj.__esModule)return obj;
if(null===obj||"object"!==typeof obj&&"function"!==typeof obj)return{default:obj};if((nodeInterop=_getRequireWildcardCache(nodeInterop))&&nodeInterop.has(obj))return nodeInterop.get(obj);var newObj={},hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor,key;for(key in obj)if("default"!==key&&Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;desc&&(desc.get||desc.set)?Object.defineProperty(newObj,key,
desc):newObj[key]=obj[key]}newObj.default=obj;nodeInterop&&nodeInterop.set(obj,newObj);return newObj}Object.defineProperty(exports,"__esModule",{value:!0});exports.DataTexture=void 0;var CONST=_interopRequireWildcard(require("module$node_modules$three$src$constants")),UThree=_interopRequireWildcard(require("module$node_modules$mathbox$build$esm$util$three")),_Texture=require("module$node_modules$three$src$textures$Texture"),_Vector=require("module$node_modules$three$src$math$Vector2");class DataTexture{constructor(renderer,
width,height,channels,options){this.renderer=renderer;this.width=width;this.height=height;this.channels=channels;this.n=this.width*this.height*this.channels;this.gl=renderer=this.renderer.getContext();width=null!=(null!=options?options.magFilter:void 0)?null!=options?options.magFilter:void 0:CONST.NearestFilter;height=null!=(null!=options?options.type:void 0)?null!=options?options.type:void 0:CONST.FloatType;this.minFilter=UThree.paramToGL(renderer,null!=(null!=options?options.minFilter:void 0)?null!=
options?options.minFilter:void 0:CONST.NearestFilter);this.magFilter=UThree.paramToGL(renderer,width);this.type=UThree.paramToGL(renderer,height);this.ctor=UThree.paramToArrayStorage(height);this.build(options)}build(options){const {gl}=this,state=this.renderer.state;this.texture=gl.createTexture();this.format=[null,gl.LUMINANCE,gl.LUMINANCE_ALPHA,gl.RGB,gl.RGBA][this.channels];this.format3=[null,CONST.LuminanceFormat,CONST.LuminanceAlphaFormat,CONST.RGBFormat,CONST.RGBAFormat][this.channels];state.bindTexture(gl.TEXTURE_2D,
this.texture);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_S,gl.CLAMP_TO_EDGE);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_T,gl.CLAMP_TO_EDGE);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MIN_FILTER,this.minFilter);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MAG_FILTER,this.magFilter);this.data=new this.ctor(this.n);gl.pixelStorei(gl.UNPACK_ALIGNMENT,1);gl.texImage2D(gl.TEXTURE_2D,0,this.format,this.width,this.height,0,this.format,this.type,this.data);this.textureObject=new _Texture.Texture(new Image,
CONST.UVMapping,CONST.ClampToEdgeWrapping,CONST.ClampToEdgeWrapping,null!=options?options.minFilter:void 0,null!=options?options.magFilter:void 0);this.textureProperties=this.renderer.properties.get(this.textureObject);this.textureProperties.__webglInit=!0;this.textureProperties.__webglTexture=this.texture;this.textureObject.format=this.format3;this.textureObject.type=CONST.FloatType;this.textureObject.unpackAlignment=1;this.textureObject.flipY=!1;this.textureObject.generateMipmaps=!1;this.uniforms=
{dataResolution:{type:"v2",value:new _Vector.Vector2(1/this.width,1/this.height)},dataTexture:{type:"t",value:this.textureObject}}}write(data,x,y,w,h){const {gl}=this;this.renderer.state.bindTexture(gl.TEXTURE_2D,this.texture);gl.pixelStorei(gl.UNPACK_ALIGNMENT,1);gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL,!1);gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1);return gl.texSubImage2D(gl.TEXTURE_2D,0,x,y,w,h,this.format,this.type,data)}dispose(){this.gl.deleteTexture(this.texture);this.textureProperties.__webglInit=
!1;return this.textureObject=this.texture=this.textureProperties=this.textureProperties.__webglTexture=null}}exports.DataTexture=DataTexture}
//# sourceMappingURL=module$node_modules$mathbox$build$esm$render$buffer$texture$datatexture.js.map
