{"version":3,"sources":["sci/impl/hierarchies.cljc"],"mappings":"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","names":["sci.impl.hierarchies/global-hierarchy","ctx","cljs.core/deref","cljs.core.get_in","sci.impl.hierarchies/->tag","x","sci.lang/Type","cljs.core.symbol","cljs.core/namespace","cljs.core/name","var_args","G__76542","sci.impl.hierarchies/derive*","js/Error","tag","parent","sci.impl.vars.alter_var_root","h","cljs.core.derive","_ctx","G__76544","sci.impl.hierarchies/underive*","cljs.core.underive","G__76546","sci.impl.hierarchies/isa?*","child","cljs.core.isa_QMARK_","G__76556","sci.impl.hierarchies/ancestors*","cljs.core.ancestors","G__76562","sci.impl.hierarchies/descendants*","cljs.core.descendants","G__76564","sci.impl.hierarchies/parents*","cljs.core.parents"],"sourcesContent":["(ns sci.impl.hierarchies\n  {:no-doc true}\n  (:require [sci.impl.vars :as vars]\n            [sci.lang]))\n\n;;;; Hierarchies\n\n(defn global-hierarchy [ctx]\n  (get-in @(:env ctx) [:namespaces 'clojure.core 'global-hierarchy]))\n\n(defn ->tag [x]\n  (if (instance? sci.lang.Type x)\n    (symbol (namespace x) (name x))\n    x))\n\n(defn derive*\n  ([ctx tag parent]\n   (let [tag (->tag tag)]\n     (vars/alter-var-root (global-hierarchy ctx)\n                          (fn [h]\n                            (derive h tag parent))))\n   nil)\n  ([_ctx h tag parent]\n   (let [tag (->tag tag)]\n     (derive h tag parent))))\n\n(defn underive*\n  ([ctx tag parent]\n   (let [tag (->tag tag)]\n     (vars/alter-var-root (global-hierarchy ctx)\n                          (fn [h]\n                            (underive h tag parent))))\n   nil)\n  ([_ctx h tag parent]\n   (let [tag (->tag tag)]\n     (underive h tag parent))))\n\n(defn isa?*\n  ([ctx child parent]\n   (let [h @(global-hierarchy ctx)]\n     (isa? h (->tag child) parent)))\n  ([_ctx h child parent]\n   (isa? h (->tag child) parent)))\n\n(defn ancestors*\n  ([ctx tag]\n   (let [h @(global-hierarchy ctx)]\n     (ancestors h tag)))\n  ([_ctx h tag]\n   (ancestors h tag)))\n\n(defn descendants*\n  ([ctx tag]\n   (let [h @(global-hierarchy ctx)]\n     (descendants h tag)))\n  ([_ctx h tag]\n   (descendants h tag)))\n\n(defn parents*\n  ([ctx tag]\n   (let [h @(global-hierarchy ctx)]\n     (parents h tag)))\n  ([_ctx h tag]\n   (parents h tag)))\n"]}