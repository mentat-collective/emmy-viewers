{
"version":3,
"file":"module$node_modules$mathbox$build$esm$primitives$types$rtt$compose.js",
"lineCount":4,
"mappings":"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",
"sources":["node_modules/mathbox/build/esm/primitives/types/rtt/compose.js"],
"sourcesContent":["shadow$provide[\"module$node_modules$mathbox$build$esm$primitives$types$rtt$compose\"] = function(global,require,module,exports) {\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Compose = void 0;\n\nvar _primitive = require(\"../../primitive.js\");\n\n// TODO: This file was created by bulk-decaffeinate.\n// Sanity-check the conversion and remove this comment.\n\n/*\n * decaffeinate suggestions:\n * DS102: Remove unnecessary code created because of implicit returns\n * DS206: Consider reworking classes to avoid initClass\n * DS207: Consider shorter variations of null checks\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/master/docs/suggestions.md\n */\nclass Compose extends _primitive.Primitive {\n  static initClass() {\n    this.traits = [\"node\", \"bind\", \"object\", \"visible\", \"operator\", \"style\", \"compose\"];\n    this.defaults = {\n      zWrite: false,\n      zTest: false,\n      color: \"#ffffff\"\n    };\n  }\n\n  init() {\n    return this.compose = null;\n  } //rebuild: () ->\n  //  console.log 'compose.rebuild', @node.get(null, true), @bind.source?\n  //  super()\n\n\n  resize() {\n    if (!this.compose || !this.bind.source) {\n      return;\n    }\n\n    const dims = this.bind.source.getActiveDimensions();\n    const {\n      width\n    } = dims;\n    const {\n      height\n    } = dims;\n    return this.remapUVScale.set(width, height);\n  }\n\n  make() {\n    // Bind to attached data sources\n    this._helpers.bind.make([{\n      to: \"operator.source\",\n      trait: \"source\"\n    }]);\n\n    if (this.bind.source == null) {\n      return;\n    } // Prepare uniforms for remapping to absolute coords on the fly\n\n\n    const resampleUniforms = {\n      remapUVScale: this._attributes.make(this._types.vec2())\n    };\n    this.remapUVScale = resampleUniforms.remapUVScale.value; // Build fragment shader\n\n    let fragment = this._shaders.shader();\n\n    const {\n      alpha\n    } = this.props;\n\n    if (this.bind.source.is(\"image\")) {\n      // Sample image directly in 2D UV\n      fragment.pipe(\"screen.pass.uv\", resampleUniforms);\n      fragment = this.bind.source.imageShader(fragment);\n    } else {\n      // Sample data source in 4D\n      fragment.pipe(\"screen.map.xy\", resampleUniforms);\n      fragment = this.bind.source.sourceShader(fragment);\n    } // Force pixels to solid if requested\n\n\n    if (!alpha) {\n      fragment.pipe(\"color.opaque\");\n    } // Make screen renderable\n\n\n    const composeUniforms = this._helpers.style.uniforms();\n\n    this.compose = this._renderables.make(\"screen\", {\n      map: fragment,\n      uniforms: composeUniforms,\n      linear: true\n    });\n\n    this._helpers.visible.make();\n\n    return this._helpers.object.make([this.compose]);\n  }\n\n  made() {\n    return this.resize();\n  }\n\n  unmake() {\n    this._helpers.bind.unmake();\n\n    this._helpers.visible.unmake();\n\n    return this._helpers.object.unmake();\n  }\n\n  change(changed, _touched, _init) {\n    if (changed[\"operator.source\"] || changed[\"compose.alpha\"]) {\n      return this.rebuild();\n    }\n  }\n\n}\n\nexports.Compose = Compose;\nCompose.initClass();\n};"],
"names":["shadow$provide","global","require","module","exports","Object","defineProperty","value","Compose","_primitive","Primitive","initClass","traits","defaults","zWrite","zTest","color","init","compose","resize","bind","source","dims","getActiveDimensions","width","height","remapUVScale","set","make","_helpers","to","trait","resampleUniforms","_attributes","_types","vec2","fragment","_shaders","shader","alpha","props","is","pipe","imageShader","sourceShader","composeUniforms","style","uniforms","_renderables","map","linear","visible","object","made","unmake","change","changed","_touched","_init","rebuild"]
}
