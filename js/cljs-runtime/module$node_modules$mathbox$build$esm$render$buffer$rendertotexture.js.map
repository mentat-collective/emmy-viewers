{
"version":3,
"file":"module$node_modules$mathbox$build$esm$render$buffer$rendertotexture.js",
"lineCount":8,
"mappings":"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",
"sources":["node_modules/mathbox/build/esm/render/buffer/rendertotexture.js"],
"sourcesContent":["shadow$provide[\"module$node_modules$mathbox$build$esm$render$buffer$rendertotexture\"] = function(global,require,module,exports) {\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.RenderToTexture = void 0;\n\nvar UGLSL = _interopRequireWildcard(require(\"../../util/glsl.js\"));\n\nvar _PerspectiveCamera = require(\"three/src/cameras/PerspectiveCamera.js\");\n\nvar _rendertarget = require(\"./texture/rendertarget.js\");\n\nvar _renderable = require(\"../renderable.js\");\n\nvar _Scene = require(\"three/src/scenes/Scene.js\");\n\nvar _Vector = require(\"three/src/math/Vector2.js\");\n\nvar _Vector2 = require(\"three/src/math/Vector3.js\");\n\nfunction _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== \"function\") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function (nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }\n\nfunction _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== \"object\" && typeof obj !== \"function\") { return { default: obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\n\n// TODO: This file was created by bulk-decaffeinate.\n// Sanity-check the conversion and remove this comment.\n\n/*\n * decaffeinate suggestions:\n * DS101: Remove unnecessary use of Array.from\n * DS102: Remove unnecessary code created because of implicit returns\n * DS207: Consider shorter variations of null checks\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/master/docs/suggestions.md\n */\n\n/*\n * Render-To-Texture with history\n */\nclass RenderToTexture extends _renderable.Renderable {\n  constructor(renderer, shaders, options) {\n    super(renderer, shaders);\n    this.scene = options.scene != null ? options.scene : new _Scene.Scene();\n    this.camera = options.camera;\n    this.build(options);\n  }\n\n  shaderRelative(shader) {\n    if (shader == null) {\n      shader = this.shaders.shader();\n    }\n\n    return shader.pipe(\"sample.2d\", this.uniforms);\n  }\n\n  shaderAbsolute(shader, frames, indices) {\n    if (frames == null) {\n      frames = 1;\n    }\n\n    if (indices == null) {\n      indices = 4;\n    }\n\n    if (shader == null) {\n      shader = this.shaders.shader();\n    }\n\n    if (frames <= 1) {\n      if (indices > 2) {\n        shader.pipe(UGLSL.truncateVec(indices, 2));\n      }\n\n      shader.pipe(\"map.2d.data\", this.uniforms);\n      return shader.pipe(\"sample.2d\", this.uniforms);\n    } else {\n      const sample2DArray = UGLSL.sample2DArray(Math.min(frames, this.target.frames));\n\n      if (indices < 4) {\n        shader.pipe(UGLSL.extendVec(indices, 4));\n      }\n\n      shader.pipe(\"map.xyzw.2dv\");\n      shader.split();\n      shader.pipe(\"map.2d.data\", this.uniforms);\n      shader.pass();\n      return shader.pipe(sample2DArray, this.uniforms);\n    }\n  }\n\n  build(options) {\n    if (!this.camera) {\n      this.camera = new _PerspectiveCamera.PerspectiveCamera();\n      this.camera.position.set(0, 0, 3);\n      this.camera.lookAt(new _Vector2.Vector3());\n    }\n\n    if (typeof this.scene.inject === \"function\") {\n      this.scene.inject();\n    }\n\n    this.target = new _rendertarget.RenderTarget(this.gl, options.width, options.height, options.frames, options);\n    this.target.warmup(target => this.renderer.setRenderTarget(target));\n    this.renderer.setRenderTarget(null);\n\n    this._adopt(this.target.uniforms);\n\n    this._adopt({\n      dataPointer: {\n        type: \"v2\",\n        value: new _Vector.Vector2(0.5, 0.5)\n      }\n    });\n\n    return this.filled = 0;\n  }\n\n  adopt(renderable) {\n    return Array.from(renderable.renders).map(object => this.scene.add(object));\n  }\n\n  unadopt(renderable) {\n    return Array.from(renderable.renders).map(object => this.scene.remove(object));\n  }\n\n  render(camera) {\n    if (camera == null) {\n      ({\n        camera\n      } = this);\n    }\n\n    const currentTarget = this.renderer.getRenderTarget();\n    this.renderer.setRenderTarget(this.target.write);\n    this.renderer.render(this.scene.scene != null ? this.scene.scene : this.scene, camera);\n    this.renderer.setRenderTarget(currentTarget);\n    this.target.cycle();\n\n    if (this.filled < this.target.frames) {\n      return this.filled++;\n    }\n  }\n\n  read(frame) {\n    if (frame == null) {\n      frame = 0;\n    }\n\n    return this.target.reads[Math.abs(frame)];\n  }\n\n  getFrames() {\n    return this.target.frames;\n  }\n\n  getFilled() {\n    return this.filled;\n  }\n\n  dispose() {\n    if (typeof this.scene.unject === \"function\") {\n      this.scene.unject();\n    }\n\n    this.scene = this.camera = null;\n    this.target.dispose();\n    return super.dispose();\n  }\n\n}\n\nexports.RenderToTexture = RenderToTexture;\n};"],
"names":["shadow$provide","global","require","module","exports","_getRequireWildcardCache","nodeInterop","WeakMap","cacheBabelInterop","cacheNodeInterop","Object","defineProperty","value","RenderToTexture","UGLSL","_interopRequireWildcard","obj","__esModule","default","cache","has","get","newObj","hasPropertyDescriptor","getOwnPropertyDescriptor","key","prototype","hasOwnProperty","call","desc","set","_PerspectiveCamera","_rendertarget","_renderable","_Scene","_Vector","_Vector2","Renderable","constructor","renderer","shaders","options","scene","Scene","camera","build","shaderRelative","shader","pipe","uniforms","shaderAbsolute","frames","indices","truncateVec","sample2DArray","Math","min","target","extendVec","split","pass","PerspectiveCamera","position","lookAt","Vector3","inject","RenderTarget","gl","width","height","warmup","setRenderTarget","_adopt","dataPointer","type","Vector2","filled","adopt","renderable","Array","from","renders","map","object","add","unadopt","remove","render","currentTarget","getRenderTarget","write","cycle","read","frame","reads","abs","getFrames","getFilled","dispose","unject"]
}
