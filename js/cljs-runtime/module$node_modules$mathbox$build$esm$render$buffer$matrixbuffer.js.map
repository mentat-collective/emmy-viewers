{
"version":3,
"file":"module$node_modules$mathbox$build$esm$render$buffer$matrixbuffer.js",
"lineCount":7,
"mappings":"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",
"sources":["node_modules/mathbox/build/esm/render/buffer/matrixbuffer.js"],
"sourcesContent":["shadow$provide[\"module$node_modules$mathbox$build$esm$render$buffer$matrixbuffer\"] = function(global,require,module,exports) {\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.MatrixBuffer = void 0;\n\nvar UData = _interopRequireWildcard(require(\"../../util/data.js\"));\n\nvar _databuffer = require(\"./databuffer.js\");\n\nfunction _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== \"function\") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function (nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }\n\nfunction _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== \"object\" && typeof obj !== \"function\") { return { default: obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\n\n// TODO: This file was created by bulk-decaffeinate.\n// Sanity-check the conversion and remove this comment.\n\n/*\n * decaffeinate suggestions:\n * DS101: Remove unnecessary use of Array.from\n * DS102: Remove unnecessary code created because of implicit returns\n * DS104: Avoid inline assignments\n * DS207: Consider shorter variations of null checks\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/master/docs/suggestions.md\n */\n\n/*\n * 2D + history array\n */\nclass MatrixBuffer extends _databuffer.DataBuffer {\n  constructor(renderer, shaders, options) {\n    const width = options.width || 1;\n    const height = options.height || 1;\n    const history = options.history || 1;\n    options.depth = history;\n    super(renderer, shaders, options, false);\n    this.width = width;\n    this.height = height;\n    this.history = history;\n    this.samples = width * height;\n    this.wrap = history > 1;\n    this.build(options);\n  }\n\n  build(_options) {\n    super.build();\n    this.index = 0;\n    this.pad = {\n      x: 0,\n      y: 0\n    };\n    return this.streamer = this.generate(this.data);\n  }\n\n  getFilled() {\n    return this.filled;\n  }\n\n  setActive(i, j) {\n    let ref;\n    return [this.pad.x, this.pad.y] = Array.from(ref = [Math.max(0, this.width - i), Math.max(0, this.height - j)]), ref;\n  }\n\n  fill() {\n    let j, k, repeat;\n    const {\n      callback\n    } = this;\n\n    if (typeof callback.reset === \"function\") {\n      callback.reset();\n    }\n\n    const {\n      emit,\n      skip,\n      count,\n      done,\n      reset\n    } = this.streamer;\n    reset();\n    const n = this.width;\n    const pad = this.pad.x;\n    const limit = this.samples - this.pad.y * n;\n    let i = j = k = 0;\n\n    if (pad) {\n      while (!done() && k < limit) {\n        k++;\n        repeat = callback(emit, i, j);\n\n        if (++i === n - pad) {\n          skip(pad);\n          k += pad;\n          i = 0;\n          j++;\n        }\n\n        if (repeat === false) {\n          break;\n        }\n      }\n    } else {\n      while (!done() && k < limit) {\n        k++;\n        repeat = callback(emit, i, j);\n\n        if (++i === n) {\n          i = 0;\n          j++;\n        }\n\n        if (repeat === false) {\n          break;\n        }\n      }\n    }\n\n    return Math.floor(count() / this.items);\n  }\n\n  write(n) {\n    if (n == null) {\n      n = this.samples;\n    }\n\n    n *= this.items;\n    const width = this.width * this.items;\n    const height = Math.ceil(n / width);\n    this.texture.write(this.data, 0, this.index * this.height, width, height);\n    this.dataPointer.set(0.5, this.index * this.height + 0.5);\n    this.index = (this.index + this.history - 1) % this.history;\n    return this.filled = Math.min(this.history, this.filled + 1);\n  }\n\n  through(callback, target) {\n    let dst, j, src;\n    const {\n      consume,\n      skip,\n      done\n    } = src = this.streamer;\n    const {\n      emit\n    } = dst = target.streamer;\n    let i = j = 0;\n\n    let pipe = () => consume((x, y, z, w) => callback(emit, x, y, z, w, i, j));\n\n    pipe = UData.repeatCall(pipe, this.items);\n    return () => {\n      let k;\n      src.reset();\n      dst.reset();\n      const n = this.width;\n      const pad = this.pad.x;\n      const limit = this.samples - this.pad.y * n;\n      i = j = k = 0;\n\n      if (pad) {\n        while (!done() && k < limit) {\n          k++;\n          pipe();\n\n          if (++i === n - pad) {\n            skip(pad);\n            i = 0;\n            j++;\n          }\n        }\n      } else {\n        while (!done() && k < limit) {\n          k++;\n          pipe();\n\n          if (++i === n) {\n            i = 0;\n            j++;\n          }\n        }\n      }\n\n      return src.count();\n    };\n  }\n\n}\n\nexports.MatrixBuffer = MatrixBuffer;\n};"],
"names":["shadow$provide","global","require","module","exports","_getRequireWildcardCache","nodeInterop","WeakMap","cacheBabelInterop","cacheNodeInterop","Object","defineProperty","value","MatrixBuffer","UData","_interopRequireWildcard","obj","__esModule","default","cache","has","get","newObj","hasPropertyDescriptor","getOwnPropertyDescriptor","key","prototype","hasOwnProperty","call","desc","set","_databuffer","DataBuffer","constructor","renderer","shaders","options","width","height","history","depth","samples","wrap","build","_options","index","pad","x","y","streamer","generate","data","getFilled","filled","setActive","i","j","ref","Array","from","Math","max","fill","k","repeat","callback","reset","emit","skip","count","done","n","limit","floor","items","write","texture","ceil","dataPointer","min","through","target","dst","src","consume","pipe","z","w","repeatCall"]
}
