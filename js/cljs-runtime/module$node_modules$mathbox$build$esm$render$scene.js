shadow$provide.module$node_modules$mathbox$build$esm$render$scene=function(global,require,module,exports){Object.defineProperty(exports,"__esModule",{value:!0});exports.Scene=void 0;global=require("module$node_modules$three$src$core$Object3D");var _PerspectiveCamera=require("module$node_modules$three$src$cameras$PerspectiveCamera");module=require("module$node_modules$mathbox$build$esm$render$renderable");var _Scene=require("module$node_modules$three$src$scenes$Scene"),_WebGLRenderTarget=require("module$node_modules$three$src$renderers$WebGLRenderTarget");
class MathBox extends global.Object3D{constructor(){super();this.matrixAutoUpdate=this.frustumCulled=this.rotationAutoUpdate=!1}}class Scene extends module.Renderable{constructor(renderer,shaders,options){super(renderer,shaders,options);this.root=new MathBox;null!=(null!=options?options.scene:void 0)&&(this.scene=options.scene);null==this.scene&&(this.scene=new _Scene.Scene);this.pending=[];this.async=0;this.scratch=new _WebGLRenderTarget.WebGLRenderTarget(1,1);this.camera=new _PerspectiveCamera.PerspectiveCamera}inject(scene){null!=
scene&&(this.scene=scene);return this.scene.add(this.root)}unject(){return null!=this.scene?this.scene.remove(this.root):void 0}add(object){return this.async?this.pending.push(object):this._add(object)}remove(object){this.pending=this.pending.filter(o=>o!==object);if(null!=object.parent)return this._remove(object)}_add(object){return this.root.add(object)}_remove(object){return this.root.remove(object)}dispose(){if(null!=this.root.parent)return this.unject()}warmup(n){return this.async=+n||0}render(){if(this.pending.length){var {children}=
this.root,added=[];for(let i=0,end=this.async,asc=0<=end;asc?i<end:i>end;asc?i++:i--){var pending=this.pending.shift();if(!pending)break;this._add(pending);added.push(added)}var visible=children.map(function(o){return o.visible});children.map(o=>o.visible=!Array.from(added).includes(o));pending=this.renderer.getRenderTarget();this.renderer.setRenderTarget(this.scratch);this.renderer.render(this.scene,this.camera);this.renderer.setRenderTarget(pending);return children.map((o,i)=>o.visible=visible[i])}}toJSON(){return this.root.toJSON()}}
exports.Scene=Scene}
//# sourceMappingURL=module$node_modules$mathbox$build$esm$render$scene.js.map
