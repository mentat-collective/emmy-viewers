shadow$provide.module$node_modules$$mentatcollective$jsxgraph$src$base$group=function(global,require,module,exports){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0});exports.default=void 0;var _jxg=_interopRequireDefault(require("module$node_modules$$mentatcollective$jsxgraph$src$jxg")),_constants=_interopRequireDefault(require("module$node_modules$$mentatcollective$jsxgraph$src$base$constants")),_math=_interopRequireDefault(require("module$node_modules$$mentatcollective$jsxgraph$src$math$math")),
_geometry=_interopRequireDefault(require("module$node_modules$$mentatcollective$jsxgraph$src$math$geometry")),_type=_interopRequireDefault(require("module$node_modules$$mentatcollective$jsxgraph$src$utils$type"));_jxg.default.Group=function(board,id,name,objects,attributes){var i;this.board=board;this.objects={};var number=this.board.numObjects;this.board.numObjects+=1;""!==id&&_type.default.exists(id)?this.id=id:this.id=this.board.id+"Group"+number;this.board.groups[this.id]=this;this.type=_constants.default.OBJECT_TYPE_POINT;
this.elementClass=_constants.default.OBJECT_CLASS_POINT;""!==name&&_type.default.exists(name)?this.name=name:this.name="group_"+this.board.generateName(this);delete this.type;this.coords={};this.needsRegularUpdate=attributes.needsregularupdate;this.rotationCenter="centroid";this.scaleCenter=null;this.rotationPoints=[];this.translationPoints=[];this.scalePoints=[];this.scaleDirections={};this.parents=[];number=_type.default.isArray(objects)?objects:Array.prototype.slice.call(arguments,3);for(i=0;i<
number.length;i++){var obj=this.board.select(number[i]);!_type.default.evaluate(obj.visProp.fixed)&&_type.default.exists(obj.coords)&&this.addPoint(obj)}this.methodMap={ungroup:"ungroup",add:"addPoint",addPoint:"addPoint",addPoints:"addPoints",addGroup:"addGroup",remove:"removePoint",removePoint:"removePoint",setAttribute:"setAttribute",setProperty:"setAttribute"}};_jxg.default.extend(_jxg.default.Group.prototype,{ungroup:function(){var el;for(el in this.objects)if(this.objects.hasOwnProperty(el)){var p=
this.objects[el].point;if(_type.default.isArray(p.groups)){var i=_type.default.indexOf(p.groups,this.id);0<=i&&delete p.groups[i]}}this.objects={};return this},addParents:function(parents){var i;var par=_type.default.isArray(parents)?parents:arguments;var len=par.length;for(i=0;i<len;++i)_type.default.isId(this.board,par[i])?this.parents.push(par[i]):_type.default.exists(par[i].id)&&this.parents.push(par[i].id);this.parents=_type.default.uniqueArray(this.parents)},setParents:function(parents){this.parents=
[];this.addParents(parents);return this},getParents:function(){return _type.default.isArray(this.parents)?this.parents:[]},_updateCoordsCache:function(el){""!==el&&_type.default.exists(this.objects[el])&&(el=this.objects[el].point,this.coords[el.id]={usrCoords:el.coords.usrCoords.slice(0)})},update:function(){var el,desc;if(!this.needsUpdate)return this;var drag=this._update_find_drag_type();if("nothing"===drag.action)return this._updateCoordsCache(drag.id),this;var sx=this.objects[drag.id].point;
if("translation"===drag.action)var actionCenter=[sx.coords.usrCoords[1]-this.coords[drag.id].usrCoords[1],sx.coords.usrCoords[2]-this.coords[drag.id].usrCoords[2]];else if("rotation"===drag.action||"scaling"===drag.action){actionCenter="rotation"===drag.action?"rotationCenter":"scaleCenter";if(_type.default.isPoint(this[actionCenter]))actionCenter=this[actionCenter].coords.usrCoords.slice(1);else if("centroid"===this[actionCenter])actionCenter=this._update_centroid_center();else if(_type.default.isArray(this[actionCenter]))actionCenter=
this[actionCenter];else if(_type.default.isFunction(this[actionCenter]))actionCenter=this[actionCenter]();else return this;if("rotation"===drag.action)sx=_geometry.default.rad(this.coords[drag.id].usrCoords.slice(1),actionCenter,this.objects[drag.id].point),actionCenter=this.board.create("transform",[sx,actionCenter[0],actionCenter[1]],{type:"rotate"}),actionCenter.update();else if("scaling"===drag.action){var s=_geometry.default.distance(this.coords[drag.id].usrCoords.slice(1),actionCenter);if(Math.abs(s)<
_math.default.eps)return this;s=_geometry.default.distance(sx.coords.usrCoords.slice(1),actionCenter)/s;sx=0<=this.scaleDirections[drag.id].indexOf("x")?s:1;s=0<=this.scaleDirections[drag.id].indexOf("y")?s:1;actionCenter=this.board.create("transform",[1,0,0,actionCenter[0]*(1-sx),sx,0,actionCenter[1]*(1-s),0,s],{type:"generic"});actionCenter.update()}else return this}this._update_apply_transformation(drag,actionCenter);this.needsUpdate=!1;for(el in this.objects)if(this.objects.hasOwnProperty(el))for(desc in this.objects[el].descendants)this.objects[el].descendants.hasOwnProperty(desc)&&
(this.objects[el].descendants.needsUpdate=this.objects[el].descendants.needsRegularUpdate||this.board.needsFullUpdate);this.board.updateElements(drag);for(el in this.objects)this.objects.hasOwnProperty(el)&&this._updateCoordsCache(el);return this},_update_find_drag_type:function(){var action="nothing",changed=[];for(el in this.objects)if(this.objects.hasOwnProperty(el)){var obj=this.objects[el].point;obj.coords.distance(_constants.default.COORDS_BY_USER,this.coords[el])>_math.default.eps&&changed.push(obj.id)}if(0===
changed.length)return{action,id:"",changed};var el=changed[0];obj=this.objects[el].point;1<changed.length?action="translation":_type.default.isInArray(this.rotationPoints,obj)&&_type.default.exists(this.rotationCenter)?action="rotation":_type.default.isInArray(this.scalePoints,obj)&&_type.default.exists(this.scaleCenter)?action="scaling":_type.default.isInArray(this.translationPoints,obj)&&(action="translation");return{action,id:el,changed}},_update_centroid_center:function(){var el;var center=[0,
0];var len=0;for(el in this.coords)this.coords.hasOwnProperty(el)&&(center[0]+=this.coords[el].usrCoords[1],center[1]+=this.coords[el].usrCoords[2],++len);0<len&&(center[0]/=len,center[1]/=len);return center},_update_apply_transformation:function(drag,t){var el;for(el in this.objects)if(this.objects.hasOwnProperty(el))if(_type.default.exists(this.board.objects[el])){var obj=this.objects[el].point;obj.id!==drag.id?"translation"===drag.action?_type.default.isInArray(drag.changed,obj.id)||obj.coords.setCoordinates(_constants.default.COORDS_BY_USER,
[this.coords[el].usrCoords[1]+t[0],this.coords[el].usrCoords[2]+t[1]]):("rotation"===drag.action||"scaling"===drag.action)&&t.applyOnce([obj]):("rotation"===drag.action||"scaling"===drag.action)&&obj.coords.setCoordinates(_constants.default.COORDS_BY_USER,_math.default.matVecMult(t.matrix,this.coords[obj.id].usrCoords))}else delete this.objects[el]},addPoint:function(object){this.objects[object.id]={point:this.board.select(object)};this._updateCoordsCache(object.id);this.translationPoints.push(object);
object.groups.push(this.id);object.groups=_type.default.uniqueArray(object.groups);return this},addPoints:function(objects){var p;for(p=0;p<objects.length;p++)this.addPoint(objects[p]);return this},addGroup:function(group){for(var el in group.objects)group.objects.hasOwnProperty(el)&&this.addPoint(group.objects[el].point);return this},removePoint:function(point){delete this.objects[point.id];return this},setRotationCenter:function(object){this.rotationCenter=object;return this},setRotationPoints:function(objects){return this._setActionPoints("rotation",
objects)},addRotationPoint:function(point){return this._addActionPoint("rotation",point)},removeRotationPoint:function(point){return this._removeActionPoint("rotation",point)},setTranslationPoints:function(objects){return this._setActionPoints("translation",objects)},addTranslationPoint:function(point){return this._addActionPoint("translation",point)},removeTranslationPoint:function(point){return this._removeActionPoint("translation",point)},setScaleCenter:function(object){this.scaleCenter=object;
return this},setScalePoints:function(objects,direction){var i;var objs=_type.default.isArray(objects)?objects:arguments;var len=objs.length;for(i=0;i<len;++i)this.scaleDirections[this.board.select(objs[i]).id]=direction||"xy";return this._setActionPoints("scale",objects)},addScalePoint:function(point,direction){this._addActionPoint("scale",point);this.scaleDirections[this.board.select(point).id]=direction||"xy";return this},removeScalePoint:function(point){return this._removeActionPoint("scale",point)},
_setActionPoints:function(action,objects){var i;var objs=_type.default.isArray(objects)?objects:arguments;var len=objs.length;this[action+"Points"]=[];for(i=0;i<len;++i)this._addActionPoint(action,objs[i]);return this},_addActionPoint:function(action,point){this[action+"Points"].push(this.board.select(point));return this},_removeActionPoint:function(action,point){point=this[action+"Points"].indexOf(this.board.select(point));-1<point&&this[action+"Points"].splice(point,1);return this},setProperty:function(){_jxg.default.deprecated("Group.setProperty",
"Group.setAttribute()");this.setAttribute.apply(this,arguments)},setAttribute:function(){for(var el in this.objects)this.objects.hasOwnProperty(el)&&this.objects[el].point.setAttribute.apply(this.objects[el].point,arguments);return this}});_jxg.default.createGroup=function(board,parents,attributes){attributes=_type.default.copyAttributes(attributes,board.options,"group");board=new _jxg.default.Group(board,attributes.id,attributes.name,parents,attributes);board.elType="group";board.setParents(parents);
return board};_jxg.default.registerElement("group",_jxg.default.createGroup);exports.default={Group:_jxg.default.Group,createGroup:_jxg.default.createGroup}}
//# sourceMappingURL=module$node_modules$$mentatcollective$jsxgraph$src$base$group.js.map
