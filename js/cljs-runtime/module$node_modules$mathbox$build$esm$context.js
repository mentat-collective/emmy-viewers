shadow$provide.module$node_modules$mathbox$build$esm$context=function(global,require,module,exports){function _getRequireWildcardCache(nodeInterop$jscomp$0){if("function"!==typeof WeakMap)return null;var cacheBabelInterop=new WeakMap,cacheNodeInterop=new WeakMap;return(_getRequireWildcardCache=function(nodeInterop){return nodeInterop?cacheNodeInterop:cacheBabelInterop})(nodeInterop$jscomp$0)}function _interopRequireWildcard(obj,nodeInterop){if(!nodeInterop&&obj&&obj.__esModule)return obj;if(null===
obj||"object"!==typeof obj&&"function"!==typeof obj)return{default:obj};if((nodeInterop=_getRequireWildcardCache(nodeInterop))&&nodeInterop.has(obj))return nodeInterop.get(obj);var newObj={},hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor,key;for(key in obj)if("default"!==key&&Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;desc&&(desc.get||desc.set)?Object.defineProperty(newObj,key,desc):newObj[key]=
obj[key]}newObj.default=obj;nodeInterop&&nodeInterop.set(obj,newObj);return newObj}Object.defineProperty(exports,"__esModule",{value:!0});exports.Context=void 0;var Model=_interopRequireWildcard(require("module$node_modules$mathbox$build$esm$model$index")),Overlay=_interopRequireWildcard(require("module$node_modules$mathbox$build$esm$overlay$index")),Primitives=_interopRequireWildcard(require("module$node_modules$mathbox$build$esm$primitives$index")),Render=_interopRequireWildcard(require("module$node_modules$mathbox$build$esm$render$index")),
Shaders=_interopRequireWildcard(require("module$node_modules$mathbox$build$esm$shaders$index")),Stage=_interopRequireWildcard(require("module$node_modules$mathbox$build$esm$stage$index")),Util=_interopRequireWildcard(require("module$node_modules$mathbox$build$esm$util$index")),_PerspectiveCamera=require("module$node_modules$three$src$cameras$PerspectiveCamera");class Context{static initClass(){this.Namespace={Model,Overlay,Primitives,Render,Shaders,Stage,Util,DOM:Util.VDOM};this.Version="2.2.0"}constructor(renderer,
scene=null,camera=null){let canvas;this.canvas=canvas=renderer.domElement;this.element=null;this.shaders=Shaders.Factory(Shaders.Snippets);this.renderables=new Render.Factory(Render.Classes,renderer,this.shaders);this.overlays=new Overlay.Factory(Overlay.Classes,canvas);this.scene=this.renderables.make("scene",{scene});this.camera=this.defaultCamera=null!=camera?camera:new _PerspectiveCamera.PerspectiveCamera;this.attributes=new Model.Attributes(Primitives.Types,this);this.primitives=new Primitives.Factory(Primitives.Types,
this);this.root=this.primitives.make("root");this.model=new Model.Model(this.root);this.guard=new Model.Guard;this.controller=new Stage.Controller(this.model,this.primitives);this.animator=new Stage.Animator(this);this.api=new Stage.API(this);this.speed=1;this.time={now:+new Date/1E3,time:0,delta:0,clock:0,step:0}}init(){this.scene.inject();this.overlays.inject();return this}destroy(){this.scene.unject();this.overlays.unject();return this}resize(size){null==size&&(size={});null==size.renderWidth&&
(size.renderWidth=null!=size.viewWidth?size.viewWidth:size.viewWidth=1280);null==size.renderHeight&&(size.renderHeight=null!=size.viewHeight?size.viewHeight:size.viewHeight=720);null==size.pixelRatio&&(size.pixelRatio=size.renderWidth/Math.max(1E-6,size.viewWidth));null==size.aspect&&(size.aspect=size.viewWidth/Math.max(1E-6,size.viewHeight));this.root.controller.resize(size);return this}frame(time){this.pre(time);this.update();this.render();this.post();return this}pre(time){time||(time={now:+new Date/
1E3,time:0,delta:0,clock:0,step:0},time.delta=null!=this.time.now?time.now-this.time.now:0,1<time.delta&&(time.delta=1/60),time.step=time.delta*this.speed,time.time=this.time.time+time.delta,time.clock=this.time.clock+time.step);this.time=time;"function"===typeof this.root.controller.pre&&this.root.controller.pre();return this}update(){this.animator.update();this.attributes.compute();this.guard.iterate({step:()=>this.attributes.digest()||this.model.digest(),last(){return{attribute:this.attributes.getLastTrigger(),
model:this.model.getLastTrigger()}}});"function"===typeof this.root.controller.update&&this.root.controller.update();this.camera=this.root.controller.getCamera();this.speed=this.root.controller.getSpeed();return this}render(){"function"===typeof this.root.controller.render&&this.root.controller.render();this.scene.render();return this}post(){"function"===typeof this.root.controller.post&&this.root.controller.post();return this}setWarmup(n){this.scene.warmup(n);return this}getPending(){return this.scene.pending.length}}
exports.Context=Context;Context.initClass()}
//# sourceMappingURL=module$node_modules$mathbox$build$esm$context.js.map
