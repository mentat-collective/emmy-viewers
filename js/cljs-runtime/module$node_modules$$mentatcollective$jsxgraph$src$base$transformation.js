shadow$provide.module$node_modules$$mentatcollective$jsxgraph$src$base$transformation=function(global,require,module,exports){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0});exports.default=void 0;var _jxg=_interopRequireDefault(require("module$node_modules$$mentatcollective$jsxgraph$src$jxg")),_constants=_interopRequireDefault(require("module$node_modules$$mentatcollective$jsxgraph$src$base$constants")),_math=
_interopRequireDefault(require("module$node_modules$$mentatcollective$jsxgraph$src$math$math")),_type=_interopRequireDefault(require("module$node_modules$$mentatcollective$jsxgraph$src$utils$type"));_jxg.default.Transformation=function(board,type,params){this.elementClass=_constants.default.OBJECT_CLASS_OTHER;this.type=_constants.default.OBJECT_TYPE_TRANSFORMATION;this.matrix=[[1,0,0],[0,1,0],[0,0,1]];this.board=board;this.isNumericMatrix=!1;this.setMatrix(board,type,params);this.methodMap={apply:"apply",
applyOnce:"applyOnce",bindTo:"bindTo",bind:"bindTo",melt:"melt"}};_jxg.default.Transformation.prototype={};_jxg.default.extend(_jxg.default.Transformation.prototype,{update:function(){return this},setMatrix:function(board,type,params){var i;this.isNumericMatrix=!0;for(i=0;i<params.length;i++)if("number"!==typeof params[i]){this.isNumericMatrix=!1;break}if("translate"===type){if(2!==params.length)throw Error("JSXGraph: translate transformation needs 2 parameters.");this.evalParam=_type.default.createEvalFunction(board,
params,2);this.update=function(){this.matrix[1][0]=this.evalParam(0);this.matrix[2][0]=this.evalParam(1)}}else if("scale"===type){if(2!==params.length)throw Error("JSXGraph: scale transformation needs 2 parameters.");this.evalParam=_type.default.createEvalFunction(board,params,2);this.update=function(){this.matrix[1][1]=this.evalParam(0);this.matrix[2][2]=this.evalParam(1)}}else if("reflect"===type)4>params.length&&(params[0]=board.select(params[0])),2===params.length&&(params[1]=board.select(params[1])),
4===params.length&&(this.evalParam=_type.default.createEvalFunction(board,params,4)),this.update=function(){var v;1===params.length?v=params[0].stdform:2===params.length?v=_math.default.crossProduct(params[1].coords.usrCoords,params[0].coords.usrCoords):4===params.length&&(v=_math.default.crossProduct([1,this.evalParam(2),this.evalParam(3)],[1,this.evalParam(0),this.evalParam(1)]));var x=v[1];var y=v[2];var z=v[0];x=[-z*x,-z*y,x*x+y*y];var d=x[2];z=x[0]/x[2];var yoff=x[1]/x[2];x=-v[2];y=v[1];this.matrix[1][1]=
(x*x-y*y)/d;this.matrix[1][2]=2*x*y/d;this.matrix[2][1]=this.matrix[1][2];this.matrix[2][2]=-this.matrix[1][1];this.matrix[1][0]=z*(1-this.matrix[1][1])-yoff*this.matrix[1][2];this.matrix[2][0]=yoff*(1-this.matrix[2][2])-z*this.matrix[2][1]};else if("rotate"===type)3===params.length?this.evalParam=_type.default.createEvalFunction(board,params,3):0<params.length&&2>=params.length&&(this.evalParam=_type.default.createEvalFunction(board,params,1),2!==params.length||_type.default.isArray(params[1])||
(params[1]=board.select(params[1]))),this.update=function(){var x=this.evalParam(0);var co=Math.cos(x),si=Math.sin(x);this.matrix[1][1]=co;this.matrix[1][2]=-si;this.matrix[2][1]=si;this.matrix[2][2]=co;if(1<params.length){if(3===params.length){x=this.evalParam(1);var y=this.evalParam(2)}else _type.default.isArray(params[1])?(x=params[1][0],y=params[1][1]):(x=params[1].X(),y=params[1].Y());this.matrix[1][0]=x*(1-co)+y*si;this.matrix[2][0]=y*(1-co)-x*si}};else if("shear"===type){if(2!==params.length)throw Error("JSXGraph: shear transformation needs 2 parameters.");
this.evalParam=_type.default.createEvalFunction(board,params,2);this.update=function(){this.matrix[1][2]=this.evalParam(0);this.matrix[2][1]=this.evalParam(1)}}else if("generic"===type){if(9!==params.length)throw Error("JSXGraph: generic transformation needs 9 parameters.");this.evalParam=_type.default.createEvalFunction(board,params,9);this.update=function(){this.matrix[0][0]=this.evalParam(0);this.matrix[0][1]=this.evalParam(1);this.matrix[0][2]=this.evalParam(2);this.matrix[1][0]=this.evalParam(3);
this.matrix[1][1]=this.evalParam(4);this.matrix[1][2]=this.evalParam(5);this.matrix[2][0]=this.evalParam(6);this.matrix[2][1]=this.evalParam(7);this.matrix[2][2]=this.evalParam(8)}}},apply:function(p,self){this.update();return _type.default.exists(self)?_math.default.matVecMult(this.matrix,p.initialCoords.usrCoords):_math.default.matVecMult(this.matrix,p.coords.usrCoords)},applyOnce:function(p){var i;_type.default.isArray(p)||(p=[p]);var len=p.length;for(i=0;i<len;i++){this.update();var c=_math.default.matVecMult(this.matrix,
p[i].coords.usrCoords);p[i].coords.setCoordinates(_constants.default.COORDS_BY_USER,c)}},bindTo:function(p){var i;if(_type.default.isArray(p)){var len=p.length;for(i=0;i<len;i++)p[i].transformations.push(this)}else p.transformations.push(this)},setProperty:function(term){_jxg.default.deprecated("Transformation.setProperty()","Transformation.setAttribute()")},setAttribute:function(term){},melt:function(t){var res=[],i,k,s,j;var len$jscomp$0=t.matrix.length;var len0$jscomp$0=this.matrix[0].length;for(i=
0;i<len$jscomp$0;i++)res[i]=[];this.update();t.update();for(i=0;i<len$jscomp$0;i++)for(j=0;j<len0$jscomp$0;j++){for(k=s=0;k<len$jscomp$0;k++)s+=t.matrix[i][k]*this.matrix[k][j];res[i][j]=s}this.update=function(){var len=this.matrix.length,len0=this.matrix[0].length;for(i=0;i<len;i++)for(j=0;j<len0;j++)this.matrix[i][j]=res[i][j]};return this},getParents:function(){var p=[[].concat.apply([],this.matrix)];0!==this.parents.length&&(p=this.parents);return p}});_jxg.default.createTransform=function(board,
parents,attributes){return new _jxg.default.Transformation(board,attributes.type,parents)};_jxg.default.registerElement("transform",_jxg.default.createTransform);exports.default={Transformation:_jxg.default.Transformation,createTransform:_jxg.default.createTransform}}
//# sourceMappingURL=module$node_modules$$mentatcollective$jsxgraph$src$base$transformation.js.map
