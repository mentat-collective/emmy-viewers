{
"version":3,
"file":"module$node_modules$mathbox$build$esm$primitives$types$data$voxel.js",
"lineCount":11,
"mappings":"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",
"sources":["node_modules/mathbox/build/esm/primitives/types/data/voxel.js"],
"sourcesContent":["shadow$provide[\"module$node_modules$mathbox$build$esm$primitives$types$data$voxel\"] = function(global,require,module,exports) {\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Voxel = void 0;\n\nvar UData = _interopRequireWildcard(require(\"../../../util/data.js\"));\n\nvar _buffer = require(\"./buffer.js\");\n\nfunction _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== \"function\") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function (nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }\n\nfunction _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== \"object\" && typeof obj !== \"function\") { return { default: obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\n\n// TODO: This file was created by bulk-decaffeinate.\n// Sanity-check the conversion and remove this comment.\n\n/*\n * decaffeinate suggestions:\n * DS002: Fix invalid constructor\n * DS102: Remove unnecessary code created because of implicit returns\n * DS206: Consider reworking classes to avoid initClass\n * DS207: Consider shorter variations of null checks\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/master/docs/suggestions.md\n */\nclass Voxel extends _buffer.Buffer {\n  constructor(...args) {\n    super(...args);\n    this.update = this.update.bind(this);\n  }\n\n  static initClass() {\n    this.traits = [\"node\", \"buffer\", \"active\", \"data\", \"source\", \"index\", \"texture\", \"voxel\", \"raw\"];\n  }\n\n  init() {\n    this.buffer = this.spec = null;\n    this.space = {\n      width: 0,\n      height: 0,\n      depth: 0\n    };\n    this.used = {\n      width: 0,\n      height: 0,\n      depth: 0\n    };\n    this.storage = \"voxelBuffer\";\n\n    this.passthrough = (emit, x, y, z) => emit(x, y, z, 0);\n\n    super.init();\n  }\n\n  sourceShader(shader) {\n    const dims = this.getDimensions();\n    this.alignShader(dims, shader);\n    return this.buffer.shader(shader);\n  }\n\n  getDimensions() {\n    return {\n      items: this.items,\n      width: this.space.width,\n      height: this.space.height,\n      depth: this.space.depth\n    };\n  }\n\n  getActiveDimensions() {\n    return {\n      items: this.items,\n      width: this.used.width,\n      height: this.used.height,\n      depth: this.used.depth * this.buffer.getFilled()\n    };\n  }\n\n  getRawDimensions() {\n    return this.getDimensions();\n  }\n\n  make() {\n    super.make(); // Read sampling parameters\n\n    const minFilter = this.minFilter != null ? this.minFilter : this.props.minFilter;\n    const magFilter = this.magFilter != null ? this.magFilter : this.props.magFilter;\n    const type = this.type != null ? this.type : this.props.type; // Read given dimensions\n\n    const {\n      width\n    } = this.props;\n    const {\n      height\n    } = this.props;\n    const {\n      depth\n    } = this.props;\n    const reserveX = this.props.bufferWidth;\n    const reserveY = this.props.bufferHeight;\n    const reserveZ = this.props.bufferDepth;\n    const {\n      channels\n    } = this.props;\n    const {\n      items\n    } = this.props;\n    let dims = this.spec = {\n      channels,\n      items,\n      width,\n      height,\n      depth\n    };\n    this.items = dims.items;\n    this.channels = dims.channels; // Init to right size if data supplied\n\n    const {\n      data\n    } = this.props;\n    dims = UData.getDimensions(data, dims);\n    const {\n      space\n    } = this;\n    space.width = Math.max(reserveX, dims.width || 1);\n    space.height = Math.max(reserveY, dims.height || 1);\n    space.depth = Math.max(reserveZ, dims.depth || 1); // Create voxel buffer\n\n    return this.buffer = this._renderables.make(this.storage, {\n      width: space.width,\n      height: space.height,\n      depth: space.depth,\n      channels,\n      items,\n      minFilter,\n      magFilter,\n      type\n    });\n  }\n\n  unmake() {\n    super.unmake();\n\n    if (this.buffer) {\n      this.buffer.dispose();\n      return this.buffer = this.spec = null;\n    }\n  }\n\n  change(changed, touched, init) {\n    if (touched[\"texture\"] || changed[\"buffer.channels\"] || changed[\"buffer.items\"] || changed[\"voxel.bufferWidth\"] || changed[\"voxel.bufferHeight\"] || changed[\"voxel.bufferDepth\"]) {\n      return this.rebuild();\n    }\n\n    if (!this.buffer) {\n      return;\n    }\n\n    if (changed[\"voxel.width\"]) {\n      const {\n        width,\n        bufferWidth\n      } = this.props;\n      this.spec.width = width;\n\n      if (width > bufferWidth) {\n        return this.rebuild();\n      }\n    }\n\n    if (changed[\"voxel.height\"]) {\n      const {\n        height,\n        bufferHeight\n      } = this.props;\n      this.spec.height = height;\n\n      if (height > bufferHeight) {\n        return this.rebuild();\n      }\n    }\n\n    if (changed[\"voxel.depth\"]) {\n      const {\n        depth,\n        bufferDepth\n      } = this.props;\n      this.spec.depth = depth;\n\n      if (depth > bufferDepth) {\n        return this.rebuild();\n      }\n    }\n\n    if (changed[\"data.map\"] || changed[\"data.data\"] || changed[\"data.resolve\"] || changed[\"data.expr\"] || init) {\n      return this.buffer.setCallback(this.emitter());\n    }\n  }\n\n  callback(callback) {\n    if (callback.length <= 4) {\n      return callback;\n    } else {\n      return (emit, i, j, k) => {\n        return callback(emit, i, j, k, this.bufferClock, this.bufferStep);\n      };\n    }\n  }\n\n  update() {\n    if (!this.buffer) {\n      return;\n    }\n\n    const {\n      data\n    } = this.props;\n    const {\n      space,\n      used\n    } = this;\n    const w = used.width;\n    const h = used.height;\n    const d = used.depth;\n    const filled = this.buffer.getFilled();\n    this.syncBuffer(abort => {\n      if (data != null) {\n        const dims = UData.getDimensions(data, this.spec); // Grow dimensions if needed\n\n        if (dims.width > space.width || dims.height > space.height || dims.depth > space.depth) {\n          abort();\n          return this.rebuild();\n        }\n\n        used.width = dims.width;\n        used.height = dims.height;\n        used.depth = dims.depth;\n        this.buffer.setActive(used.width, used.height, used.depth);\n\n        if (typeof this.buffer.callback.rebind === \"function\") {\n          this.buffer.callback.rebind(data);\n        }\n\n        return this.buffer.update();\n      } else {\n        let _h, _w;\n\n        const width = this.spec.width || 1;\n        const height = this.spec.height || 1;\n        const depth = this.spec.depth || 1;\n        this.buffer.setActive(width, height, depth);\n        const length = this.buffer.update();\n        used.width = _w = width;\n        used.height = _h = height;\n        used.depth = Math.min(depth, Math.ceil(length / _w / _h));\n\n        if (used.depth === 1) {\n          used.height = Math.min(height, Math.ceil(length / _w));\n\n          if (used.height === 1) {\n            used.width = Math.min(width, length);\n          }\n        }\n      }\n    });\n\n    if (used.width !== w || used.height !== h || used.depth !== d || filled !== this.buffer.getFilled()) {\n      return this.trigger({\n        type: \"source.resize\"\n      });\n    }\n  }\n\n}\n\nexports.Voxel = Voxel;\nVoxel.initClass();\n};"],
"names":["shadow$provide","global","require","module","exports","_getRequireWildcardCache","nodeInterop","WeakMap","cacheBabelInterop","cacheNodeInterop","Object","defineProperty","value","Voxel","UData","_interopRequireWildcard","obj","__esModule","default","cache","has","get","newObj","hasPropertyDescriptor","getOwnPropertyDescriptor","key","prototype","hasOwnProperty","call","desc","set","_buffer","Buffer","constructor","args","update","bind","initClass","traits","init","buffer","spec","space","width","height","depth","used","storage","passthrough","emit","x","y","z","this.passthrough","sourceShader","shader","dims","getDimensions","alignShader","items","getActiveDimensions","getFilled","getRawDimensions","make","minFilter","props","magFilter","type","reserveX","bufferWidth","reserveY","bufferHeight","reserveZ","bufferDepth","channels","data","Math","max","_renderables","unmake","dispose","change","changed","touched","rebuild","setCallback","emitter","callback","length","i","j","k","bufferClock","bufferStep","w","h","d","filled","syncBuffer","abort","setActive","rebind","min","ceil","trigger"]
}
