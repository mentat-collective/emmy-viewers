shadow$provide.module$node_modules$$mentatcollective$jsxgraph$src$math$plot=function(global,require,module,exports){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0});exports.default=void 0;var _jxg=_interopRequireDefault(require("module$node_modules$$mentatcollective$jsxgraph$src$jxg")),_constants=_interopRequireDefault(require("module$node_modules$$mentatcollective$jsxgraph$src$base$constants")),_coords=_interopRequireDefault(require("module$node_modules$$mentatcollective$jsxgraph$src$base$coords")),
_math=_interopRequireDefault(require("module$node_modules$$mentatcollective$jsxgraph$src$math$math")),_extrapolate=_interopRequireDefault(require("module$node_modules$$mentatcollective$jsxgraph$src$math$extrapolate")),_numerics=_interopRequireDefault(require("module$node_modules$$mentatcollective$jsxgraph$src$math$numerics")),_statistics=_interopRequireDefault(require("module$node_modules$$mentatcollective$jsxgraph$src$math$statistics")),_geometry=_interopRequireDefault(require("module$node_modules$$mentatcollective$jsxgraph$src$math$geometry")),
_ia=_interopRequireDefault(require("module$node_modules$$mentatcollective$jsxgraph$src$math$ia")),_type=_interopRequireDefault(require("module$node_modules$$mentatcollective$jsxgraph$src$utils$type"));_math.default.Plot={checkReal:function(points){var b=!1,i,len=points.length;for(i=0;i<len;i++){var p=points[i].usrCoords;if(!isNaN(p[1])&&!isNaN(p[2])&&Math.abs(p[0])>_math.default.eps){b=!0;break}}return b},updateParametricCurveNaive:function(curve,mi,ma,len){var suspendUpdate=!1,stepSize=(ma-mi)/len;
for(ma=0;ma<len;ma++){var t=mi+ma*stepSize;curve.points[ma].setCoordinates(_constants.default.COORDS_BY_USER,[curve.X(t,suspendUpdate),curve.Y(t,suspendUpdate)],!1);curve.points[ma]._t=t;suspendUpdate=!0}return curve},isSegmentOutside:function(x0,y0,x1,y1,board){return 0>y0&&0>y1||y0>board.canvasHeight&&y1>board.canvasHeight||0>x0&&0>x1||x0>board.canvasWidth&&x1>board.canvasWidth},isDistOK:function(dx,dy,MAXX,MAXY){return Math.abs(dx)<MAXX&&Math.abs(dy)<MAXY&&!isNaN(dx+dy)},isSegmentDefined:function(x0,
y0,x1,y1){return!(isNaN(x0+y0)&&isNaN(x1+y1))},updateParametricCurveOld:function(curve,mi,ma){var i,MAX_XDIST,suspendUpdate=!1,po=new _coords.default(_constants.default.COORDS_BY_USER,[0,0],curve.board,!1),dyadicStack=[],depthStack=[],pointStack=[],divisors=[],distOK,j=0;_jxg.default.deprecated("Curve.updateParametricCurveOld()");if(curve.board.updateQuality===curve.board.BOARD_QUALITY_LOW){var MAX_DEPTH=15;var MAX_YDIST=MAX_XDIST=10}else MAX_DEPTH=21,MAX_YDIST=MAX_XDIST=.7;divisors[0]=ma-mi;for(i=
1;i<MAX_DEPTH;i++)divisors[i]=.5*divisors[i-1];i=1;dyadicStack[0]=1;depthStack[0]=0;var t=mi;po.setCoordinates(_constants.default.COORDS_BY_USER,[curve.X(t,suspendUpdate),curve.Y(t,suspendUpdate)],!1);suspendUpdate=!0;var x0=po.scrCoords[1];var y0=po.scrCoords[2];t=ma;po.setCoordinates(_constants.default.COORDS_BY_USER,[curve.X(t,suspendUpdate),curve.Y(t,suspendUpdate)],!1);ma=po.scrCoords[1];var y=po.scrCoords[2];pointStack[0]=[ma,y];var top=1;var depth=0;curve.points=[];curve.points[j++]=new _coords.default(_constants.default.COORDS_BY_SCREEN,
[x0,y0],curve.board,!1);do{for(distOK=this.isDistOK(ma-x0,y-y0,MAX_XDIST,MAX_YDIST)||this.isSegmentOutside(x0,y0,ma,y,curve.board);depth<MAX_DEPTH&&(!distOK||6>depth)&&(7>=depth||this.isSegmentDefined(x0,y0,ma,y));)dyadicStack[top]=i,depthStack[top]=depth,pointStack[top]=[ma,y],top+=1,i=2*i-1,depth++,t=mi+i*divisors[depth],po.setCoordinates(_constants.default.COORDS_BY_USER,[curve.X(t,suspendUpdate),curve.Y(t,suspendUpdate)],!1,!0),ma=po.scrCoords[1],y=po.scrCoords[2],distOK=this.isDistOK(ma-x0,y-
y0,MAX_XDIST,MAX_YDIST)||this.isSegmentOutside(x0,y0,ma,y,curve.board);1<j&&(depth=curve.points[j-2].scrCoords,distOK=[ma,y],x0=curve.points[j-1].scrCoords,i=x0[1]-depth[1],x0=x0[2]-depth[2],y0=distOK[0]-depth[1],depth=distOK[1]-depth[2],distOK=y0*y0+depth*depth,distOK>=_math.default.eps&&(distOK=(i*y0+x0*depth)/distOK,0<distOK&&(1>=distOK?(i-=distOK*y0,x0-=distOK*depth):(i-=y0,x0-=depth))),i=Math.sqrt(i*i+x0*x0),.015>i&&--j);curve.points[j]=new _coords.default(_constants.default.COORDS_BY_SCREEN,
[ma,y],curve.board,!1);curve.points[j]._t=t;j+=1;x0=ma;y0=y;--top;ma=pointStack[top][0];y=pointStack[top][1];depth=depthStack[top]+1;i=2*dyadicStack[top]}while(0<top&&5E5>j);curve.numberPoints=curve.points.length;return curve},_insertPoint_v2:function(curve,pnt,t){var lastReal=!isNaN(this._lastCrds[1]+this._lastCrds[2]),newReal=!isNaN(pnt.scrCoords[1]+pnt.scrCoords[2]),cw=curve.board.canvasWidth,ch=curve.board.canvasHeight;newReal=newReal&&-500<pnt.scrCoords[1]&&-500<pnt.scrCoords[2]&&pnt.scrCoords[1]<
cw+500&&pnt.scrCoords[2]<ch+500;if(!newReal&&lastReal||newReal&&(!lastReal||.7<Math.abs(pnt.scrCoords[1]-this._lastCrds[1])||.7<Math.abs(pnt.scrCoords[2]-this._lastCrds[2])))pnt._t=t,curve.points.push(pnt),this._lastCrds=pnt.copy("scrCoords")},neighborhood_isNaN_v2:function(curve,t0){var pnt=new _coords.default(_constants.default.COORDS_BY_USER,[0,0],curve.board,!1);var is_undef=t0+_math.default.eps;pnt.setCoordinates(_constants.default.COORDS_BY_USER,[curve.X(is_undef,!0),curve.Y(is_undef,!0)],!1);
is_undef=pnt.usrCoords;is_undef=isNaN(is_undef[1]+is_undef[2]);return is_undef||(is_undef=t0-_math.default.eps,pnt.setCoordinates(_constants.default.COORDS_BY_USER,[curve.X(is_undef,!0),curve.Y(is_undef,!0)],!1),is_undef=pnt.usrCoords,is_undef=isNaN(is_undef[1]+is_undef[2]),is_undef)?!0:!1},_borderCase:function(curve,a,b,c,ta,tb,tc,depth){var p_good=null;if(1>=depth){depth=new _coords.default(_constants.default.COORDS_BY_USER,[0,0],curve.board,!1);if(isNaN(a[1]+a[2])&&!isNaN(c[1]+c[2])&&!this.neighborhood_isNaN_v2(curve,
ta)||isNaN(b[1]+b[2])&&!isNaN(c[1]+c[2])&&!this.neighborhood_isNaN_v2(curve,tb)||!(!isNaN(c[1]+c[2])||isNaN(a[1]+a[2])&&isNaN(b[1]+b[2])||this.neighborhood_isNaN_v2(curve,tc)))return!1;var j=0;do{if(isNaN(a[1]+a[2])&&!isNaN(c[1]+c[2])){var t=ta;var t_real=tc;var t_real2=tb}else if(isNaN(b[1]+b[2])&&!isNaN(c[1]+c[2]))t=tb,t_real=tc,t_real2=ta;else if(isNaN(c[1]+c[2])&&!isNaN(b[1]+b[2]))t=tc,t_real=tb,t_real2=tb+(tb-tc);else if(isNaN(c[1]+c[2])&&!isNaN(a[1]+a[2]))t=tc,t_real=ta,t_real2=ta-(tc-ta);else return!1;
t=.5*(t+t_real);depth.setCoordinates(_constants.default.COORDS_BY_USER,[curve.X(t,!0),curve.Y(t,!0)],!1);var p=depth.usrCoords;var is_undef=isNaN(p[1]+p[2]);is_undef||(t_real2=t_real,t_real=t);++j}while(is_undef&&30>j);30>j&&(p_good=p.slice(),p.slice(),t_real=t);curve.X(t_real,!0);curve.X(t_real2,!0);curve.Y(t_real,!0);curve.Y(t_real2,!0);if(null!==p_good)return this._insertPoint_v2(curve,new _coords.default(_constants.default.COORDS_BY_USER,p_good,curve.board,!1)),!0}return!1},_plotRecursive_v2:function(curve,
a,ta,b,tb,depth,delta){var mindepth=0,pnt=new _coords.default(_constants.default.COORDS_BY_USER,[0,0],curve.board,!1);if(!(65536<curve.numberPoints)){if(depth<this.nanLevel&&this._isUndefined(curve,a,ta,b,tb)||depth<this.nanLevel&&this._isOutside(a,ta,b,tb,curve.board))return this;var tc=.5*(ta+tb);pnt.setCoordinates(_constants.default.COORDS_BY_USER,[curve.X(tc,!0),curve.Y(tc,!0)],!1);var c=pnt.scrCoords;if(this._borderCase(curve,a,b,c,ta,tb,tc,depth))return this;var ds=this._triangleDists(a,b,c);
var isSmooth=depth<this.smoothLevel&&ds[3]<delta;var isJump=depth<this.jumpLevel&&(ds[2]>.99*ds[0]||ds[1]>.99*ds[0]||Infinity===ds[0]||Infinity===ds[1]||Infinity===ds[2]);depth<this.smoothLevel+2&&ds[0]<.5*(ds[1]+ds[2])&&(mindepth=0,isSmooth=!1);--depth;isJump?this._insertPoint_v2(curve,new _coords.default(_constants.default.COORDS_BY_SCREEN,[NaN,NaN],curve.board,!1),tc):depth<=mindepth||isSmooth?this._insertPoint_v2(curve,pnt,tc):(this._plotRecursive_v2(curve,a,ta,c,tc,depth,delta),isNaN(pnt.scrCoords[1]+
pnt.scrCoords[2])||this._insertPoint_v2(curve,pnt,tc),this._plotRecursive_v2(curve,c,tc,b,tb,depth,delta));return this}},updateParametricCurve_v2:function(curve,mi,ma){var a=!1;var pa=new _coords.default(_constants.default.COORDS_BY_USER,[0,0],curve.board,!1),pb=new _coords.default(_constants.default.COORDS_BY_USER,[0,0],curve.board,!1);if(curve.board.updateQuality===curve.board.BOARD_QUALITY_LOW){var depth=_type.default.evaluate(curve.visProp.recursiondepthlow)||13;var delta=2;this.smoothLevel=depth-
6;this.jumpLevel=3}else depth=_type.default.evaluate(curve.visProp.recursiondepthhigh)||17,delta=2,this.smoothLevel=depth-9,this.jumpLevel=2;this.nanLevel=depth-4;curve.points=[];if("x"===this.xterm){var bbox=curve.board.getBoundingBox();var b=.3*(bbox[2]-bbox[0]);mi=Math.max(mi,bbox[0]-b);ma=Math.min(ma,bbox[2]+b)}pa.setCoordinates(_constants.default.COORDS_BY_USER,[curve.X(mi,a),curve.Y(mi,a)],!1);a=!0;pb.setCoordinates(_constants.default.COORDS_BY_USER,[curve.X(ma,a),curve.Y(ma,a)],!1);a=this._findStartPoint(curve,
pa.scrCoords,mi,pb.scrCoords,ma);pa.setCoordinates(_constants.default.COORDS_BY_SCREEN,a[0],!1);mi=a[1];a=this._findStartPoint(curve,pb.scrCoords,ma,pa.scrCoords,mi);pb.setCoordinates(_constants.default.COORDS_BY_SCREEN,a[0],!1);ma=a[1];this._visibleArea=[mi,ma];a=pa.copy("scrCoords");b=pb.copy("scrCoords");pa._t=mi;curve.points.push(pa);this._lastCrds=pa.copy("scrCoords");this._plotRecursive_v2(curve,a,mi,b,ma,depth,delta);pb._t=ma;curve.points.push(pb);curve.numberPoints=curve.points.length;return curve},
_insertLimesPoint:function(curve,pnt,t,depth,limes){Infinity===Math.abs(this._lastUsrCrds[1])&&Infinity===Math.abs(limes.left_x)||Infinity===Math.abs(this._lastUsrCrds[2])&&Infinity===Math.abs(limes.left_y)||(depth=new _coords.default(_constants.default.COORDS_BY_USER,[limes.left_x,limes.left_y],curve.board),depth._t=t,curve.points.push(depth),isNaN(limes.left_x)||isNaN(limes.left_y)||isNaN(limes.right_x)||isNaN(limes.right_y)||!(Math.abs(limes.left_x-limes.right_x)>_math.default.eps||Math.abs(limes.left_y-
limes.right_y)>_math.default.eps)||(pnt=new _coords.default(_constants.default.COORDS_BY_SCREEN,pnt,curve.board),pnt._t=t,curve.points.push(pnt)),limes=new _coords.default(_constants.default.COORDS_BY_USER,[limes.right_x,limes.right_y],curve.board),limes._t=t,curve.points.push(limes),this._lastScrCrds=limes.copy("scrCoords"),this._lastUsrCrds=limes.copy("usrCoords"))},_insertPoint:function(curve,pnt,t,depth,limes){var last_is_real=!isNaN(this._lastScrCrds[1]+this._lastScrCrds[2]),point_is_real=!isNaN(pnt[1]+
pnt[2]),cw=curve.board.canvasWidth,ch=curve.board.canvasHeight;_type.default.exists(limes)?this._insertLimesPoint(curve,pnt,t,depth,limes):(point_is_real=point_is_real&&-500<pnt[1]&&-500<pnt[2]&&pnt[1]<cw+500&&pnt[2]<ch+500,!last_is_real&&!point_is_real||point_is_real&&last_is_real&&.8>Math.abs(pnt[1]-this._lastScrCrds[1])&&.8>Math.abs(pnt[2]-this._lastScrCrds[2])||Infinity===Math.abs(pnt[1])&&Infinity===Math.abs(this._lastUsrCrds[1])||Infinity===Math.abs(pnt[2])&&Infinity===Math.abs(this._lastUsrCrds[2])||
(pnt=new _coords.default(_constants.default.COORDS_BY_SCREEN,pnt,curve.board),pnt._t=t,curve.points.push(pnt),this._lastScrCrds=pnt.copy("scrCoords"),this._lastUsrCrds=pnt.copy("usrCoords")))},_triangleDists:function(a,b,c){var d=[a[0]*b[0],.5*(a[1]+b[1]),.5*(a[2]+b[2])];var d_ab=_geometry.default.distance(a,b,3);a=_geometry.default.distance(a,c,3);b=_geometry.default.distance(c,b,3);c=_geometry.default.distance(c,d,3);return[d_ab,a,b,c]},_isUndefined:function(curve,a,ta,b,tb){if(!isNaN(a[1]+a[2])||
!isNaN(b[1]+b[2]))return!1;var pnt=new _coords.default(_constants.default.COORDS_BY_USER,[0,0],curve.board,!1);for(b=0;20>b;++b)if(a=ta+Math.random()*(tb-ta),pnt.setCoordinates(_constants.default.COORDS_BY_USER,[curve.X(a,!0),curve.Y(a,!0)],!1),!isNaN(pnt.scrCoords[0]+pnt.scrCoords[1]+pnt.scrCoords[2]))return!1;return!0},_isOutside:function(a,ta,b,tb,board){ta=board.canvasWidth;board=board.canvasHeight;return!!(-500>a[1]&&-500>b[1]||-500>a[2]&&-500>b[2]||a[1]>ta+500&&b[1]>ta+500||a[2]>board+500&&
b[2]>board+500)},_isOutsidePoint:function(a,board){var cw=board.canvasWidth;board=board.canvasHeight;return!!(-500>a[1]||-500>a[2]||a[1]>cw+500||a[2]>board+500)},_findStartPoint:function(curve,a,ta,b,tb){new _coords.default(_constants.default.COORDS_BY_USER,[0,0],curve.board,!1);curve.board.getBoundingBox();return[a,ta]},_getBorderPos:function(curve,ta,a,tc,c,tb,b){var pnt=new _coords.default(_constants.default.COORDS_BY_USER,[0,0],curve.board,!1);var j=0;if(isNaN(a[1]+a[2])&&!isNaN(c[1]+c[2]))a=
ta;else if(isNaN(b[1]+b[2])&&!isNaN(c[1]+c[2]))a=tb;else if(isNaN(c[1]+c[2])&&!isNaN(b[1]+b[2]))a=tc,tc=tb;else if(isNaN(c[1]+c[2])&&!isNaN(a[1]+a[2]))a=tc,tc=ta;else return!1;do ta=.5*(tc+a),pnt.setCoordinates(_constants.default.COORDS_BY_USER,[curve.X(ta,!0),curve.Y(ta,!0)],!1),tb=pnt.usrCoords,(tb=isNaN(tb[1]+tb[2]))?a=ta:tc=ta,++j;while(30>j&&Math.abs(tc-a)>_math.default.eps);return ta},_getCuspPos:function(curve,ta,tb){var a=[curve.X(ta,!0),curve.Y(ta,!0)],b=[curve.X(tb,!0),curve.Y(tb,!0)];return _numerics.default.fminbr(function(t){t=
[curve.X(t,!0),curve.Y(t,!0)];return-(Math.sqrt((a[0]-t[0])*(a[0]-t[0])+(a[1]-t[1])*(a[1]-t[1]))+Math.sqrt((b[0]-t[0])*(b[0]-t[0])+(b[1]-t[1])*(b[1]-t[1])))},[ta,tb],curve)},_getJumpPos:function(curve,ta,tb){return _numerics.default.fminbr(function(t){var e=_math.default.eps*_math.default.eps,c1=[curve.X(t,!0),curve.Y(t,!0)];t=[curve.X(t+e,!0),curve.Y(t+e,!0)];return-Math.abs((t[1]-c1[1])/(t[0]-c1[0]))},[ta,tb],curve)},_getLimits:function(curve,t){var step=2/(curve.maxX()-curve.minX());var res=_extrapolate.default.limit(t,
-step,curve.X);var x_l=res[0];"infinite"===res[1]&&(x_l=Infinity*Math.sign(x_l));res=_extrapolate.default.limit(t,-step,curve.Y);var y_l=res[0];"infinite"===res[1]&&(y_l=Infinity*Math.sign(y_l));res=_extrapolate.default.limit(t,step,curve.X);var x_r=res[0];"infinite"===res[1]&&(x_r=Infinity*Math.sign(x_r));res=_extrapolate.default.limit(t,step,curve.Y);curve=res[0];"infinite"===res[1]&&(curve=Infinity*Math.sign(curve));return{left_x:x_l,left_y:y_l,right_x:x_r,right_y:curve,t}},_getLimes:function(curve,
ta,a,tc,c,tb,b,may_be_special,depth){var t;"border"===may_be_special?t=this._getBorderPos(curve,ta,a,tc,c,tb,b):"cusp"===may_be_special?t=this._getCuspPos(curve,ta,tb):"jump"===may_be_special&&(t=this._getJumpPos(curve,ta,tb));return this._getLimits(curve,t)},_plotNonRecursive:function(curve,a,ta,b,tb,d){var stack=[],stack_length=0;var oc=curve.board.origin.scrCoords;for(stack[stack_length++]=[a,ta,b,tb,d,Infinity];0<stack_length;){var tc=stack[--stack_length];a=tc[0];ta=tc[1];b=tc[2];tb=tc[3];d=
tc[4];var isSmooth=tc[5];var may_be_special="";var limes=null;if(65536<curve.points.length)return;if(d<this.nanLevel){if(this._isUndefined(curve,a,ta,b,tb))continue;if(this._isOutside(a,ta,b,tb,curve.board))continue}tc=.5*(ta+tb);var c=curve.X(tc,!0);var ds=curve.Y(tc,!0);c=[1,oc[1]+c*curve.board.unitX,oc[2]-ds*curve.board.unitY];ds=this._triangleDists(a,b,c);var a_nan=isNaN(a[1]+a[2]);var b_nan=isNaN(b[1]+b[2]);if(a_nan&&!b_nan||!a_nan&&b_nan)may_be_special="border";else if(ds[0]>.66*isSmooth||ds[0]<
this.cusp_threshold*(ds[1]+ds[2])||ds[1]>5*ds[2]||ds[2]>5*ds[1])may_be_special="cusp";else if(ds[2]>this.jump_threshold*ds[0]||ds[1]>this.jump_threshold*ds[0]||Infinity===ds[0]||Infinity===ds[1]||Infinity===ds[2])may_be_special="jump";isSmooth=""===may_be_special&&d<this.smoothLevel&&ds[3]<this.smooth_threshold;d<this.testLevel&&!isSmooth&&(""===may_be_special?isSmooth=!0:limes=this._getLimes(curve,ta,a,tc,c,tb,b,may_be_special,d));null!==limes?(c=[1,NaN,NaN],this._insertPoint(curve,c,tc,d,limes)):
0>=d||isSmooth?this._insertPoint(curve,c,tc,d,null):(stack[stack_length++]=[c,tc,b,tb,d-1,ds[0]],stack[stack_length++]=[a,ta,c,tc,d-1,ds[0]])}return this},updateParametricCurve_v3:function(curve,mi,ma){var a=!1;var pa=new _coords.default(_constants.default.COORDS_BY_USER,[0,0],curve.board,!1),pb=new _coords.default(_constants.default.COORDS_BY_USER,[0,0],curve.board,!1);var depth=curve.board.updateQuality===curve.board.BOARD_QUALITY_LOW?_type.default.evaluate(curve.visProp.recursiondepthlow)||14:
_type.default.evaluate(curve.visProp.recursiondepthhigh)||17;this.smoothLevel=7;this.nanLevel=depth-4;this.testLevel=4;this.cusp_threshold=.5;this.jump_threshold=.99;this.smooth_threshold=2;curve.points=[];if("x"===curve.xterm){var bbox=curve.board.getBoundingBox();var b=.3*(bbox[2]-bbox[0]);mi=Math.max(mi,bbox[0]-b);ma=Math.min(ma,bbox[2]+b)}pa.setCoordinates(_constants.default.COORDS_BY_USER,[curve.X(mi,a),curve.Y(mi,a)],!1);a=!0;pb.setCoordinates(_constants.default.COORDS_BY_USER,[curve.X(ma,a),
curve.Y(ma,a)],!1);a=this._findStartPoint(curve,pa.scrCoords,mi,pb.scrCoords,ma);pa.setCoordinates(_constants.default.COORDS_BY_SCREEN,a[0],!1);mi=a[1];a=this._findStartPoint(curve,pb.scrCoords,ma,pa.scrCoords,mi);pb.setCoordinates(_constants.default.COORDS_BY_SCREEN,a[0],!1);ma=a[1];this._visibleArea=[mi,ma];a=pa.copy("scrCoords");b=pb.copy("scrCoords");pa._t=mi;curve.points.push(pa);this._lastScrCrds=pa.copy("scrCoords");this._lastUsrCrds=pa.copy("usrCoords");this._plotNonRecursive(curve,a,mi,b,
ma,depth);pb._t=ma;curve.points.push(pb);curve.numberPoints=curve.points.length;return curve},_criticalInterval:function(vec,le,level){var sgnChange=!1;var last=-Infinity,very_small=!1,smooth=!1,group=0,groups=[],types=[],positions=[];var abs_vec=_statistics.default.abs(vec);var med=_statistics.default.median(abs_vec);1E-7>med?(med=1E-7,very_small=!0):med*=this.criticalThreshold;for(level=0;level<le;level++)abs_vec[level]>med?(positions.push({i:level,v:vec[level],group}),last=level,sgnChange||(sgnChange=
!0)):sgnChange&&level>last+4&&(0<positions.length&&groups.push(positions.slice(0)),positions=[],sgnChange=!1,group++);sgnChange&&1<positions.length&&groups.push(positions.slice(0));very_small&&0===groups.length&&(smooth=!0);for(vec=0;vec<groups.length;vec++)if(types[vec]="point",le=groups[vec].length,!(64>le)){sgnChange=0;med=Math.sign(groups[vec][0].v);for(level=1;level<le;level++)Math.sign(groups[vec][level].v)!==med&&(sgnChange++,med=Math.sign(groups[vec][level].v));6*sgnChange>le&&(types[vec]=
"interval")}return{smooth,groups,types}},Component:function(){this.right_isNaN=this.left_isNaN=!1;this.right_t=this.left_t=null;this.t_values=[];this.x_values=[];this.y_values=[];this.len=0},findComponents:function(curve,mi,ma,steps){var components=[],comp_nr=0,cnt=0,cntNaNs=0,comp_started=!1,suspended=!1;var h=(ma-mi)/steps;components[comp_nr]=new this.Component;var comp=components[comp_nr];for(ma=0;ma<=steps;ma++,mi+=h){var x=curve.X(mi,suspended);var y=curve.Y(mi,suspended);isNaN(x)||isNaN(y)?
(cntNaNs++,1<cntNaNs&&comp_started&&(comp.right_isNaN=!0,comp.right_t=mi-h,comp.len=cnt,comp_started=!1,comp_nr++,components[comp_nr]=new this.Component,comp=components[comp_nr],cntNaNs=0)):(comp_started||(comp_started=!0,cnt=0,0<cntNaNs&&(comp.left_t=mi-h,comp.left_isNaN=!0)),cntNaNs=0,comp.t_values[cnt]=mi,comp.x_values[cnt]=x,comp.y_values[cnt]=y,cnt++);0===ma&&(suspended=!0)}comp_started?comp.len=cnt:components.pop();return components},getPointType:function(curve,pos,t_approx,t_values,x_table,
y_table,len){curve=x_table[0];y_table=y_table[0];x_table=t_values.length;t_approx={idx:pos,t:t_approx,x:curve[pos],y:y_table[pos],type:"other"};if(5>pos)return t_approx.type="borderleft",t_approx.idx=0,t_approx.t=t_values[0],t_approx.x=curve[0],t_approx.y=y_table[0],t_approx;pos>len-6&&(t_approx.type="borderright",t_approx.idx=x_table-1,t_approx.t=t_values[x_table-1],t_approx.x=curve[x_table-1],t_approx.y=y_table[x_table-1]);return t_approx},newtonApprox:function(idx,t,h,level,table){for(var s=0;0<
level;level--)s=(s+table[level][idx])*(t-(level-1)*h)/level;return s+table[0][idx]},thiele:function(t,recip,t_values,idx,degree){for(var v=0;1<degree;degree--)v=(t-t_values[idx+degree])/(recip[degree][idx+1]-recip[degree-2][idx+1]+v);return recip[0][idx+1]+(t-t_values[idx+1])/(recip[1][idx+1]+v)},differenceMethodExperiments:function(component,curve){var level,t_values=component.t_values,x_values=component.x_values,y_values=component.y_values,x_diffs=[],y_diffs=[],x_slopes=[],y_slopes=[],x_table=[],
y_table=[],x_recip=[],y_recip=[],foundCriticalPoint=0,criticalPoints=[];var h=t_values[1]-t_values[0];x_table.push([]);y_table.push([]);x_recip.push([]);y_recip.push([]);var le=y_values.length;for(component=0;component<le;component++)x_table[0][component]=x_values[component],y_table[0][component]=y_values[component],x_recip[0][component]=x_values[component],y_recip[0][component]=y_values[component];x_table.push([]);y_table.push([]);x_recip.push([]);y_recip.push([]);var numerator=h;le=y_values.length-
1;for(component=0;component<le;component++)x_diffs[component]=x_values[component+1]-x_values[component],y_diffs[component]=y_values[component+1]-y_values[component],x_slopes[component]=x_diffs[component],y_slopes[component]=y_diffs[component],x_table[1][component]=x_diffs[component],y_table[1][component]=y_diffs[component],x_recip[1][component]=numerator/x_diffs[component],y_recip[1][component]=numerator/y_diffs[component];le--;var up=Math.min(8,y_values.length-1);for(level=1;level<up;level++){x_table.push([]);
y_table.push([]);x_recip.push([]);y_recip.push([]);numerator*=h;for(component=0;component<le;component++)x_diffs[component]=x_diffs[component+1]-x_diffs[component],y_diffs[component]=y_diffs[component+1]-y_diffs[component],x_table[level+1][component]=x_diffs[component],y_table[level+1][component]=y_diffs[component],x_recip[level+1][component]=numerator/(x_recip[level][component+1]-x_recip[level][component])+x_recip[level-1][component+1],y_recip[level+1][component]=numerator/(y_recip[level][component+
1]-y_recip[level][component])+y_recip[level-1][component+1];var groups=this._criticalPoints(y_diffs,le,level);if(!1===groups){console.log("Polynomial of degree",level);groups=[];break}if(0<groups.length&&(foundCriticalPoint++,1<foundCriticalPoint&&0===level%2))break;le--}for(component=0;component<groups.length;component++){up=-Infinity;for(x_diffs=0;x_diffs<groups[component].length;x_diffs++)if(y_diffs=Math.abs(groups[component][x_diffs].v),y_diffs>up){up=y_diffs;var pos=x_diffs}pos=Math.floor(groups[component][pos].i+
level/2);criticalPoints.push(this.getPointType(curve,pos,t_values,x_values,y_values,x_slopes,y_slopes,le+1))}return[criticalPoints,x_table,y_table,x_recip,y_recip]},getCenterOfCriticalInterval:function(group,degree,t_values){var j,num=0,den=0,h=t_values[1]-t_values[0],range=[];var ma=-Infinity;range=[];for(j=0;j<group.length;j++){var v=Math.abs(group[j].v);if(v>ma){range=[j];ma=v;var pos=j}else ma===v&&range.push(j)}if(0<range.length){var pos_mean=range.reduce(function(total,val){return total+val},
0)/range.length;pos=Math.floor(pos_mean);pos_mean+=group[0].i}if(Infinity>ma){for(j=0;j<group.length;j++)num+=Math.abs(group[j].v)*group[j].i,den+=Math.abs(group[j].v);pos_mean=num/den}pos_mean+=degree/2;return[group[pos].i+degree/2,pos_mean,t_values[Math.floor(pos_mean)]+h*(pos_mean-Math.floor(pos_mean))]},differenceMethod:function(component,curve){var t_values=component.t_values;var level=component.x_values;var up=component.y_values;var x_table=[],y_table=[];var i=0;var degree_x=-1,degree_y=-1,
groups=[],criticalPoints=[];component=up.length;x_table.push(new Float64Array(level));y_table.push(new Float64Array(up));component--;up=Math.min(12,component);for(level=0;level<up;level++){x_table.push(new Float64Array(component));y_table.push(new Float64Array(component));x_table[level+1]=x_table[level].map(function(v,idx,arr){return arr[idx+1]-v});y_table[level+1]=y_table[level].map(function(v,idx,arr){return arr[idx+1]-v});var res_y=this._criticalInterval(y_table[level+1],component,level);!0===
res_y.smooth&&(degree_y=level,groups=[]);var res=this._criticalInterval(x_table[level+1],component,level);-1===degree_x&&!0===res.smooth&&(degree_x=level);if(0<=degree_y)break;if(0<res_y.groups.length&&(i++,2<i&&0===(level+1)%2)){groups=res_y.groups;var types=res_y.types;break}component--}for(i=0;i<groups.length;i++)"interval"!==types[i]&&(res=this.getCenterOfCriticalInterval(groups[i],level+1,t_values),up=res_y[0],up=Math.floor(res[1]),res=res[2],criticalPoints.push(this.getPointType(curve,up,res,
t_values,x_table,y_table,component+1)));return[criticalPoints,x_table,y_table,degree_x,degree_y]},_insertPoint_v4:function(curve,crds,t,doLog){doLog=null;0<curve.points.length&&(doLog=curve.points[curve.points.length-1].scrCoords);crds=new _coords.default(_constants.default.COORDS_BY_USER,crds,curve.board);if(null!==doLog){var x=crds.scrCoords[1]-doLog[1];doLog=crds.scrCoords[2]-doLog[2];if(x*x+doLog*doLog<.8*.8)return}crds._t=t;curve.points.push(crds)},getInterval:function(curve,ta,tb){_ia.default.disable();
ta=_ia.default.Interval(ta,tb);curve.board.mathLib=_ia.default;curve.board.mathLibJXG=_ia.default;curve.X(ta,!0);ta=curve.Y(ta,!0);curve.board.mathLib=Math;curve.board.mathLibJXG=_jxg.default.Math;return ta},sign:function(v){return 0>v?-1:0<v?1:0},handleBorder:function(curve,comp,group,x_table,y_table){x_table=group.idx;var hi=comp.t_values[1]-comp.t_values[0];if("borderleft"===group.type){var t1=comp=comp.left_isNaN?comp.left_t:group.t-hi;var t2=t1+hi}else"borderright"===group.type?(t2=comp=comp.right_isNaN?
comp.right_t:group.t+hi,t1=t2-hi):console.log("No bordercase!!!");var components2=this.findComponents(curve,t1,t2,32);if(0!==components2.length){"borderleft"===group.type&&(t1=components2[0].left_t,t2=components2[0].t_values[0],hi=components2[0].t_values[1]-components2[0].t_values[0],comp=t1=null===t1?t2-hi:t1,t1=this.getInterval(curve,t1,t2),_type.default.isObject(t1)&&(t2=t1.lo,hi=t1.hi,t1=curve.X(comp,!0),t2=0>y_table[1][x_table]?hi:t2,this._insertPoint_v4(curve,[1,t1,t2],comp)));var le=components2[0].t_values.length;
for(hi=0;hi<le;hi++)comp=components2[0].t_values[hi],t1=components2[0].x_values[hi],t2=components2[0].y_values[hi],this._insertPoint_v4(curve,[1,t1,t2],comp);"borderright"===group.type&&(t1=components2[0].t_values[le-1],t2=components2[0].right_t,hi=components2[0].t_values[1]-components2[0].t_values[0],comp=t2=null===t2?t1+hi:t2,t1=this.getInterval(curve,t1,t2),_type.default.isObject(t1)&&(t2=t1.lo,hi=t1.hi,t1=curve.X(comp,!0),t2=0<y_table[1][x_table]?hi:t2,this._insertPoint_v4(curve,[1,t1,t2],comp)))}},
_seconditeration_v4:function(curve,comp,group,x_table,y_table){var g,start;comp=this.findComponents(curve,comp.t_values[group.idx-2],comp.t_values[group.idx+2],64);for(x_table=0;x_table<comp.length;x_table++){group=comp[x_table];var i=this.differenceMethod(group,curve);y_table=i[0];var x_table2=i[1];var y_table2=i[2];for(g=start=0;g<=y_table.length;g++){var le=g===y_table.length?group.len:y_table[g].idx;for(i=start;i<le;i++)isNaN(group.x_values[i])||isNaN(group.y_values[i])||this._insertPoint_v4(curve,
[1,group.x_values[i],group.y_values[i]],group.t_values[i]);g<y_table.length&&(this.handleSingularity(curve,group,y_table[g],x_table2,y_table2),start=y_table[g].idx+1)}x_table<comp.length-1&&this._insertPoint_v4(curve,[1,NaN,NaN],group.right_t)}return this},_recurse_v4:function(curve,t1,t2,x1,y1,x2,y2,level){var t=.5*(t1+t2),x=curve.X(t,!0),y=curve.Y(t,!0);if(0===level)this._insertPoint_v4(curve,[1,NaN,NaN],t);else{var dx=(x-x1)*curve.board.unitX;var dy=(y-y1)*curve.board.unitY;2<Math.sqrt(dx*dx+dy*
dy)?this._recurse_v4(curve,t1,t,x1,y1,x,y,level-1):this._insertPoint_v4(curve,[1,x,y],t);dx=(x-x2)*curve.board.unitX;dy=(y-y2)*curve.board.unitY;2<Math.sqrt(dx*dx+dy*dy)?this._recurse_v4(curve,t,t2,x,y,x2,y2,level-1):this._insertPoint_v4(curve,[1,x,y],t)}},handleSingularity:function(curve,comp,group,x_table,y_table){var idx=group.idx;var t=group.t;console.log("HandleSingularity at t \x3d",t);var t1=comp.t_values[idx-5];var t2=comp.t_values[idx+5];var y_int=this.getInterval(curve,t1,t2);if(_type.default.isObject(y_int)){var lo=
y_int.lo;var hi=y_int.hi}else y_table[0][idx-1]<y_table[0][idx+1]?(lo=y_table[0][idx-1],hi=y_table[0][idx+1]):(lo=y_table[0][idx+1],hi=y_table[0][idx-1]);y_int=curve.X(t,!0);t1=(y_table[0][idx-3]-y_table[0][idx-5])/(comp.t_values[idx-3]-comp.t_values[idx-5]);var d_rgt=(y_table[0][idx+3]-y_table[0][idx+5])/(comp.t_values[idx+3]-comp.t_values[idx+5]);console.log(":::",t1,d_rgt);-100>t1?(this._insertPoint_v4(curve,[1,y_int,lo],t,!0),100>=d_rgt&&this._insertPoint_v4(curve,[1,NaN,NaN],t)):100<t1?(this._insertPoint_v4(curve,
[1,y_int,hi],t),-100<=d_rgt&&this._insertPoint_v4(curve,[1,NaN,NaN],t)):(-Infinity===lo&&(this._insertPoint_v4(curve,[1,y_int,lo],t,!0),this._insertPoint_v4(curve,[1,NaN,NaN],t)),Infinity===hi&&(this._insertPoint_v4(curve,[1,NaN,NaN],t),this._insertPoint_v4(curve,[1,y_int,hi],t,!0)),group.t<comp.t_values[idx]?group=idx-1:(group=idx,idx+=1),t1=comp.t_values[group],t2=comp.t_values[idx],this._recurse_v4(curve,t1,t2,x_table[0][group],y_table[0][group],x_table[0][idx],y_table[0][idx],10));-100>d_rgt?
this._insertPoint_v4(curve,[1,y_int,hi],t):100<d_rgt&&this._insertPoint_v4(curve,[1,y_int,lo],t)},steps:1021,criticalThreshold:1E3,plot_v4:function(curve,ta,tb,steps){var i,g,start,good,h=(tb-ta)/steps,Ypl=function(x){return curve.Y(x,!0)},Ymi=function(x){return-curve.Y(x,!0)};var ret=.5*h;ta=this.findComponents(curve,ta,tb,steps);for(tb=0;tb<ta.length;tb++){steps=ta[tb];ret=this.differenceMethod(steps,curve);var groups=ret[0];var x_table=ret[1];var y_table=ret[2];0!==groups.length&&"borderleft"===
groups[0].type||groups.unshift({idx:0,t:steps.t_values[0],x:steps.x_values[0],y:steps.y_values[0],type:"borderleft"});if("borderright"!==groups[groups.length-1].type){var le=steps.t_values.length;groups.push({idx:le-1,t:steps.t_values[le-1],x:steps.x_values[le-1],y:steps.y_values[le-1],type:"borderright"})}for(g=start=0;g<=groups.length;g++){le=g===groups.length?steps.len:groups[g].idx-1;var bad=good=0;for(i=start;i<le-2;i++)if(this._insertPoint_v4(curve,[1,steps.x_values[i],steps.y_values[i]],steps.t_values[i]),
i>=start+3&&i<le-3&&3<y_table.length&&Math.abs(y_table[2][i])>.2*Math.abs(y_table[0][i])){var t=steps.t_values[i];ret=.25*h;var y_int=this.getInterval(curve,t,t+h);_type.default.isObject(y_int)?0<y_table[2][i]?this._insertPoint_v4(curve,[1,t+ret,y_int.lo],t+ret):this._insertPoint_v4(curve,[1,t+h-ret,y_int.hi],t+h-ret):(ret=_numerics.default.fminbr(Ypl,[t,t+h]),t=_numerics.default.fminbr(Ymi,[t,t+h]),ret<t?(this._insertPoint_v4(curve,[1,curve.X(ret,!0),curve.Y(ret,!0)],ret),this._insertPoint_v4(curve,
[1,curve.X(t,!0),curve.Y(t,!0)],t)):(this._insertPoint_v4(curve,[1,curve.X(t,!0),curve.Y(t,!0)],t),this._insertPoint_v4(curve,[1,curve.X(ret,!0),curve.Y(ret,!0)],ret)));bad++}else good++;g<groups.length&&(i=groups[g].idx,"borderleft"===groups[g].type||"borderright"===groups[g].type?this.handleBorder(curve,steps,groups[g],x_table,y_table):this._seconditeration_v4(curve,steps,groups[g],x_table,y_table),start=groups[g].idx+1+1)}le=steps.len;tb<ta.length-1&&this._insertPoint_v4(curve,[1,NaN,NaN],steps.right_t)}},
updateParametricCurve_v4:function(curve,mi,ma){if("x"===curve.xterm){var bbox=curve.board.getBoundingBox();var w2=.3*(bbox[2]-bbox[0]);mi=Math.max(mi,bbox[0]-w2);ma=Math.min(ma,bbox[2]+w2)}curve.points=[];this.plot_v4(curve,mi,ma,this.steps);curve.numberPoints=curve.points.length},updateParametricCurve:function(curve,mi,ma){return this.updateParametricCurve_v2(curve,mi,ma)}};exports.default=_math.default.Plot}
//# sourceMappingURL=module$node_modules$$mentatcollective$jsxgraph$src$math$plot.js.map
