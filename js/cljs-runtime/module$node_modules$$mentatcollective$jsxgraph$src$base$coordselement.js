shadow$provide.module$node_modules$$mentatcollective$jsxgraph$src$base$coordselement=function(global,require,module,exports){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0});exports.default=void 0;var _jxg=_interopRequireDefault(require("module$node_modules$$mentatcollective$jsxgraph$src$jxg")),_math=_interopRequireDefault(require("module$node_modules$$mentatcollective$jsxgraph$src$math$math")),_geometry=_interopRequireDefault(require("module$node_modules$$mentatcollective$jsxgraph$src$math$geometry")),
_numerics=_interopRequireDefault(require("module$node_modules$$mentatcollective$jsxgraph$src$math$numerics")),_statistics=_interopRequireDefault(require("module$node_modules$$mentatcollective$jsxgraph$src$math$statistics")),_coords=_interopRequireDefault(require("module$node_modules$$mentatcollective$jsxgraph$src$base$coords")),_constants=_interopRequireDefault(require("module$node_modules$$mentatcollective$jsxgraph$src$base$constants")),_type=_interopRequireDefault(require("module$node_modules$$mentatcollective$jsxgraph$src$utils$type"));
_jxg.default.CoordsElement=function(coordinates,isLabel){var i;_type.default.exists(coordinates)||(coordinates=[1,0,0]);for(i=0;i<coordinates.length;++i)coordinates[i]=parseFloat(coordinates[i]);this.coords=new _coords.default(_constants.default.COORDS_BY_USER,coordinates,this.board);this.initialCoords=new _coords.default(_constants.default.COORDS_BY_USER,coordinates,this.board);this.position=null;this.onPolygon=this.isConstrained=!1;this.slideObject=null;this.slideObjects=[];this.needsUpdateFromParent=
!0;this.groups=[];this.Yjc=this.Xjc=null;this.methodMap=_type.default.deepCopy(this.methodMap,{move:"moveTo",moveTo:"moveTo",moveAlong:"moveAlong",visit:"visit",glide:"makeGlider",makeGlider:"makeGlider",intersect:"makeIntersection",makeIntersection:"makeIntersection",X:"X",Y:"Y",free:"free",setPosition:"setGliderPosition",setGliderPosition:"setGliderPosition",addConstraint:"addConstraint",dist:"Dist",onPolygon:"onPolygon"});_type.default.exists(this.element)&&this.addAnchor(coordinates,isLabel);
this.isDraggable=!0};_jxg.default.extend(_jxg.default.CoordsElement.prototype,{updateConstraint:function(){return this},updateCoords:function(fromParent){if(!this.needsUpdate)return this;_type.default.exists(fromParent)||(fromParent=!1);_type.default.evaluate(this.visProp.frozen)||this.updateConstraint();this.type===_constants.default.OBJECT_TYPE_GLIDER&&(this.isConstrained&&(fromParent=!1),fromParent?this.updateGliderFromParent():this.updateGlider());this.updateTransform(fromParent);return this},
updateGlider:function(){var d=2*Math.PI;var doRound=!1;var c=this.slideObject;var p1c=[];this.needsUpdateFromParent=!1;if(c.elementClass===_constants.default.OBJECT_CLASS_CIRCLE){_type.default.evaluate(this.visProp.isgeonext)&&(d=1);var poly=_geometry.default.projectPointToCircle(this,c,this.board);var i=_geometry.default.rad([c.center.X()+1,c.center.Y()],c.center,this)/d}else if(c.elementClass===_constants.default.OBJECT_CLASS_LINE){if(this.onPolygon){p1c=c.point1.coords.usrCoords;var p2c=c.point2.coords.usrCoords;
i=1;d=p2c[i]-p1c[i];Math.abs(d)<_math.default.eps&&(i=2,d=p2c[i]-p1c[i]);poly=_geometry.default.projectPointToLine(this,c,this.board);i=(poly.usrCoords[i]-p1c[i])/d;poly=c.parentPolygon;if(0>i)for(i=0;i<poly.borders.length;i++){if(c===poly.borders[i]){c=poly.borders[(i-1+poly.borders.length)%poly.borders.length];break}}else if(1<i)for(i=0;i<poly.borders.length;i++)if(c===poly.borders[i]){c=poly.borders[(i+1+poly.borders.length)%poly.borders.length];break}c.id!==this.slideObject.id&&(this.slideObject=
c)}p1c=c.point1.coords;p2c=c.point2.coords;d=p1c.distance(_constants.default.COORDS_BY_USER,p2c);d<_math.default.eps?(poly=p1c,doRound=!0,i=0):(poly=_geometry.default.projectPointToLine(this,c,this.board),p1c=p1c.usrCoords.slice(0),p2c=p2c.usrCoords.slice(0),Math.abs(p2c[0])<_math.default.eps?(i=1,d=p2c[i],Math.abs(d)<_math.default.eps&&(i=2,d=p2c[i]),d=(poly.usrCoords[i]-p1c[i])/d,i=0<=d?1:-1,d=Math.abs(d),i=i*d/(d+1)):Math.abs(p1c[0])<_math.default.eps?(i=1,d=p1c[i],Math.abs(d)<_math.default.eps&&
(i=2,d=p1c[i]),d=(poly.usrCoords[i]-p2c[i])/d,i=0>d?(1-2*d)/(1-d):1/(d+1)):(i=1,d=p2c[i]-p1c[i],Math.abs(d)<_math.default.eps&&(i=2,d=p2c[i]-p1c[i]),i=(poly.usrCoords[i]-p1c[i])/d));p1c=_type.default.evaluate(this.visProp.snapwidth);0<_type.default.evaluate(p1c)&&Math.abs(this._smax-this._smin)>=_math.default.eps&&(i=Math.max(Math.min(i,1),0),i=i*(this._smax-this._smin)+this._smin,i=Math.round(i/p1c)*p1c,i=(i-this._smin)/(this._smax-this._smin),this.update(!0));p1c=c.point1.coords;!_type.default.evaluate(c.visProp.straightfirst)&&
Math.abs(p1c.usrCoords[0])>_math.default.eps&&0>i&&(poly=p1c,doRound=!0,i=0);p2c=c.point2.coords;!_type.default.evaluate(c.visProp.straightlast)&&Math.abs(p2c.usrCoords[0])>_math.default.eps&&1<i&&(poly=p2c,doRound=!0,i=1)}else if(c.type===_constants.default.OBJECT_TYPE_TURTLE)this.updateConstraint(),i=_geometry.default.projectPointToTurtle(this,c,this.board),poly=i[0],i=i[1];else if(c.elementClass===_constants.default.OBJECT_CLASS_CURVE)if(c.type===_constants.default.OBJECT_TYPE_ARC||c.type===_constants.default.OBJECT_TYPE_SECTOR){poly=
_geometry.default.projectPointToCircle(this,c,this.board);var angle=_geometry.default.rad(c.radiuspoint,c.center,this);d=0;p2c=_geometry.default.rad(c.radiuspoint,c.center,c.anglepoint);i=angle;p1c=_type.default.evaluate(c.visProp.selection);if("minor"===p1c&&p2c>Math.PI||"major"===p1c&&p2c<Math.PI)d=p2c,p2c=2*Math.PI;if(angle<d||angle>p2c){i=p2c;if(angle<d&&angle>.5*d||angle>p2c&&angle>.5*p2c+Math.PI)i=d;this.needsUpdateFromParent=!0;this.updateGliderFromParent()}d=p2c-d;this.visProp.isgeonext&&
(d=1);Math.abs(d)>_math.default.eps&&(i/=d)}else if(this.updateConstraint(),0<c.transformations.length){d=!1;i=c.getTransformationSource();i[0]&&(d=i[0],p1c.push(c),p1c.push(i[1]));for(;i[0]&&_type.default.exists(i[1]._transformationSource);)i=i[1].getTransformationSource(),p1c.push(i[1]);poly=this.coords.usrCoords;if(d){for(i=0;i<p1c.length;i++)p1c[i].updateTransformMatrix(),d=_math.default.inverse(p1c[i].transformMat),poly=_math.default.matVecMult(d,poly);poly=(new _coords.default(_constants.default.COORDS_BY_USER,
poly,this.board)).usrCoords;c=_geometry.default.projectCoordsToCurve(poly[1],poly[2],this.position||0,p1c[p1c.length-1],this.board);poly=c[0].usrCoords;for(i=p1c.length-2;0<=i;i--)poly=_math.default.matVecMult(p1c[i].transformMat,poly);c[0]=new _coords.default(_constants.default.COORDS_BY_USER,poly,this.board)}else c.updateTransformMatrix(),d=_math.default.inverse(c.transformMat),poly=_math.default.matVecMult(d,poly),poly=(new _coords.default(_constants.default.COORDS_BY_USER,poly,this.board)).usrCoords,
c=_geometry.default.projectCoordsToCurve(poly[1],poly[2],this.position||0,c,this.board);poly=c[0];i=c[1]}else i=_geometry.default.projectPointToCurve(this,c,this.board),poly=i[0],i=i[1];else _type.default.isPoint(c)&&(poly=_geometry.default.projectPointToPoint(this,c,this.board),i=this.position);this.coords.setCoordinates(_constants.default.COORDS_BY_USER,poly.usrCoords,doRound);this.position=i},updateGliderFromParent:function(){var p2c=this.slideObject;var lbda=[];var p1c=2*Math.PI;if(this.needsUpdateFromParent){if(p2c.elementClass===
_constants.default.OBJECT_CLASS_CIRCLE){var r=p2c.Radius();_type.default.evaluate(this.visProp.isgeonext)&&(p1c=1);r=[p2c.center.X()+r*Math.cos(this.position*p1c),p2c.center.Y()+r*Math.sin(this.position*p1c)]}else if(p2c.elementClass===_constants.default.OBJECT_CLASS_LINE)p1c=p2c.point1.coords.usrCoords,p2c=p2c.point2.coords.usrCoords,0===p1c[0]&&0===p1c[1]&&0===p1c[2]||0===p2c[0]&&0===p2c[1]&&0===p2c[2]?r=[0,0,0]:Math.abs(p2c[0])<_math.default.eps?(lbda=Math.min(Math.abs(this.position),1-_math.default.eps),
lbda/=1-lbda,0>this.position&&(lbda=-lbda),r=[p1c[0]+lbda*p2c[0],p1c[1]+lbda*p2c[1],p1c[2]+lbda*p2c[2]]):Math.abs(p1c[0])<_math.default.eps?(lbda=Math.max(this.position,_math.default.eps),lbda=Math.min(lbda,2-_math.default.eps),lbda=1<lbda?(lbda-1)/(lbda-2):(1-lbda)/lbda,r=[p2c[0]+lbda*p1c[0],p2c[1]+lbda*p1c[1],p2c[2]+lbda*p1c[2]]):(lbda=this.position,r=[p1c[0]+lbda*(p2c[0]-p1c[0]),p1c[1]+lbda*(p2c[1]-p1c[1]),p1c[2]+lbda*(p2c[2]-p1c[2])]);else if(p2c.type===_constants.default.OBJECT_TYPE_TURTLE)this.coords.setCoordinates(_constants.default.COORDS_BY_USER,
[p2c.Z(this.position),p2c.X(this.position),p2c.Y(this.position)]),this.updateConstraint(),r=_geometry.default.projectPointToTurtle(this,p2c,this.board)[0].usrCoords;else if(p2c.elementClass===_constants.default.OBJECT_CLASS_CURVE){r=!1;p1c=p2c.getTransformationSource();p1c[0]&&(r=p1c[0],lbda.push(p2c),lbda.push(p1c[1]));for(;p1c[0]&&_type.default.exists(p1c[1]._transformationSource);)p1c=p1c[1].getTransformationSource(),lbda.push(p1c[1]);r?this.coords.setCoordinates(_constants.default.COORDS_BY_USER,
[lbda[lbda.length-1].Z(this.position),lbda[lbda.length-1].X(this.position),lbda[lbda.length-1].Y(this.position)]):this.coords.setCoordinates(_constants.default.COORDS_BY_USER,[p2c.Z(this.position),p2c.X(this.position),p2c.Y(this.position)]);if(p2c.type===_constants.default.OBJECT_TYPE_ARC||p2c.type===_constants.default.OBJECT_TYPE_SECTOR){lbda=_geometry.default.rad([p2c.center.X()+1,p2c.center.Y()],p2c.center,p2c.radiuspoint);r=0;var beta=_geometry.default.rad(p2c.radiuspoint,p2c.center,p2c.anglepoint);
if("minor"===p2c.visProp.selection&&beta>Math.PI||"major"===p2c.visProp.selection&&beta<Math.PI)r=beta,beta=2*Math.PI;p1c=beta-r;_type.default.evaluate(this.visProp.isgeonext)&&(p1c=1);var angle=this.position*p1c;if(angle<r||angle>beta){angle=beta;if(angle<r&&angle>.5*r||angle>beta&&angle>.5*beta+Math.PI)angle=r;this.position=angle;Math.abs(p1c)>_math.default.eps&&(this.position/=p1c)}r=p2c.Radius();r=[p2c.center.X()+r*Math.cos(this.position*p1c+lbda),p2c.center.Y()+r*Math.sin(this.position*p1c+lbda)]}else if(this.updateConstraint(),
r)for(r=_geometry.default.projectPointToCurve(this,lbda[lbda.length-1],this.board)[0].usrCoords,p2c=lbda.length-2;0<=p2c;p2c--)r=(new _coords.default(_constants.default.COORDS_BY_USER,_math.default.matVecMult(lbda[p2c].transformMat,r),this.board)).usrCoords;else r=_geometry.default.projectPointToCurve(this,p2c,this.board)[0].usrCoords}else _type.default.isPoint(p2c)&&(r=_geometry.default.projectPointToPoint(this,p2c,this.board).usrCoords);this.coords.setCoordinates(_constants.default.COORDS_BY_USER,
r,!1)}else this.needsUpdateFromParent=!0},updateRendererGeneric:function(rendererMethod){if(!this.needsUpdate||!this.board.renderer)return this;this.visPropCalc.visible&&(this.isReal=!isNaN(this.coords.usrCoords[1]+this.coords.usrCoords[2]),(this.isReal=Math.abs(this.coords.usrCoords[0])>_math.default.eps?this.isReal:!1)||this.updateVisibility(!1));if(this.visPropCalc.visible)this.board.renderer[rendererMethod](this);this.hasLabel&&this.visPropCalc.visible&&this.label&&this.label.visPropCalc.visible&&
this.isReal&&(this.label.update(),this.board.renderer.updateText(this.label));this.setDisplayRendNode();this.needsUpdate=!1;return this},X:function(){return this.coords.usrCoords[1]},Y:function(){return this.coords.usrCoords[2]},Z:function(){return this.coords.usrCoords[0]},XEval:function(){return this.coords.usrCoords[1]},YEval:function(){return this.coords.usrCoords[2]},ZEval:function(){return this.coords.usrCoords[0]},Dist:function(point2){return this.isReal&&point2.isReal?this.coords.distance(_constants.default.COORDS_BY_USER,
point2.coords):NaN},snapToGrid:function(force){return this.handleSnapToGrid(force)},handleSnapToPoints:function(force){var d,dMax=Infinity,c=null,ev_is2p=_type.default.evaluate(this.visProp.ignoredsnaptopoints);var len=this.board.objectsList.length;if(ev_is2p)var len2=ev_is2p.length;if(_type.default.evaluate(this.visProp.snaptopoints)||force){var ev_au=_type.default.evaluate(this.visProp.attractorunit);var ev_ad=_type.default.evaluate(this.visProp.attractordistance);for(force=0;force<len;force++){var pEl=
this.board.objectsList[force];if(ev_is2p){var ignore=!1;for(d=0;d<len2;d++)if(pEl===this.board.select(ev_is2p[d])){ignore=!0;break}if(ignore)continue}_type.default.isPoint(pEl)&&pEl!==this&&pEl.visPropCalc.visible&&(pEl=_geometry.default.projectPointToPoint(this,pEl,this.board),d="screen"===ev_au?pEl.distance(_constants.default.COORDS_BY_SCREEN,this.coords):pEl.distance(_constants.default.COORDS_BY_USER,this.coords),d<ev_ad&&d<dMax&&(dMax=d,c=pEl))}null!==c&&this.coords.setCoordinates(_constants.default.COORDS_BY_USER,
c.usrCoords)}return this},snapToPoints:function(force){return this.handleSnapToPoints(force)},handleAttractors:function(){var i,ev_au=_type.default.evaluate(this.visProp.attractorunit),ev_ad=_type.default.evaluate(this.visProp.attractordistance),ev_sd=_type.default.evaluate(this.visProp.snatchdistance),ev_a=_type.default.evaluate(this.visProp.attractors),len=ev_a.length;if(0!==ev_ad){for(i=0;i<len;i++){var el=this.board.select(ev_a[i]);if(_type.default.exists(el)&&el!==this){if(_type.default.isPoint(el))var projCoords=
_geometry.default.projectPointToPoint(this,el,this.board);else el.elementClass===_constants.default.OBJECT_CLASS_LINE?(projCoords=_geometry.default.projectCoordsToSegment(this.coords.usrCoords,el.point1.coords.usrCoords,el.point2.coords.usrCoords),projCoords=!_type.default.evaluate(el.visProp.straightfirst)&&0>projCoords[1]?el.point1.coords:!_type.default.evaluate(el.visProp.straightlast)&&1<projCoords[1]?el.point2.coords:new _coords.default(_constants.default.COORDS_BY_USER,projCoords[0],this.board)):
el.elementClass===_constants.default.OBJECT_CLASS_CIRCLE?projCoords=_geometry.default.projectPointToCircle(this,el,this.board):el.elementClass===_constants.default.OBJECT_CLASS_CURVE?projCoords=_geometry.default.projectPointToCurve(this,el,this.board)[0]:el.type===_constants.default.OBJECT_TYPE_TURTLE?projCoords=_geometry.default.projectPointToTurtle(this,el,this.board)[0]:el.type===_constants.default.OBJECT_TYPE_POLYGON&&(projCoords=new _coords.default(_constants.default.COORDS_BY_USER,_geometry.default.projectCoordsToPolygon(this.coords.usrCoords,
el),this.board));var d="screen"===ev_au?projCoords.distance(_constants.default.COORDS_BY_SCREEN,this.coords):projCoords.distance(_constants.default.COORDS_BY_USER,this.coords);if(d<ev_ad){this.type===_constants.default.OBJECT_TYPE_GLIDER&&(el===this.slideObject||this.slideObject&&this.onPolygon&&this.slideObject.parentPolygon===el)||this.makeGlider(el);break}d>=ev_sd&&(el===this.slideObject||this.slideObject&&this.onPolygon&&this.slideObject.parentPolygon===el)&&this.popSlideObject()}}return this}},
setPositionDirectly:function(method,coords){var i=this.coords;if(this.relativeCoords)return method=new _coords.default(method,coords,this.board),_type.default.evaluate(this.visProp.islabel)?(method=_statistics.default.subtract(method.scrCoords,i.scrCoords),this.relativeCoords.scrCoords[1]+=method[1],this.relativeCoords.scrCoords[2]+=method[2]):(method=_statistics.default.subtract(method.usrCoords,i.usrCoords),this.relativeCoords.usrCoords[1]+=method[1],this.relativeCoords.usrCoords[2]+=method[2]),
this;this.coords.setCoordinates(method,coords);this.handleSnapToGrid();this.handleSnapToPoints();this.handleAttractors();for(i=this.transformations.length-1;0<=i;i--){if(method===_constants.default.COORDS_BY_SCREEN)var newCoords=(new _coords.default(method,coords,this.board)).usrCoords;else 2===coords.length&&(coords=[1].concat(coords)),newCoords=coords;this.initialCoords.setCoordinates(_constants.default.COORDS_BY_USER,_math.default.matVecMult(_math.default.inverse(this.transformations[i].matrix),
newCoords))}this.prepareUpdate().update();this.board.isSuspendedUpdate&&this.type===_constants.default.OBJECT_TYPE_GLIDER&&this.updateGlider();return this},setPositionByTransform:function(method,tv){tv=new _coords.default(method,tv,this.board);method=this.board.create("transform",tv.usrCoords.slice(1),{type:"translate"});0<this.transformations.length&&this.transformations[this.transformations.length-1].isNumericMatrix?this.transformations[this.transformations.length-1].melt(method):this.addTransform(this,
method);this.prepareUpdate().update();return this},setPosition:function(method,coords){return this.setPositionDirectly(method,coords)},setGliderPosition:function(x){this.type===_constants.default.OBJECT_TYPE_GLIDER&&(this.position=x,this.board.update());return this},makeGlider:function(slide){var slideobj=this.board.select(slide),onPolygon=!1,i;if(slideobj.type===_constants.default.OBJECT_TYPE_POLYGON){onPolygon=Number.MAX_VALUE;for(i=0;i<slideobj.borders.length;i++){var dist=_jxg.default.Math.Geometry.distPointLine(this.coords.usrCoords,
slideobj.borders[i].stdform);dist<onPolygon&&(onPolygon=dist,slide=slideobj.borders[i])}slideobj=this.board.select(slide);onPolygon=!0}if(!_type.default.exists(slideobj))throw Error("JSXGraph: slide object undefined.");if(slideobj.type===_constants.default.OBJECT_TYPE_TICKS)throw Error("JSXGraph: gliders on ticks are not possible.");this.slideObject=this.board.select(slide);this.slideObjects.push(this.slideObject);this.addParents(slide);this.type=_constants.default.OBJECT_TYPE_GLIDER;this.elType=
"glider";this.visProp.snapwidth=-1;this.slideObject.addChild(this);this.isDraggable=!0;this.onPolygon=onPolygon;this.generatePolynomial=function(){return this.slideObject.generatePolynomial(this)};this.updateGlider();this.needsUpdateFromParent=!0;this.updateGliderFromParent();return this},popSlideObject:function(){0<this.slideObjects.length&&(this.slideObjects.pop(),this.slideObject.removeChild(this),0===this.slideObjects.length?(this.type=this._org_type,this.type===_constants.default.OBJECT_TYPE_POINT?
this.elType="point":this.elementClass===_constants.default.OBJECT_CLASS_TEXT?this.elType="text":this.type===_constants.default.OBJECT_TYPE_IMAGE?this.elType="image":this.type===_constants.default.OBJECT_TYPE_FOREIGNOBJECT&&(this.elType="foreignobject"),this.slideObject=null):this.slideObject=this.slideObjects[this.slideObjects.length-1])},free:function(){var ancestorId;if(this.type!==_constants.default.OBJECT_TYPE_GLIDER){this.transformations.length=0;delete this.updateConstraint;this.isConstrained=
!1;if(this.isDraggable)return;this.isDraggable=!0;this.elementClass===_constants.default.OBJECT_CLASS_POINT&&(this.type=_constants.default.OBJECT_TYPE_POINT,this.elType="point");this.XEval=function(){return this.coords.usrCoords[1]};this.YEval=function(){return this.coords.usrCoords[2]};this.ZEval=function(){return this.coords.usrCoords[0]};this.Yjc=this.Xjc=null}for(ancestorId in this.board.objects)if(this.board.objects.hasOwnProperty(ancestorId)){var ancestor=this.board.objects[ancestorId];ancestor.descendants&&
(delete ancestor.descendants[this.id],delete ancestor.childElements[this.id],this.hasLabel&&(delete ancestor.descendants[this.label.id],delete ancestor.childElements[this.label.id]))}this.ancestors={};this.slideObject=null;this.slideObjects=[];this.elementClass===_constants.default.OBJECT_CLASS_POINT?(this.type=_constants.default.OBJECT_TYPE_POINT,this.elType="point"):this.elementClass===_constants.default.OBJECT_CLASS_TEXT?(this.type=this._org_type,this.elType="text"):this.elementClass===_constants.default.OBJECT_CLASS_OTHER&&
(this.type=this._org_type,this.elType="image")},addConstraint:function(terms){var i,newfuncs=[],what=["X","Y"],makeConstFunction=function(z){return function(){return z}},makeSliderFunction=function(a){return function(){return a.Value()}};this.elementClass===_constants.default.OBJECT_CLASS_POINT&&(this.type=_constants.default.OBJECT_TYPE_CAS);this.isDraggable=!1;for(i=0;i<terms.length;i++){var v=terms[i];_type.default.isString(v)?(newfuncs[i]=this.board.jc.snippet(v,!0,null,!0),2===terms.length&&(this[what[i]+
"jc"]=terms[i])):_type.default.isFunction(v)?newfuncs[i]=v:_type.default.isNumber(v)?newfuncs[i]=makeConstFunction(v):_type.default.isObject(v)&&_type.default.isFunction(v.Value)&&(newfuncs[i]=makeSliderFunction(v));newfuncs[i].origin=v}1===terms.length?this.updateConstraint=function(){var c=newfuncs[0]();_type.default.isArray(c)?this.coords.setCoordinates(_constants.default.COORDS_BY_USER,c):this.coords=c;return this}:2===terms.length?(this.XEval=newfuncs[0],this.YEval=newfuncs[1],this.setParents([newfuncs[0].origin,
newfuncs[1].origin]),this.updateConstraint=function(){this.coords.setCoordinates(_constants.default.COORDS_BY_USER,[this.XEval(),this.YEval()]);return this}):(this.ZEval=newfuncs[0],this.XEval=newfuncs[1],this.YEval=newfuncs[2],this.setParents([newfuncs[0].origin,newfuncs[1].origin,newfuncs[2].origin]),this.updateConstraint=function(){this.coords.setCoordinates(_constants.default.COORDS_BY_USER,[this.ZEval(),this.XEval(),this.YEval()]);return this});this.isConstrained=!0;this.prepareUpdate().update();
this.board.isSuspendedUpdate||(this.updateVisibility().updateRenderer(),this.hasLabel&&this.label.fullUpdate());return this},addAnchor:function(coordinates,isLabel){this.relativeCoords=isLabel?new _coords.default(_constants.default.COORDS_BY_SCREEN,coordinates.slice(0,2),this.board):new _coords.default(_constants.default.COORDS_BY_USER,coordinates,this.board);this.element.addChild(this);isLabel&&this.addParents(this.element);this.XEval=function(){if(_type.default.evaluate(this.visProp.islabel)){var sx=
_type.default.evaluate(this.visProp.offset);sx=parseFloat(sx[0]);var anchor=this.element.getLabelAnchor();sx=new _coords.default(_constants.default.COORDS_BY_SCREEN,[sx+this.relativeCoords.scrCoords[1]+anchor.scrCoords[1],0],this.board);return sx.usrCoords[1]}anchor=this.element.getTextAnchor();return this.relativeCoords.usrCoords[1]+anchor.usrCoords[1]};this.YEval=function(){if(_type.default.evaluate(this.visProp.islabel)){var sy=_type.default.evaluate(this.visProp.offset);sy=-parseFloat(sy[1]);
var anchor=this.element.getLabelAnchor();sy=new _coords.default(_constants.default.COORDS_BY_SCREEN,[0,sy+this.relativeCoords.scrCoords[2]+anchor.scrCoords[2]],this.board);return sy.usrCoords[2]}anchor=this.element.getTextAnchor();return this.relativeCoords.usrCoords[2]+anchor.usrCoords[2]};this.ZEval=_type.default.createFunction(1,this.board,"");this.updateConstraint=function(){this.coords.setCoordinates(_constants.default.COORDS_BY_USER,[this.ZEval(),this.XEval(),this.YEval()])};this.isConstrained=
!0;this.updateConstraint()},updateTransform:function(fromParent){if(0===this.transformations.length)return this;for(fromParent=0;fromParent<this.transformations.length;fromParent++)this.transformations[fromParent].update();return this},addTransform:function(el,transform){transform=_type.default.isArray(transform)?transform:[transform];var len=transform.length;0===this.transformations.length&&(this.baseElement=el);for(el=0;el<len;el++)this.transformations.push(transform[el]);return this},startAnimation:function(direction,
stepCount,delay){var that=this;delay=delay||250;this.type!==_constants.default.OBJECT_TYPE_GLIDER||_type.default.exists(this.intervalCode)||(this.intervalCode=window.setInterval(function(){that._anim(direction,stepCount)},delay),_type.default.exists(this.intervalCount)||(this.intervalCount=0));return this},stopAnimation:function(){_type.default.exists(this.intervalCode)&&(window.clearInterval(this.intervalCode),delete this.intervalCode);return this},moveAlong:function(path,time,options){options=options||
{};var i$jscomp$0,interpath=[];var neville=[];var steps=time/this.board.attr.animationdelay;var part=function(i,j){return function(){return path[i][j]}};if(_type.default.isArray(path)){var len=path.length;for(i$jscomp$0=0;i$jscomp$0<len;i$jscomp$0++)_type.default.isPoint(path[i$jscomp$0])?neville[i$jscomp$0]=path[i$jscomp$0]:neville[i$jscomp$0]={elementClass:_constants.default.OBJECT_CLASS_POINT,X:part(i$jscomp$0,0),Y:part(i$jscomp$0,1)};if(0===(time||0))return this.setPosition(_constants.default.COORDS_BY_USER,
[neville[neville.length-1].X(),neville[neville.length-1].Y()]),this.board.update(this);if(!_type.default.exists(options.interpolate)||options.interpolate)for(neville=_numerics.default.Neville(neville),i$jscomp$0=0;i$jscomp$0<steps;i$jscomp$0++)interpath[i$jscomp$0]=[],interpath[i$jscomp$0][0]=neville[0]((steps-i$jscomp$0)/steps*neville[3]()),interpath[i$jscomp$0][1]=neville[1]((steps-i$jscomp$0)/steps*neville[3]());else{len=path.length-1;for(i$jscomp$0=0;i$jscomp$0<steps;++i$jscomp$0)time=Math.floor(i$jscomp$0/
steps*len),part=i$jscomp$0/steps*len-time,interpath[i$jscomp$0]=[],interpath[i$jscomp$0][0]=(1-part)*neville[time].X()+part*neville[time+1].X(),interpath[i$jscomp$0][1]=(1-part)*neville[time].Y()+part*neville[time+1].Y();interpath.push([neville[len].X(),neville[len].Y()]);interpath.reverse()}this.animationPath=interpath}else _type.default.isFunction(path)&&(this.animationPath=path,this.animationStart=(new Date).getTime());this.animationCallback=options.callback;this.board.addAnimation(this);return this},
moveTo:function(where,time,options){options=options||{};where=new _coords.default(_constants.default.COORDS_BY_USER,where,this.board);var steps=Math.ceil(time/this.board.attr.animationdelay),coords=[],X=this.coords.usrCoords[1],Y=this.coords.usrCoords[2],dX=where.usrCoords[1]-X,dY=where.usrCoords[2]-Y,stepFun=function(i){return options.effect&&"\x3c\x3e"===options.effect?Math.pow(Math.sin(i/steps*Math.PI/2),2):i/steps};if(!_type.default.exists(time)||0===time||Math.abs(where.usrCoords[0]-this.coords.usrCoords[0])>
_math.default.eps)return this.setPosition(_constants.default.COORDS_BY_USER,where.usrCoords),this.board.update(this);if(!_type.default.exists(options.callback)&&Math.abs(dX)<_math.default.eps&&Math.abs(dY)<_math.default.eps)return this;for(time=steps;0<=time;time--)coords[steps-time]=[where.usrCoords[0],X+dX*stepFun(time),Y+dY*stepFun(time)];this.animationPath=coords;this.animationCallback=options.callback;this.board.addAnimation(this);return this},visit:function(where,time,options){where=new _coords.default(_constants.default.COORDS_BY_USER,
where,this.board);var j=this.board.attr.animationdelay;var coords=[],X=this.coords.usrCoords[1],Y=this.coords.usrCoords[2],dX=where.usrCoords[1]-X,dY=where.usrCoords[2]-Y,stepFun=function(i){i=i<steps/2?2*i/steps:2*(steps-i)/steps;return options.effect&&"\x3c\x3e"===options.effect?Math.pow(Math.sin(i*Math.PI/2),2):i};_type.default.isNumber(options)?options={repeat:options}:(options=options||{},_type.default.exists(options.repeat)||(options.repeat=1));var steps=Math.ceil(time/(j*options.repeat));for(j=
0;j<options.repeat;j++)for(time=steps;0<=time;time--)coords[j*(steps+1)+steps-time]=[where.usrCoords[0],X+dX*stepFun(time),Y+dY*stepFun(time)];this.animationPath=coords;this.animationCallback=options.callback;this.board.addAnimation(this);return this},_anim:function(direction,stepCount){this.intervalCount+=1;this.intervalCount>stepCount&&(this.intervalCount=0);if(this.slideObject.elementClass===_constants.default.OBJECT_CLASS_LINE){var sp1c=this.slideObject.point1.coords.scrCoords;var sp2c=this.slideObject.point2.coords.scrCoords;
var dX=Math.round((sp2c[1]-sp1c[1])*this.intervalCount/stepCount);stepCount=Math.round((sp2c[2]-sp1c[2])*this.intervalCount/stepCount);0<direction?direction=this.slideObject.point1:(direction=this.slideObject.point2,dX*=-1,stepCount*=-1);this.coords.setCoordinates(_constants.default.COORDS_BY_SCREEN,[direction.coords.scrCoords[1]+dX,direction.coords.scrCoords[2]+stepCount])}else this.slideObject.elementClass===_constants.default.OBJECT_CLASS_CURVE?(direction=0<direction?Math.round(this.intervalCount/
stepCount*this.board.canvasWidth):Math.round((stepCount-this.intervalCount)/stepCount*this.board.canvasWidth),this.coords.setCoordinates(_constants.default.COORDS_BY_SCREEN,[direction,0]),direction=_geometry.default.projectPointToCurve(this,this.slideObject,this.board),this.coords=direction[0],this.position=direction[1]):this.slideObject.elementClass===_constants.default.OBJECT_CLASS_CIRCLE&&(dX=2*Math.PI,dX=0>direction?this.intervalCount/stepCount*dX:(stepCount-this.intervalCount)/stepCount*dX,direction=
this.slideObject.Radius(),this.coords.setCoordinates(_constants.default.COORDS_BY_USER,[this.slideObject.center.coords.usrCoords[1]+direction*Math.cos(dX),this.slideObject.center.coords.usrCoords[2]+direction*Math.sin(dX)]));this.board.update(this);return this},getTextAnchor:function(){return this.coords},getLabelAnchor:function(){return this.coords},getParents:function(){var p=[this.Z(),this.X(),this.Y()];0!==this.parents.length&&(p=this.parents);this.type===_constants.default.OBJECT_TYPE_GLIDER&&
(p=[this.X(),this.Y(),this.slideObject.id]);return p}});_jxg.default.CoordsElement.create=function(Callback,board,coords,attr,arg1,arg2){var isConstrained=!1,i;for(i=0;i<coords.length;i++)if(_type.default.isFunction(coords[i])||_type.default.isString(coords[i]))isConstrained=!0;if(isConstrained)Callback=new Callback(board,[0,0],attr,arg1,arg2),Callback.addConstraint(coords);else if(_type.default.isNumber(coords[0])&&_type.default.isNumber(coords[1]))Callback=new Callback(board,coords,attr,arg1,arg2),
_type.default.exists(attr.slideobject)?Callback.makeGlider(attr.slideobject):Callback.baseElement=Callback,Callback.isDraggable=!0;else if(_type.default.isObject(coords[0])&&_type.default.isTransformationOrArray(coords[1]))Callback=new Callback(board,[0,0],attr,arg1,arg2),Callback.addTransform(coords[0],coords[1]),Callback.isDraggable=!1;else return!1;Callback.handleSnapToGrid();Callback.handleSnapToPoints();Callback.handleAttractors();Callback.addParents(coords);return Callback};exports.default=
_jxg.default.CoordsElement}
//# sourceMappingURL=module$node_modules$$mentatcollective$jsxgraph$src$base$coordselement.js.map
