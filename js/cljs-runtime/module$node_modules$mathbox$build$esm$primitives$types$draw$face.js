shadow$provide.module$node_modules$mathbox$build$esm$primitives$types$draw$face=function(global,require,module,exports){function _getRequireWildcardCache(nodeInterop$jscomp$0){if("function"!==typeof WeakMap)return null;var cacheBabelInterop=new WeakMap,cacheNodeInterop=new WeakMap;return(_getRequireWildcardCache=function(nodeInterop){return nodeInterop?cacheNodeInterop:cacheBabelInterop})(nodeInterop$jscomp$0)}function _interopRequireWildcard(obj,nodeInterop){if(!nodeInterop&&obj&&obj.__esModule)return obj;
if(null===obj||"object"!==typeof obj&&"function"!==typeof obj)return{default:obj};if((nodeInterop=_getRequireWildcardCache(nodeInterop))&&nodeInterop.has(obj))return nodeInterop.get(obj);var newObj={},hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor,key;for(key in obj)if("default"!==key&&Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;desc&&(desc.get||desc.set)?Object.defineProperty(newObj,key,
desc):newObj[key]=obj[key]}newObj.default=obj;nodeInterop&&nodeInterop.set(obj,newObj);return newObj}Object.defineProperty(exports,"__esModule",{value:!0});exports.Face=void 0;var UGLSL=_interopRequireWildcard(require("module$node_modules$mathbox$build$esm$util$glsl")),UJS=_interopRequireWildcard(require("module$node_modules$mathbox$build$esm$util$js"));global=require("module$node_modules$mathbox$build$esm$primitives$primitive");class Face extends global.Primitive{static initClass(){this.traits="node object visible style line mesh face geometry position bind shade".split(" ")}constructor(node,
context,helpers){super(node,context,helpers);this.face=null}resize(){if(null!=this.bind.points){var dims=this.bind.points.getActiveDimensions(),{items,width,height,depth}=dims;this.face&&this.face.geometry.clip(width,height,depth,items);this.line&&this.line.geometry.clip(items,width,height,depth);if(null!=this.bind.map&&(dims=this.bind.map.getActiveDimensions(),this.face))return this.face.geometry.map(dims.width,dims.height,dims.depth,dims.items)}}make(){let color;this._helpers.bind.make([{to:"geometry.points",
trait:"source"},{to:"geometry.colors",trait:"source"},{to:"mesh.map",trait:"source"}]);if(null!=this.bind.points){var position=this.bind.points.sourceShader(this._shaders.shader());position=this._helpers.position.pipeline(position);var styleUniforms=this._helpers.style.uniforms();var uniforms=this._helpers.line.uniforms();var unitUniforms=this._inherit("unit").getUnitUniforms(),wireUniforms={};wireUniforms.styleZBias=this._attributes.make(this._types.number());this.wireZBias=wireUniforms.styleZBias;
var dims=this.bind.points.getDimensions(),{items,width,height,depth}=dims,{line,shaded,fill,stroke,join}=this.props;this.bind.colors&&(color=this._shaders.shader(),this.bind.colors.sourceShader(color));dims=this._helpers.object.mask();var map=this._helpers.shade.map(null!=this.bind.map?this.bind.map.sourceShader(this._shaders.shader()):void 0),material=this._helpers.shade.pipeline(),faceMaterial=material||shaded;material=material||!1;var objects=[];if(line){const swizzle=this._shaders.shader();swizzle.pipe(UGLSL.swizzleVec4("yzwx"));
swizzle.pipe(position);uniforms=UJS.merge(unitUniforms,uniforms,styleUniforms,wireUniforms);this.line=this._renderables.make("line",{uniforms,samples:items,strips:width,ribbons:height,layers:depth,position:swizzle,color,stroke,join,material,mask:dims,closed:!0});objects.push(this.line)}fill&&(uniforms=UJS.merge(unitUniforms,styleUniforms,{}),this.face=this._renderables.make("face",{uniforms,width,height,depth,items,position,color,material:faceMaterial,mask:dims,map}),objects.push(this.face));this._helpers.visible.make();
return this._helpers.object.make(objects)}}made(){return this.resize()}unmake(){this._helpers.bind.unmake();this._helpers.visible.unmake();this._helpers.object.unmake();return this.face=this.line=null}change(changed,touched,init){if(changed["geometry.points"]||touched.mesh)return this.rebuild();if(changed["style.zBias"]||changed["mesh.lineBias"]||init){const {fill,zBias,lineBias}=this.props;return this.wireZBias.value=zBias+(fill?lineBias:0)}}}exports.Face=Face;Face.initClass()}
//# sourceMappingURL=module$node_modules$mathbox$build$esm$primitives$types$draw$face.js.map
