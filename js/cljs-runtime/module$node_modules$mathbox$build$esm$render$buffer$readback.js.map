{
"version":3,
"file":"module$node_modules$mathbox$build$esm$render$buffer$readback.js",
"lineCount":15,
"mappings":"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",
"sources":["node_modules/mathbox/build/esm/render/buffer/readback.js"],
"sourcesContent":["shadow$provide[\"module$node_modules$mathbox$build$esm$render$buffer$readback\"] = function(global,require,module,exports) {\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Readback = void 0;\n\nvar UData = _interopRequireWildcard(require(\"../../util/data.js\"));\n\nvar UGLSL = _interopRequireWildcard(require(\"../../util/glsl.js\"));\n\nvar _constants = require(\"three/src/constants.js\");\n\nvar _memo = require(\"./memo.js\");\n\nvar _memoscreen = require(\"../meshes/memoscreen.js\");\n\nvar _renderable = require(\"../renderable.js\");\n\nvar _Vector = require(\"three/src/math/Vector4.js\");\n\nfunction _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== \"function\") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function (nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }\n\nfunction _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== \"object\" && typeof obj !== \"function\") { return { default: obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\n\n// TODO: This file was created by bulk-decaffeinate.\n// Sanity-check the conversion and remove this comment.\n\n/*\n * decaffeinate suggestions:\n * DS101: Remove unnecessary use of Array.from\n * DS102: Remove unnecessary code created because of implicit returns\n * DS104: Avoid inline assignments\n * DS207: Consider shorter variations of null checks\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/master/docs/suggestions.md\n */\n\n/*\n * Readback up to 4D array of up to 4D data from GL\n */\nclass Readback extends _renderable.Renderable {\n  constructor(renderer, shaders, options) {\n    super(renderer, shaders);\n\n    if (this.items == null) {\n      this.items = options.items || 1;\n    }\n\n    if (this.channels == null) {\n      this.channels = options.channels || 4;\n    }\n\n    if (this.width == null) {\n      this.width = options.width || 1;\n    }\n\n    if (this.height == null) {\n      this.height = options.height || 1;\n    }\n\n    if (this.depth == null) {\n      this.depth = options.depth || 1;\n    }\n\n    if (this.type == null) {\n      this.type = options.type || _constants.FloatType;\n    }\n\n    if (this.stpq == null) {\n      this.stpq = options.stpq || false;\n    }\n\n    this.isFloat = this.type === _constants.FloatType;\n    this.active = this.sampled = this.rect = this.pad = null;\n    this.build(options);\n    /*\n    * log precision\n    gl = @gl\n    for name, pass of {Vertex: gl.VERTEX_SHADER, Fragment: gl.FRAGMENT_SHADER}\n      bits = for prec in [gl.LOW_FLOAT, gl.MEDIUM_FLOAT, gl.HIGH_FLOAT]\n        gl.getShaderPrecisionFormat(pass, prec).precision\n      console.log name, 'shader precision',  bits\n    */\n  }\n\n  build(options) {\n    let channels, encoder, stretch;\n    const {\n      map\n    } = options;\n    const {\n      indexer\n    } = options;\n    const isIndexed = indexer != null && !indexer.empty();\n    let {\n      stpq\n    } = this;\n    const {\n      items,\n      width,\n      height,\n      depth\n    } = this;\n    let sampler = map;\n\n    if (isIndexed) {\n      // Preserve original xyzw offset of datapoint to tie it back to the source\n      // Modulus to pack xyzw into a single integer index\n      this._adopt({\n        indexModulus: {\n          type: \"v4\",\n          value: new _Vector.Vector4(items, items * width, items * width * height, 1)\n        }\n      }); // Build shader to pack XYZ + index into a single RGBA\n\n\n      sampler = this.shaders.shader();\n\n      sampler.require(map);\n\n      sampler.require(indexer); //sampler.require UGLSL.identity 'vec4'\n\n\n      sampler.pipe(\"float.index.pack\", this.uniforms);\n    }\n\n    if (this.isFloat && this.channels > 1) {\n      // Memoize multi-channel float data into float buffer first\n      this.floatMemo = new _memo.Memo(this.renderer, this.shaders, {\n        items,\n        channels: 4,\n        width,\n        height,\n        depth,\n        history: 0,\n        type: _constants.FloatType\n      });\n      this.floatCompose = new _memoscreen.MemoScreen(this.renderer, this.shaders, {\n        map: sampler,\n        items,\n        width,\n        height,\n        depth,\n        stpq\n      });\n      this.floatMemo.adopt(this.floatCompose); // Second pass won't need texture coordinates\n\n      stpq = false; // Replace sampler with memoized sampler\n\n      sampler = this.shaders.shader();\n      this.floatMemo.shaderAbsolute(sampler);\n    }\n\n    if (this.isFloat) {\n      // Encode float data into byte buffer\n      stretch = this.channels;\n      channels = 4; // one 32-bit float per pixel\n    } else {\n      // Render byte data directly\n      stretch = 1;\n      channels = this.channels;\n    }\n\n    if (stretch > 1) {\n      // Stretch horizontally, sampling once per channel\n      encoder = this.shaders.shader();\n      encoder.pipe(UGLSL.mapByte2FloatOffset(stretch));\n\n      encoder.require(sampler);\n\n      encoder.pipe(\"float.stretch\");\n      encoder.pipe(\"float.encode\");\n      sampler = encoder;\n    } else if (this.isFloat) {\n      // Direct sampling\n      encoder = this.shaders.shader();\n      encoder.pipe(sampler);\n      encoder.pipe(UGLSL.truncateVec(4, 1));\n      encoder.pipe(\"float.encode\");\n      sampler = encoder;\n    } // Memoize byte data\n\n\n    this.byteMemo = new _memo.Memo(this.renderer, this.shaders, {\n      items: items * stretch,\n      channels: channels,\n      width,\n      height,\n      depth,\n      history: 0,\n      type: _constants.UnsignedByteType\n    });\n    this.byteCompose = new _memoscreen.MemoScreen(this.renderer, this.shaders, {\n      map: sampler,\n      items: items * stretch,\n      width,\n      height,\n      depth,\n      stpq\n    });\n    this.byteMemo.adopt(this.byteCompose); // CPU-side buffers\n\n    const w = items * width * stretch;\n    const h = height * depth;\n    this.samples = this.width * this.height * this.depth;\n    this.bytes = new Uint8Array(w * h * 4); // non-RGBA render target not supported\n\n    if (this.isFloat) {\n      this.floats = new Float32Array(this.bytes.buffer);\n    }\n\n    this.data = this.isFloat ? this.floats : this.bytes;\n    this.streamer = this.generate(this.data);\n    this.active = {\n      items: 0,\n      width: 0,\n      height: 0,\n      depth: 0\n    };\n    this.sampled = {\n      items: 0,\n      width: 0,\n      height: 0,\n      depth: 0\n    };\n    this.rect = {\n      w: 0,\n      h: 0\n    };\n    this.pad = {\n      x: 0,\n      y: 0,\n      z: 0,\n      w: 0\n    };\n    this.stretch = stretch;\n    this.isIndexed = isIndexed;\n    return this.setActive(items, width, height, depth);\n  }\n\n  generate(data) {\n    return UData.getStreamer(data, this.samples, 4, this.items);\n  } // non-RGBA render target not supported\n\n\n  setActive(items, width, height, depth) {\n    let ref;\n\n    if (items === this.active.items && width === this.active.width && height === this.active.height && depth === this.active.depth) {\n      return;\n    } // Actively sampled area\n\n\n    [this.active.items, this.active.width, this.active.height, this.active.depth] = Array.from([items, width, height, depth]); // Render only necessary samples in RTTs\n\n    if (this.floatCompose != null) {\n      this.floatCompose.cover(width, height, depth);\n    }\n\n    if (this.byteCompose != null) {\n      this.byteCompose.cover(width * this.stretch, height, depth);\n    } // Calculate readback buffer geometry\n\n\n    ({\n      items\n    } = this);\n    ({\n      width\n    } = this.active);\n    height = this.depth === 1 ? this.active.height : this.height;\n    ({\n      depth\n    } = this.active);\n    const w = items * width * this.stretch;\n    const h = height * depth; // Calculate array paddings on readback\n\n    [this.sampled.items, this.sampled.width, this.sampled.height, this.sampled.depth] = Array.from([items, width, height, depth]);\n    [this.rect.w, this.rect.h] = Array.from([w, h]);\n    return [this.pad.x, this.pad.y, this.pad.z, this.pad.w] = Array.from(ref = [this.sampled.width - this.active.width, this.sampled.height - this.active.height, this.sampled.depth - this.active.depth, this.sampled.items - this.active.items]), ref;\n  }\n\n  update(camera) {\n    if (this.floatMemo != null) {\n      this.floatMemo.render(camera);\n    }\n\n    return this.byteMemo != null ? this.byteMemo.render(camera) : undefined;\n  }\n\n  post() {\n    const currentTarget = this.renderer.getRenderTarget();\n    this.renderer.setRenderTarget(this.byteMemo.target.targets[0]);\n    this.gl.readPixels(0, 0, this.rect.w, this.rect.h, this.gl.RGBA, this.gl.UNSIGNED_BYTE, this.bytes);\n    this.renderer.setRenderTarget(currentTarget);\n  }\n\n  readFloat(n) {\n    return this.floatMemo != null ? this.floatMemo.read(n) : undefined;\n  }\n\n  readByte(n) {\n    return this.byteMemo != null ? this.byteMemo.read(n) : undefined;\n  }\n\n  setCallback(callback) {\n    this.emitter = this.callback(callback);\n  }\n\n  callback(callback) {\n    if (!this.isIndexed) {\n      return callback;\n    }\n\n    const n = this.width;\n    const m = this.height;\n    const p = this.items; // Decode packed index\n\n    const f = function (x, y, z, w) {\n      let idx = w;\n      const ll = idx % p;\n      idx = (idx - ll) / p;\n      const ii = idx % n;\n      idx = (idx - ii) / n;\n      const jj = idx % m;\n      idx = (idx - jj) / m;\n      const kk = idx;\n      return callback(x, y, z, w, ii, jj, kk, ll);\n    };\n\n    f.reset = () => typeof callback.reset === \"function\" ? callback.reset() : undefined;\n\n    return f;\n  }\n\n  iterate() {\n    let j, k, l;\n    let emit = this.emitter;\n\n    if (typeof emit.reset === \"function\") {\n      emit.reset();\n    }\n\n    const {\n      consume,\n      skip,\n      count,\n      done,\n      reset\n    } = this.streamer;\n    reset();\n    const n = this.sampled.width | 0;\n    let m = this.sampled.height | 0;\n    const o = this.sampled.depth | 0;\n    const p = this.sampled.items | 0;\n    const padX = this.pad.x | 0;\n    const padY = this.pad.y | 0;\n    const padZ = this.pad.z | 0;\n    const padW = this.pad.w | 0;\n    const limit = n * m * p * (o - padZ);\n\n    if (!this.isIndexed) {\n      const callback = emit;\n\n      emit = (x, y, z, w) => callback(x, y, z, w, i, j, k, l);\n    }\n\n    let i = j = k = l = m = 0;\n\n    while (!done() && m < limit) {\n      m++;\n      const repeat = consume(emit);\n\n      if (++l === p - padW) {\n        skip(padX);\n        l = 0;\n\n        if (++i === n - padX) {\n          skip(p * padX);\n          i = 0;\n\n          if (++j === m - padY) {\n            skip(p * n * padY);\n            j = 0;\n            k++;\n          }\n        }\n      }\n\n      if (repeat === false) {\n        break;\n      }\n    }\n\n    return Math.floor(count() / p);\n  }\n\n  dispose() {\n    if (this.floatMemo != null) {\n      this.floatMemo.unadopt(this.floatCompose);\n    }\n\n    if (this.floatMemo != null) {\n      this.floatMemo.dispose();\n    }\n\n    if (this.floatCompose != null) {\n      this.floatCompose.dispose();\n    }\n\n    if (this.byteMemo != null) {\n      this.byteMemo.unadopt(this.byteCompose);\n    }\n\n    if (this.byteMemo != null) {\n      this.byteMemo.dispose();\n    }\n\n    if (this.byteCompose != null) {\n      this.byteCompose.dispose();\n    }\n\n    return this.floatMemo = this.byteMemo = this.floatCompose = this.byteCompose = null;\n  }\n\n}\n\nexports.Readback = Readback;\n};"],
"names":["shadow$provide","global","require","module","exports","_getRequireWildcardCache","nodeInterop","WeakMap","cacheBabelInterop","cacheNodeInterop","_interopRequireWildcard","obj","__esModule","default","cache","has","get","newObj","hasPropertyDescriptor","Object","defineProperty","getOwnPropertyDescriptor","key","prototype","hasOwnProperty","call","desc","set","value","Readback","UData","UGLSL","_constants","_memo","_memoscreen","_renderable","_Vector","Renderable","constructor","renderer","shaders","options","items","channels","width","height","depth","type","FloatType","stpq","isFloat","active","sampled","rect","pad","build","stretch","map","indexer","isIndexed","empty","sampler","_adopt","indexModulus","Vector4","shader","pipe","uniforms","floatMemo","Memo","history","floatCompose","MemoScreen","adopt","shaderAbsolute","encoder","mapByte2FloatOffset","truncateVec","byteMemo","UnsignedByteType","byteCompose","samples","bytes","Uint8Array","floats","Float32Array","buffer","data","streamer","generate","w","h","x","y","z","setActive","getStreamer","ref","Array","from","cover","update","camera","render","undefined","post","currentTarget","getRenderTarget","setRenderTarget","target","targets","gl","readPixels","RGBA","UNSIGNED_BYTE","readFloat","n","read","readByte","setCallback","callback","emitter","m","p","f","idx","ll","ii","jj","reset","f.reset","iterate","j","k","l","emit","consume","skip","count","done","padX","padY","padW","limit","i","repeat","Math","floor","dispose","unadopt"]
}
