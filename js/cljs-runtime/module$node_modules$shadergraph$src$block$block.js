shadow$provide.module$node_modules$shadergraph$src$block$block=function(global,require,module$jscomp$0,exports){function _getRequireWildcardCache(nodeInterop$jscomp$0){if("function"!==typeof WeakMap)return null;var cacheBabelInterop=new WeakMap,cacheNodeInterop=new WeakMap;return(_getRequireWildcardCache=function(nodeInterop){return nodeInterop?cacheNodeInterop:cacheBabelInterop})(nodeInterop$jscomp$0)}function __guard__(value,transform){return"undefined"!==typeof value&&null!==value?transform(value):
void 0}Object.defineProperty(exports,"__esModule",{value:!0});exports.Block=void 0;var Graph=function(obj,nodeInterop){if(!nodeInterop&&obj&&obj.__esModule)return obj;if(null===obj||"object"!==typeof obj&&"function"!==typeof obj)return{default:obj};if((nodeInterop=_getRequireWildcardCache(nodeInterop))&&nodeInterop.has(obj))return nodeInterop.get(obj);var newObj={},hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor,key;for(key in obj)if("default"!==key&&Object.prototype.hasOwnProperty.call(obj,
key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;desc&&(desc.get||desc.set)?Object.defineProperty(newObj,key,desc):newObj[key]=obj[key]}newObj.default=obj;nodeInterop&&nodeInterop.set(obj,newObj);return newObj}(require("module$node_modules$shadergraph$src$graph$index")),_linker=require("module$node_modules$shadergraph$src$linker$index");class Block{static previous(outlet){return null!=outlet.input?outlet.input.node.owner:void 0}constructor(delay){null==delay&&(delay=
!1);delay||this.construct()}construct(){let left;null==this.namespace&&(this.namespace=_linker.Program.entry());return this.node=new Graph.Node(this,null!=(left="function"===typeof this.makeOutlets?this.makeOutlets():void 0)?left:{})}refresh(){let left;return this.node.setOutlets(null!=(left="function"===typeof this.makeOutlets?this.makeOutlets():void 0)?left:{})}clone(){return new Block}compile(language,namespace){language=new _linker.Program(language,null!=namespace?namespace:_linker.Program.entry(),
this.node.graph);this.call(language,0);return language.assemble()}link(language,namespace){namespace=this.compile(language,namespace);language=new _linker.Layout(language,this.node.graph);this._include(namespace,language,0);this.export(language,0);return language.link(namespace)}call(_program,_depth){}callback(_layout,_depth,_name,_external,_outlet){}export(_layout,_depth){}_info(suffix){let string=null!=(null!=this.node.owner.snippet?this.node.owner.snippet._name:void 0)?null!=this.node.owner.snippet?
this.node.owner.snippet._name:void 0:this.node.owner.namespace;if(null!=suffix)return string+("."+suffix)}_outlet(def,props){props=Graph.Outlet.make(def,props);props.meta.def=def;return props}_call(module,program,depth){return program.call(this.node,module,depth)}_require(module,program){return program.require(this.node,module)}_inputs(module,program,depth){return(()=>{const result=[];for(const arg of Array.from(module.main.signature)){const outlet=this.node.get(arg.name);result.push(__guard__(Block.previous(outlet),
x=>x.call(program,depth+1)))}return result})()}_callback(module,layout,depth,name,external,outlet){return layout.callback(this.node,module,depth,name,external,outlet)}_include(module,layout,depth){return layout.include(this.node,module,depth)}_link(module,layout,depth){return(()=>{const result=[];for(const key of Array.from(module.symbols)){const ext=module.externals[key];let outlet=this.node.get(ext.name);if(!outlet)throw new OutletError(`External not found on ${this._info(ext.name)}`);if(null!=
outlet.meta.child)continue;let parent=outlet,block;for(;!block&&parent;)[parent,outlet]=Array.from([outlet.meta.parent,parent]);block=Block.previous(outlet);if(!block)throw new OutletError(`Missing connection on ${this._info(ext.name)}`);block.callback(layout,depth+1,key,ext,outlet.input);result.push(null!=block?block.export(layout,depth+1):void 0)}return result})()}_trace(module,layout,depth){return(()=>{const result=[];for(const arg of Array.from(module.main.signature)){const outlet=this.node.get(arg.name);
result.push(__guard__(Block.previous(outlet),x=>x.export(layout,depth+1)))}return result})()}}exports.Block=Block;const OutletError=function(message){message=Error(message);message.name="OutletError";return message};OutletError.prototype=Error()}
//# sourceMappingURL=module$node_modules$shadergraph$src$block$block.js.map
