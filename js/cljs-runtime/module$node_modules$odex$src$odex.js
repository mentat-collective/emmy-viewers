shadow$provide.module$node_modules$odex$src$odex=function(global,require,module,exports){Object.defineProperty(exports,"__esModule",{value:!0});var Outcome;(function(Outcome){Outcome[Outcome.Converged=0]="Converged";Outcome[Outcome.MaxStepsExceeded=1]="MaxStepsExceeded";Outcome[Outcome.EarlyReturn=2]="EarlyReturn"})(Outcome=exports.Outcome||(exports.Outcome={}));global=function(){function Solver(n){this.n=n;this.uRound=2.3E-16;this.maxSteps=1E4;this.initialStepSize=1E-4;this.maxStepSize=0;this.maxExtrapolationColumns=
9;this.stepSizeSequence=0;this.stabilityCheckCount=1;this.stabilityCheckTableLines=2;this.denseOutput=!1;this.denseOutputErrorEstimator=!0;this.denseComponents=void 0;this.interpolationFormulaDegree=4;this.stepSizeReductionFactor=.5;this.stepSizeFac1=.02;this.stepSizeFac2=4;this.stepSizeFac3=.8;this.stepSizeFac4=.9;this.stepSafetyFactor1=.65;this.stepSafetyFactor2=.94;this.absoluteTolerance=this.relativeTolerance=1E-5;this.debug=!1}Solver.prototype.grid=function(dt,out){if(!this.denseOutput)throw Error("Must set .denseOutput to true when using grid");
var components=this.denseComponents;if(!components){components=[];for(var i=0;i<this.n;++i)components.push(i)}var t;return function(n,xOld,x,y,interpolate){if(1===n)return n=out(x,y),t=x+dt,n;for(;t<=x;){n=[];xOld=0;for(y=components;xOld<y.length;xOld++)n.push(interpolate(y[xOld],t));n=out(t,n);if(!1===n)return!1;t+=dt}}};Solver.dim2=function(r,c){for(var a=Array(r+1),i=1;i<=r;++i)a[i]=Solver.dim(c);return a};Solver.stepSizeSequence=function(nSeq,n){var a=Array(n+1);a[0]=0;switch(nSeq){case 1:for(nSeq=
1;nSeq<=n;++nSeq)a[nSeq]=2*nSeq;break;case 2:for(nSeq=a[1]=2;nSeq<=n;++nSeq)a[nSeq]=4*nSeq-4;break;case 3:a[1]=2;a[2]=4;a[3]=6;for(nSeq=4;nSeq<=n;++nSeq)a[nSeq]=2*a[nSeq-2];break;case 4:for(nSeq=1;nSeq<=n;++nSeq)a[nSeq]=4*nSeq-2;break;case 5:for(nSeq=1;nSeq<=n;++nSeq)a[nSeq]=4*nSeq;break;default:throw Error("invalid stepSizeSequence selected");}return a};Solver.prototype.solve=function(f,x$jscomp$0,y0,xEnd,solOut){function expandToArray(x,n){var tolArray=[0];if(Array.isArray(x))return tolArray.concat(x);
for(var i=0;i<n;++i)tolArray.push(x);return tolArray}var _this=this,y$jscomp$0=[0].concat(y0),dz=Solver.dim(this.n),yh1=Solver.dim(this.n),yh2=Solver.dim(this.n);if(0>=this.maxSteps)throw Error("maxSteps must be positive");var km=this.maxExtrapolationColumns;if(2>=km)throw Error("maxExtrapolationColumns must be \x3e 2");var nSeq=this.stepSizeSequence||(this.denseOutput?4:1);if(3>=nSeq&&this.denseOutput)throw Error("stepSizeSequence incompatible with denseOutput");if(this.denseOutput&&!solOut)throw Error("denseOutput requires a solution observer function");
if(0>=this.interpolationFormulaDegree||7<=this.interpolationFormulaDegree)throw Error("bad interpolationFormulaDegree");var icom=[0];y0=0;if(this.denseOutput)if(this.denseComponents)for(var _i=0,_a=this.denseComponents;_i<_a.length;_i++){var c$jscomp$0=_a[_i];if(0>c$jscomp$0||c$jscomp$0>this.n)throw Error("bad dense component: "+c$jscomp$0);icom.push(c$jscomp$0+1);++y0}else{for(y0=1;y0<=this.n;++y0)icom.push(y0);y0=this.n}if(1E-35>=this.uRound||1<this.uRound)throw Error("suspicious value of uRound");
var hMax=Math.abs(this.maxStepSize||xEnd-x$jscomp$0);_i=2*km*km+km;var aTol=expandToArray(this.absoluteTolerance,this.n),rTol=expandToArray(this.relativeTolerance,this.n);_a=[0,0,0,0];var nEval=_a[0],nStep=_a[1],nAccept=_a[2],nReject=_a[3],nrd=Math.max(1,y0),dens=Solver.dim(Math.max(1,(2*km+5)*y0)),fSafe=Solver.dim2(_i,nrd),F=function(x,y,yp){x=f(x,y.slice(1));for(y=0;y<x.length;++y)yp[y+1]=x[y]};y0=function(){var xOldd,hhh,kmit,acceptStep=function(n){xOld$jscomp$0=x$jscomp$0;x$jscomp$0+=h$jscomp$0;
if(_this.denseOutput){kmit=2*kc-_this.interpolationFormulaDegree+1;for(var i=1;i<=nrd;++i)dens[i]=y$jscomp$0[icom[i]];xOldd=xOld$jscomp$0;hhh=h$jscomp$0;for(i=1;i<=nrd;++i)dens[nrd+i]=h$jscomp$0*dz[icom[i]];var kln=2*nrd;for(i=1;i<=nrd;++i)dens[kln+i]=t[1][icom[i]];for(var j=2;j<=kc;++j)for(var dblenj=nj[j],l=j;2<=l;--l){var factor=Math.pow(dblenj/nj[l-1],2)-1;for(i=1;i<=nrd;++i)ySafe[l-1][i]=ySafe[l][i]+(ySafe[l][i]-ySafe[l-1][i])/factor}l=4*nrd;for(i=1;i<=nrd;++i)dens[l+i]=ySafe[1][i];for(i=1;i<=
n;++i)yh1[i]=t[1][i];F(x$jscomp$0,yh1,yh2);l=3*nrd;for(i=1;i<=nrd;++i)dens[l+i]=yh2[icom[i]]*h$jscomp$0;for(kln=1;kln<=kmit;++kln){var kbeg=(kln+1)/2|0;for(j=kbeg;j<=kc;++j)for(l=Math.pow(nj[j]/2,kln-1),iPt=iPoint[j+1]-2*j+kln,i=1;i<=nrd;++i)ySafe[j][i]=fSafe[iPt][i]*l;for(j=kbeg+1;j<=kc;++j)for(dblenj=nj[j],l=j;l>=kbeg+1;--l)for(factor=Math.pow(dblenj/nj[l-1],2)-1,i=1;i<=nrd;++i)ySafe[l-1][i]=ySafe[l][i]+(ySafe[l][i]-ySafe[l-1][i])/factor;l=(kln+4)*nrd;for(i=1;i<=nrd;++i)dens[l+i]=ySafe[kbeg][i]*
h$jscomp$0;if(kln!==kmit){for(j=(kln+2)/2|0;j<=kc;++j){i=iPoint[j+1];kbeg=iPoint[j]+kln+1;1===kln&&4===nSeq&&(kbeg+=2);for(l=i;l>=kbeg;l-=2)for(i=1;i<=nrd;++i)fSafe[l][i]-=fSafe[l-2][i];if(1===kln&&4===nSeq)for(l=kbeg-2,i=1;i<=nrd;++i)fSafe[l][i]-=dz[icom[i]]}for(j=(kln+2)/2|0;j<=kc;++j)for(i=iPoint[j+1]-1,kbeg=iPoint[j]+kln+2,l=i;l>=kbeg;l-=2)for(i=1;i<=nrd;++i)fSafe[l][i]-=fSafe[l-2][i]}}i=kmit;kln=Array(31);for(kbeg=1;kbeg<=nrd;++kbeg){l=dens[kbeg];var y1=dens[2*nrd+kbeg];factor=dens[nrd+kbeg];
var yp1=dens[3*nrd+kbeg],yDiff=y1-l;j=-yp1+yDiff;dblenj=factor-yDiff;dens[nrd+kbeg]=yDiff;dens[2*nrd+kbeg]=j;dens[3*nrd+kbeg]=dblenj;if(!(0>i)){l=.5*(l+y1)+.125*(j+dblenj);yDiff+=.25*(j-dblenj);factor=-(factor-yp1);j=6*(dblenj-j);if(1<=i&&(kln[1]=16*(dens[5*nrd+kbeg]-yDiff),3<=i&&(kln[3]=16*(dens[7*nrd+kbeg]-j+3*kln[1]),5<=i)))for(j=5;j<=i;j+=2)dblenj=j*(j-1)/2,yp1=dblenj*(j-2)*(j-3)*2,kln[j]=16*(dens[(j+4)*nrd+kbeg]+dblenj*kln[j-2]-yp1*kln[j-4]);kln[0]=16*(dens[4*nrd+kbeg]-l);if(2<=i&&(kln[2]=16*
(dens[6*nrd+kbeg]-factor+kln[0]),4<=i))for(j=4;j<=i;j+=2)dblenj=j*(j-1)/2,yp1=j*(j-1)*(j-2)*(j-3),kln[j]=16*(dens[nrd*(j+4)+kbeg]+kln[j-2]*dblenj-kln[j-4]*yp1);for(j=0;j<=i;++j)dens[nrd*(j+4)+kbeg]=kln[j]}}if(_this.denseOutputErrorEstimator&&1<=kmit){kln=0;for(i=1;i<=nrd;++i)kln+=Math.pow(dens[(kmit+4)*nrd+i]/scal[icom[i]],2);kln=Math.sqrt(kln/nrd)*errfac[kmit];hoptde=h$jscomp$0/Math.max(Math.pow(kln,1/(kmit+4)),.01);if(10<kln)return h$jscomp$0=hoptde,x$jscomp$0=xOld$jscomp$0,++nReject,reject=!0}for(i=
1;i<=n;++i)dz[i]=yh2[i]}for(i=1;i<=n;++i)y$jscomp$0[i]=t[1][i];++nAccept;if(solOut&&!1===solOut(nAccept+1,xOld$jscomp$0,x$jscomp$0,y$jscomp$0.slice(1),_this.denseOutput&&contex(xOldd,hhh,kmit,dens,icom)))return!1;2===kc?(n=Math.min(3,km-1),reject&&(n=2)):kc<=k?(n=kc,w[kc-1]<w[kc]*_this.stepSizeFac3&&(n=kc-1),w[kc]<w[kc-1]*_this.stepSizeFac4&&(n=Math.min(kc+1,km-1))):(n=kc-1,3<kc&&w[kc-2]<w[kc-1]*_this.stepSizeFac3&&(n=kc-2),w[kc]<w[n]*_this.stepSizeFac4&&(n=Math.min(kc,km-1)));if(reject)return k=
Math.min(n,kc),h$jscomp$0=posneg*Math.min(Math.abs(h$jscomp$0),Math.abs(hh[k])),reject=!1,!0;h$jscomp$0=n<=kc?hh[n]:kc<k&&w[kc]<w[kc-1]*_this.stepSizeFac4?hh[kc]*a[n+1]/a[kc]:hh[kc]*a[n]/a[kc];k=n;h$jscomp$0=posneg*Math.abs(h$jscomp$0);return!0},midex=function(j){for(var dy=Solver.dim(_this.n),hj=h$jscomp$0/nj[j],i=1;i<=_this.n;++i)yh1[i]=y$jscomp$0[i],yh2[i]=y$jscomp$0[i]+hj*dz[i];for(var m=nj[j]-1,njMid=nj[j]/2|0,mm=1;mm<=m;++mm){if(_this.denseOutput&&mm===njMid)for(i=1;i<=nrd;++i)ySafe[j][i]=yh2[icom[i]];
F(x$jscomp$0+hj*mm,yh2,dy);if(_this.denseOutput&&Math.abs(mm-njMid)<=2*j-1)for(++iPt,i=1;i<=nrd;++i)fSafe[iPt][i]=dy[icom[i]];for(i=1;i<=_this.n;++i){var ys=yh1[i];yh1[i]=yh2[i];yh2[i]=ys+2*hj*dy[i]}if(mm<=_this.stabilityCheckCount&&j<=_this.stabilityCheckTableLines){ys=0;for(i=1;i<=_this.n;++i)ys+=Math.pow(dz[i]/scal[i],2);var del2=0;for(i=1;i<=_this.n;++i)del2+=Math.pow((dy[i]-dz[i])/scal[i],2);if(4<del2/Math.max(_this.uRound,ys)){++nEval;atov=!0;h$jscomp$0*=_this.stepSizeReductionFactor;reject=
!0;return}}}F(x$jscomp$0+h$jscomp$0,yh2,dy);if(_this.denseOutput&&njMid<=2*j-1)for(++iPt,i=1;i<=nrd;++i)fSafe[iPt][i]=dy[icom[i]];for(i=1;i<=_this.n;++i)t[j][i]=(yh1[i]+yh2[i]+hj*dy[i])/2;nEval+=nj[j];if(1!==j){dy=nj[j];for(m=j;1<m;--m)for(hj=Math.pow(dy/nj[m-1],2)-1,i=1;i<=_this.n;++i)t[m-1][i]=t[m][i]+(t[m][i]-t[m-1][i])/hj;err=0;for(i=1;i<=_this.n;++i)scal[i]=aTol[i]+rTol[i]*Math.max(Math.abs(y$jscomp$0[i]),Math.abs(t[1][i])),err+=Math.pow((t[1][i]-t[2][i])/scal[i],2);err=Math.sqrt(err/_this.n);
1<=err*_this.uRound||2<j&&err>=errOld?(atov=!0,h$jscomp$0*=_this.stepSizeReductionFactor,reject=!0):(errOld=Math.max(4*err,1),i=1/(2*j-1),dy=Math.pow(_this.stepSizeFac1,i),hj=Math.min(_this.stepSizeFac2/dy,Math.max(dy,Math.pow(err/_this.stepSafetyFactor1,i)/_this.stepSafetyFactor2)),hh[j]=Math.min(1/hj*Math.abs(h$jscomp$0),hMax),w[j]=a[j]/hh[j])}},contex=function(xOld,h,imit,y,icom){return function(c,x){for(var i=0,j=1;j<=nrd;++j)icom[j]===c+1&&(i=j);if(0===i)throw Error("no dense output available for component "+
c);c=(x-xOld)/h;x=1-c;j=y[i]+c*(y[nrd+i]+x*(y[2*nrd+i]*c+y[3*nrd+i]*x));if(0>imit)return j;for(var thetah=c-.5,ret=y[nrd*(imit+4)+i],im=imit;1<=im;--im)ret=y[nrd*(im+3)+i]+ret*thetah/im;return j+Math.pow(c*x,2)*ret}},ySafe=Solver.dim2(km,nrd),hh=Solver.dim(km),t=Solver.dim2(km,_this.n),nj=Solver.stepSizeSequence(nSeq,km),a=Solver.dim(km);a[1]=1+nj[1];for(var i$jscomp$0=2;i$jscomp$0<=km;++i$jscomp$0)a[i$jscomp$0]=a[i$jscomp$0-1]+nj[i$jscomp$0];var scal=Solver.dim(_this.n);for(i$jscomp$0=1;i$jscomp$0<=
_this.n;++i$jscomp$0)scal[i$jscomp$0]=aTol[i$jscomp$0]+rTol[i$jscomp$0]+Math.abs(y$jscomp$0[i$jscomp$0]);var posneg=0<=xEnd-x$jscomp$0?1:-1,k=Math.max(2,Math.min(km-1,Math.floor(.6*-Solver.log10(rTol[1]+1E-40)+1.5))),h$jscomp$0=Math.max(Math.abs(_this.initialStepSize),1E-4);h$jscomp$0=posneg*Math.min(h$jscomp$0,hMax,Math.abs(xEnd-x$jscomp$0)/2);var iPoint=Solver.dim(km+1),errfac=Solver.dim(2*km),xOld$jscomp$0=x$jscomp$0,iPt=0;if(solOut){if(_this.denseOutput){iPoint[1]=0;for(i$jscomp$0=1;i$jscomp$0<=
km;++i$jscomp$0){var njAdd=4*i$jscomp$0-2;nj[i$jscomp$0]>njAdd&&++njAdd;iPoint[i$jscomp$0+1]=iPoint[i$jscomp$0]+njAdd}for(njAdd=1;njAdd<=2*km;++njAdd){var errx=.5*Math.sqrt(njAdd/(njAdd+4)),prod=Math.pow(1/(njAdd+4),2);for(i$jscomp$0=1;i$jscomp$0<=njAdd;++i$jscomp$0)prod*=errx/i$jscomp$0;errfac[njAdd]=prod}iPt=0}if(!1===solOut(nAccept+1,xOld$jscomp$0,x$jscomp$0,y$jscomp$0.slice(1)))return Outcome.EarlyReturn}var err=0,errOld=1E10,hoptde=posneg*hMax,w=Solver.dim(km);w[1]=0;var reject=!1;njAdd=!1;var kc=
0,STATE;(function(STATE){STATE[STATE.Start=0]="Start";STATE[STATE.BasicIntegrationStep=1]="BasicIntegrationStep";STATE[STATE.ConvergenceStep=2]="ConvergenceStep";STATE[STATE.HopeForConvergence=3]="HopeForConvergence";STATE[STATE.Accept=4]="Accept";STATE[STATE.Reject=5]="Reject"})(STATE||(STATE={}));errx=STATE.Start;a:for(;;)switch(_this.debug&&console.log("STATE",STATE[errx],nStep,xOld$jscomp$0,x$jscomp$0,h$jscomp$0,k,kc,hoptde),errx){case STATE.Start:var atov=!1;if(.1*Math.abs(xEnd-x$jscomp$0)<=
Math.abs(x$jscomp$0)*_this.uRound)break a;h$jscomp$0=posneg*Math.min(Math.abs(h$jscomp$0),Math.abs(xEnd-x$jscomp$0),hMax,Math.abs(hoptde));0<(x$jscomp$0+1.01*h$jscomp$0-xEnd)*posneg&&(h$jscomp$0=xEnd-x$jscomp$0,njAdd=!0);0!==nStep&&_this.denseOutput||(F(x$jscomp$0,y$jscomp$0,dz),++nEval);if(0===nStep||njAdd){iPt=0;++nStep;for(i$jscomp$0=1;i$jscomp$0<=k;++i$jscomp$0){kc=i$jscomp$0;midex(i$jscomp$0);if(atov)continue a;if(1<i$jscomp$0&&1>=err){errx=STATE.Accept;continue a}}errx=STATE.HopeForConvergence;
continue}errx=STATE.BasicIntegrationStep;continue;case STATE.BasicIntegrationStep:iPt=0;++nStep;if(nStep>=_this.maxSteps)return Outcome.MaxStepsExceeded;kc=k-1;for(i$jscomp$0=1;i$jscomp$0<=kc;++i$jscomp$0)if(midex(i$jscomp$0),atov){errx=STATE.Start;continue a}errx=2===k||reject?STATE.ConvergenceStep:1>=err?STATE.Accept:err>Math.pow(nj[k+1]*nj[k]/4,2)?STATE.Reject:STATE.ConvergenceStep;continue;case STATE.ConvergenceStep:midex(k);if(atov){errx=STATE.Start;continue}kc=k;if(1>=err){errx=STATE.Accept;
continue}errx=STATE.HopeForConvergence;continue;case STATE.HopeForConvergence:if(err>Math.pow(nj[k+1]/2,2)){errx=STATE.Reject;continue}kc=k+1;midex(kc);errx=atov?STATE.Start:1<err?STATE.Reject:STATE.Accept;continue;case STATE.Accept:if(!acceptStep(_this.n))return Outcome.EarlyReturn;errx=STATE.Start;continue;case STATE.Reject:k=Math.min(k,kc,km-1),2<k&&w[k-1]<w[k]*_this.stepSizeFac3&&--k,++nReject,h$jscomp$0=posneg*hh[k],reject=!0,errx=STATE.BasicIntegrationStep}return Outcome.Converged}();return{y:y$jscomp$0.slice(1),
outcome:y0,nStep,xEnd,nAccept,nReject,nEval}};return Solver}();global.dim=function(n){return Array(n+1)};global.log10=function(x){return Math.log(x)/Math.LN10};exports.Solver=global}
//# sourceMappingURL=module$node_modules$odex$src$odex.js.map
