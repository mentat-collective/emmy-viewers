{
"version":3,
"file":"module$node_modules$threestrap$src$renderers$VRRenderer.js",
"lineCount":6,
"mappings":"AAAAA,cAAA,CAAA,uDAAA,CAA4E,QAAQ,CAACC,MAAD,CAAQC,OAAR,CAAgBC,MAAhB,CAAuBC,OAAvB,CAAgC,CAGpHC,MAAOC,CAAAA,cAAP,CAAsBF,OAAtB,CAA+B,YAA/B,CAA6C,CAC3CG,MAAO,CAAA,CADoC,CAA7C,CAGAH,QAAQI,CAAAA,UAAR,CAAqB,IAAK,EAE1B,KAAIC,mBAAqBP,OAAA,CAAQ,yDAAR,CAAzB,CAEIQ,QAAUR,OAAA,CAAQ,4CAAR,CAQd,MAAMM,WAAN,CACEG,WAAW,CAACC,QAAD,CAAWC,GAAX,CAAgB,CACzB,IAAKD,CAAAA,QAAL,CAAgBA,QAChB,KAAKE,CAAAA,KAAL,CAAa,IAAIJ,OAAQK,CAAAA,OACzB,KAAKC,CAAAA,UAAL,CAAkB,IAAIP,kBAAmBQ,CAAAA,iBACzC,KAAKC,CAAAA,WAAL;AAAmB,IAAIT,kBAAmBQ,CAAAA,iBACpCE,SAAAA,CAAKN,GAAIO,CAAAA,iBAAJ,CAAsB,MAAtB,CACX,KAAKC,CAAAA,OAAL,CAAqDC,CAAtC,IAAIZ,OAAQK,CAAAA,OAAZ,CAAoBI,QAAGI,CAAAA,CAAvB,CAA0BJ,QAAGK,CAAAA,CAA7B,CAAgCL,QAAGM,CAAAA,CAAnC,CAAsCH,EAAAA,MAAtC,EACf,KAAKI,CAAAA,OAAL,CAAeb,GAAIc,CAAAA,4BAAJ,CAAiC,MAAjC,CACf,KAAKC,CAAAA,QAAL,CAAgBf,GAAIc,CAAAA,4BAAJ,CAAiC,OAAjC,CARS,CAW3BE,mBAAmB,CAACC,GAAD,CAAM,CACvB,MAAMC,QAAU,CAAVA,EAAiBD,GAAIE,CAAAA,OAArBD,CAA+BD,GAAIG,CAAAA,QAAnCF,CAAN,CAEMG,QAAU,CAAVA,EAAiBJ,GAAIK,CAAAA,KAArBD,CAA6BJ,GAAIM,CAAAA,OAAjCF,CAEN,OAAO,CACLG,MAAO,CAACN,OAAD,CAAUG,OAAV,CADF,CAELI,OAAQ,EALQR,GAAIE,CAAAA,OAKZ,CALsBF,GAAIG,CAAAA,QAK1B,EALsCF,OAKtC,CALgD,EAKhD,EAHQD,GAAIK,CAAAA,KAGZ,CAHoBL,GAAIM,CAAAA,OAGxB,EAHmCF,OAGnC,CAH6C,EAG7C,CAFH,CALgB,CAWzBK,mBAAmB,CAACC,MAAD;AAASV,GAAT,CAAcW,WAAd,CAEjBC,KAFiB,CAIjBC,IAJiB,CAMjB,CAEAD,KAAA,CAAkBE,IAAAA,EAAV,GAAAF,KAAA,CAAsB,GAAtB,CAA6BA,KACrCC,KAAA,CAAgBC,IAAAA,EAAT,GAAAD,IAAA,CAAqB,GAArB,CAA+BA,IAChCE,YAAAA,CAHwBD,IAAAA,EAGN,GAHVH,WAGU,EAHyBA,WAGzB,CAAc,CAAC,CAAf,CAAqB,CAC7C,OAAMK,EAAIN,MAAOO,CAAAA,QACXC,IAAAA,CAAiB,IAAKnB,CAAAA,mBAAL,CAAyBC,GAAzB,CACvBgB,EAAA,CAAE,CAAF,CAAA,CAAeE,GAAeX,CAAAA,KAAf,CAAqB,CAArB,CACfS,EAAA,CAAE,CAAF,CAAA,CAAe,CACfA,EAAA,CAAE,CAAF,CAAA,CAAeE,GAAeV,CAAAA,MAAf,CAAsB,CAAtB,CAAf,CAA0CO,WAC1CC,EAAA,CAAE,CAAF,CAAA,CAAe,CACfA,EAAA,CAAE,CAAF,CAAA,CAAe,CACfA,EAAA,CAAE,CAAF,CAAA,CAAeE,GAAeX,CAAAA,KAAf,CAAqB,CAArB,CACfS,EAAA,CAAE,CAAF,CAAA,CAAe,CAACE,GAAeV,CAAAA,MAAf,CAAsB,CAAtB,CAAhB,CAA2CO,WAC3CC,EAAA,CAAE,CAAF,CAAA,CAAe,CACfA,EAAA,CAAE,CAAF,CAAA,CAAe,CACfA,EAAA,CAAE,CAAF,CAAA,CAAe,CACfA,EAAA,CAAE,EAAF,CAAA,CAAeH,IAAf,EAAuBD,KAAvB,CAA+BC,IAA/B,EAAuC,CAACE,WACxCC,EAAA,CAAE,EAAF,CAAA,CAAeH,IAAf,CAAsBD,KAAtB,EAA+BA,KAA/B,CAAuCC,IAAvC,CACAG,EAAA,CAAE,EAAF,CAAA,CAAe,CACfA,EAAA,CAAE,EAAF,CAAA,CAAe,CACfA,EAAA,CAAE,EAAF,CAAA,CAAeD,WACfC,EAAA,CAAE,EAAF,CAAA,CAAe,CACfN,OAAOS,CAAAA,SAAP,EAvBA,CA0BFC,eAAe,CAACV,MAAD,CAASV,GAAT,CAAcW,WAAd;AAEbC,KAFa,CAIbC,IAJa,CAMb,CAOA,MAAO,KAAKJ,CAAAA,mBAAL,CAAyBC,MAAzB,CANSW,CACdhB,MAAOiB,IAAKC,CAAAA,GAAL,CAASvB,GAAIwB,CAAAA,SAAb,CAAyBF,IAAKG,CAAAA,EAA9B,CAAmC,GAAnC,CADOJ,CAEdf,QAASgB,IAAKC,CAAAA,GAAL,CAASvB,GAAI0B,CAAAA,WAAb,CAA2BJ,IAAKG,CAAAA,EAAhC,CAAqC,GAArC,CAFKJ,CAGdnB,QAASoB,IAAKC,CAAAA,GAAL,CAASvB,GAAI2B,CAAAA,WAAb,CAA2BL,IAAKG,CAAAA,EAAhC,CAAqC,GAArC,CAHKJ,CAIdlB,SAAUmB,IAAKC,CAAAA,GAAL,CAASvB,GAAI4B,CAAAA,YAAb,CAA4BN,IAAKG,CAAAA,EAAjC,CAAsC,GAAtC,CAJIJ,CAMT,CAA0CV,WAA1C,CAAuDC,KAAvD,CAA8DC,IAA9D,CAPP,CAUFgB,MAAM,CAACC,KAAD,CAAQC,MAAR,CAAgB,CACpB,IAAKX,CAAAA,eAAL,CAAqB,IAAKlC,CAAAA,UAAW8C,CAAAA,gBAArC,CAAuD,IAAKpC,CAAAA,OAA5D,CAAqE,CAAA,CAArE,CAA2EmC,MAAOE,CAAAA,IAAlF,CAAwFF,MAAOG,CAAAA,GAA/F,CACA,KAAKd,CAAAA,eAAL,CAAqB,IAAKhC,CAAAA,WAAY4C,CAAAA,gBAAtC,CAAwD,IAAKlC,CAAAA,QAA7D,CAAuE,CAAA,CAAvE,CAA6EiC,MAAOE,CAAAA,IAApF,CAA0FF,MAAOG,CAAAA,GAAjG,CACA,KAAKlD,CAAAA,KAAMmD,CAAAA,GAAX,CAAe,IAAK5C,CAAAA,OAApB,CAA6B,CAA7B,CAAgC,CAAhC,CACA;IAAKP,CAAAA,KAAMoD,CAAAA,eAAX,CAA2BL,MAAOM,CAAAA,UAAlC,CACA,KAAKnD,CAAAA,UAAWoD,CAAAA,QAASC,CAAAA,IAAzB,CAA8BR,MAAOO,CAAAA,QAArC,CAA+CE,CAAAA,GAA/C,CAAmD,IAAKxD,CAAAA,KAAxD,CACA,KAAKI,CAAAA,WAAYkD,CAAAA,QAASC,CAAAA,IAA1B,CAA+BR,MAAOO,CAAAA,QAAtC,CAAgDG,CAAAA,GAAhD,CAAoD,IAAKzD,CAAAA,KAAzD,CACA,KAAKE,CAAAA,UAAWmD,CAAAA,UAAWE,CAAAA,IAA3B,CAAgCR,MAAOM,CAAAA,UAAvC,CACA,KAAKjD,CAAAA,WAAYiD,CAAAA,UAAWE,CAAAA,IAA5B,CAAiCR,MAAOM,CAAAA,UAAxC,CACA,KAAMK,IAAM,IAAK5D,CAAAA,QAAS6D,CAAAA,gBAApBD,EAAwC,CACxCE,OAAAA,CAAQ,IAAK9D,CAAAA,QAAS+D,CAAAA,UAAWD,CAAAA,KAAjCA,CAAyC,CAAzCA,CAA6CF,GAC7CI,IAAAA,CAAS,IAAKhE,CAAAA,QAAS+D,CAAAA,UAAWC,CAAAA,MAAlCA,CAA2CJ,GACjD,KAAK5D,CAAAA,QAASiE,CAAAA,iBAAd,CAAgC,CAAA,CAAhC,CACA,KAAKjE,CAAAA,QAASkE,CAAAA,WAAd,CAA0B,CAA1B,CAA6B,CAA7B,CAAgCJ,MAAhC,CAAuCE,GAAvC,CACA,KAAKhE,CAAAA,QAASmE,CAAAA,UAAd,CAAyB,CAAzB;AAA4B,CAA5B,CAA+BL,MAA/B,CAAsCE,GAAtC,CACA,KAAKhE,CAAAA,QAAS+C,CAAAA,MAAd,CAAqBC,KAArB,CAA4B,IAAK5C,CAAAA,UAAjC,CACA,KAAKJ,CAAAA,QAASkE,CAAAA,WAAd,CAA0BJ,MAA1B,CAAiC,CAAjC,CAAoCA,MAApC,CAA2CE,GAA3C,CACA,KAAKhE,CAAAA,QAASmE,CAAAA,UAAd,CAAyBL,MAAzB,CAAgC,CAAhC,CAAmCA,MAAnC,CAA0CE,GAA1C,CACA,KAAKhE,CAAAA,QAAS+C,CAAAA,MAAd,CAAqBC,KAArB,CAA4B,IAAK1C,CAAAA,WAAjC,CAlBoB,CAvExB,CA8FAd,OAAQI,CAAAA,UAAR,CAAqBA,UAhH+F;",
"sources":["node_modules/threestrap/src/renderers/VRRenderer.js"],
"sourcesContent":["shadow$provide[\"module$node_modules$threestrap$src$renderers$VRRenderer\"] = function(global,require,module,exports) {\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.VRRenderer = void 0;\n\nvar _PerspectiveCamera = require(\"three/src/cameras/PerspectiveCamera.js\");\n\nvar _Vector = require(\"three/src/math/Vector3.js\");\n\n/**\n * VRRenderer\n *\n * @author wwwtyro https://github.com/wwwtyro\n * @author unconed https://github.com/unconed\n */\nclass VRRenderer {\n  constructor(renderer, hmd) {\n    this.renderer = renderer;\n    this.right = new _Vector.Vector3();\n    this.cameraLeft = new _PerspectiveCamera.PerspectiveCamera();\n    this.cameraRight = new _PerspectiveCamera.PerspectiveCamera();\n    const et = hmd.getEyeTranslation(\"left\");\n    this.halfIPD = new _Vector.Vector3(et.x, et.y, et.z).length();\n    this.fovLeft = hmd.getRecommendedEyeFieldOfView(\"left\");\n    this.fovRight = hmd.getRecommendedEyeFieldOfView(\"right\");\n  }\n\n  FovToNDCScaleOffset(fov) {\n    const pxscale = 2.0 / (fov.leftTan + fov.rightTan);\n    const pxoffset = (fov.leftTan - fov.rightTan) * pxscale * 0.5;\n    const pyscale = 2.0 / (fov.upTan + fov.downTan);\n    const pyoffset = (fov.upTan - fov.downTan) * pyscale * 0.5;\n    return {\n      scale: [pxscale, pyscale],\n      offset: [pxoffset, pyoffset]\n    };\n  }\n\n  FovPortToProjection(matrix, fov, rightHanded\n  /* = true */\n  , zNear\n  /* = 0.01 */\n  , zFar\n  /* = 10000.0 */\n  ) {\n    rightHanded = rightHanded === undefined ? true : rightHanded;\n    zNear = zNear === undefined ? 0.01 : zNear;\n    zFar = zFar === undefined ? 10000.0 : zFar;\n    const handednessScale = rightHanded ? -1.0 : 1.0;\n    const m = matrix.elements;\n    const scaleAndOffset = this.FovToNDCScaleOffset(fov);\n    m[0 * 4 + 0] = scaleAndOffset.scale[0];\n    m[0 * 4 + 1] = 0.0;\n    m[0 * 4 + 2] = scaleAndOffset.offset[0] * handednessScale;\n    m[0 * 4 + 3] = 0.0;\n    m[1 * 4 + 0] = 0.0;\n    m[1 * 4 + 1] = scaleAndOffset.scale[1];\n    m[1 * 4 + 2] = -scaleAndOffset.offset[1] * handednessScale;\n    m[1 * 4 + 3] = 0.0;\n    m[2 * 4 + 0] = 0.0;\n    m[2 * 4 + 1] = 0.0;\n    m[2 * 4 + 2] = zFar / (zNear - zFar) * -handednessScale;\n    m[2 * 4 + 3] = zFar * zNear / (zNear - zFar);\n    m[3 * 4 + 0] = 0.0;\n    m[3 * 4 + 1] = 0.0;\n    m[3 * 4 + 2] = handednessScale;\n    m[3 * 4 + 3] = 0.0;\n    matrix.transpose();\n  }\n\n  FovToProjection(matrix, fov, rightHanded\n  /* = true */\n  , zNear\n  /* = 0.01 */\n  , zFar\n  /* = 10000.0 */\n  ) {\n    const fovPort = {\n      upTan: Math.tan(fov.upDegrees * Math.PI / 180.0),\n      downTan: Math.tan(fov.downDegrees * Math.PI / 180.0),\n      leftTan: Math.tan(fov.leftDegrees * Math.PI / 180.0),\n      rightTan: Math.tan(fov.rightDegrees * Math.PI / 180.0)\n    };\n    return this.FovPortToProjection(matrix, fovPort, rightHanded, zNear, zFar);\n  }\n\n  render(scene, camera) {\n    this.FovToProjection(this.cameraLeft.projectionMatrix, this.fovLeft, true, camera.near, camera.far);\n    this.FovToProjection(this.cameraRight.projectionMatrix, this.fovRight, true, camera.near, camera.far);\n    this.right.set(this.halfIPD, 0, 0);\n    this.right.applyQuaternion(camera.quaternion);\n    this.cameraLeft.position.copy(camera.position).sub(this.right);\n    this.cameraRight.position.copy(camera.position).add(this.right);\n    this.cameraLeft.quaternion.copy(camera.quaternion);\n    this.cameraRight.quaternion.copy(camera.quaternion);\n    const dpr = this.renderer.devicePixelRatio || 1;\n    const width = this.renderer.domElement.width / 2 / dpr;\n    const height = this.renderer.domElement.height / dpr;\n    this.renderer.enableScissorTest(true);\n    this.renderer.setViewport(0, 0, width, height);\n    this.renderer.setScissor(0, 0, width, height);\n    this.renderer.render(scene, this.cameraLeft);\n    this.renderer.setViewport(width, 0, width, height);\n    this.renderer.setScissor(width, 0, width, height);\n    this.renderer.render(scene, this.cameraRight);\n  }\n\n}\n\nexports.VRRenderer = VRRenderer;\n};"],
"names":["shadow$provide","global","require","module","exports","Object","defineProperty","value","VRRenderer","_PerspectiveCamera","_Vector","constructor","renderer","hmd","right","Vector3","cameraLeft","PerspectiveCamera","cameraRight","et","getEyeTranslation","halfIPD","length","x","y","z","fovLeft","getRecommendedEyeFieldOfView","fovRight","FovToNDCScaleOffset","fov","pxscale","leftTan","rightTan","pyscale","upTan","downTan","scale","offset","FovPortToProjection","matrix","rightHanded","zNear","zFar","undefined","handednessScale","m","elements","scaleAndOffset","transpose","FovToProjection","fovPort","Math","tan","upDegrees","PI","downDegrees","leftDegrees","rightDegrees","render","scene","camera","projectionMatrix","near","far","set","applyQuaternion","quaternion","position","copy","sub","add","dpr","devicePixelRatio","width","domElement","height","enableScissorTest","setViewport","setScissor"]
}
