{
"version":3,
"file":"module$node_modules$mathbox$build$esm$render$buffer$texture$datatexture.js",
"lineCount":9,
"mappings":"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",
"sources":["node_modules/mathbox/build/esm/render/buffer/texture/datatexture.js"],
"sourcesContent":["shadow$provide[\"module$node_modules$mathbox$build$esm$render$buffer$texture$datatexture\"] = function(global,require,module,exports) {\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.DataTexture = void 0;\n\nvar CONST = _interopRequireWildcard(require(\"three/src/constants.js\"));\n\nvar UThree = _interopRequireWildcard(require(\"../../../util/three.js\"));\n\nvar _Texture = require(\"three/src/textures/Texture.js\");\n\nvar _Vector = require(\"three/src/math/Vector2.js\");\n\nfunction _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== \"function\") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function (nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }\n\nfunction _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== \"object\" && typeof obj !== \"function\") { return { default: obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\n\n// TODO: This file was created by bulk-decaffeinate.\n// Sanity-check the conversion and remove this comment.\n\n/*\n * decaffeinate suggestions:\n * DS102: Remove unnecessary code created because of implicit returns\n * DS207: Consider shorter variations of null checks\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/master/docs/suggestions.md\n */\n\n/*\nManually allocated GL texture for data streaming.\n\nAllows partial updates via subImage.\n*/\nclass DataTexture {\n  constructor(renderer, width, height, channels, options) {\n    this.renderer = renderer;\n    this.width = width;\n    this.height = height;\n    this.channels = channels;\n    this.n = this.width * this.height * this.channels;\n    const gl = this.renderer.getContext();\n    this.gl = gl;\n    const minFilter = (options != null ? options.minFilter : undefined) != null ? options != null ? options.minFilter : undefined : CONST.NearestFilter;\n    const magFilter = (options != null ? options.magFilter : undefined) != null ? options != null ? options.magFilter : undefined : CONST.NearestFilter;\n    const type = (options != null ? options.type : undefined) != null ? options != null ? options.type : undefined : CONST.FloatType;\n    this.minFilter = UThree.paramToGL(gl, minFilter);\n    this.magFilter = UThree.paramToGL(gl, magFilter);\n    this.type = UThree.paramToGL(gl, type);\n    this.ctor = UThree.paramToArrayStorage(type);\n    this.build(options);\n  }\n\n  build(options) {\n    const {\n      gl\n    } = this;\n    const state = this.renderer.state; // Make GL texture\n\n    this.texture = gl.createTexture();\n    this.format = [null, gl.LUMINANCE, gl.LUMINANCE_ALPHA, gl.RGB, gl.RGBA][this.channels];\n    this.format3 = [null, CONST.LuminanceFormat, CONST.LuminanceAlphaFormat, CONST.RGBFormat, CONST.RGBAFormat][this.channels];\n    state.bindTexture(gl.TEXTURE_2D, this.texture);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, this.minFilter);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, this.magFilter); // Attach empty data\n\n    this.data = new this.ctor(this.n);\n    gl.pixelStorei(gl.UNPACK_ALIGNMENT, 1);\n    gl.texImage2D(gl.TEXTURE_2D, 0, this.format, this.width, this.height, 0, this.format, this.type, this.data); // Make wrapper texture object.\n\n    this.textureObject = new _Texture.Texture(new Image(), CONST.UVMapping, CONST.ClampToEdgeWrapping, CONST.ClampToEdgeWrapping, options != null ? options.minFilter : undefined, options != null ? options.magFilter : undefined); // Pre-init texture to trick WebGLRenderer\n\n    this.textureProperties = this.renderer.properties.get(this.textureObject);\n    this.textureProperties.__webglInit = true;\n    this.textureProperties.__webglTexture = this.texture;\n    this.textureObject.format = this.format3;\n    this.textureObject.type = CONST.FloatType;\n    this.textureObject.unpackAlignment = 1;\n    this.textureObject.flipY = false;\n    this.textureObject.generateMipmaps = false; // Create uniforms\n\n    this.uniforms = {\n      dataResolution: {\n        type: \"v2\",\n        value: new _Vector.Vector2(1 / this.width, 1 / this.height)\n      },\n      dataTexture: {\n        type: \"t\",\n        value: this.textureObject\n      }\n    };\n  }\n\n  write(data, x, y, w, h) {\n    const {\n      gl\n    } = this;\n    const state = this.renderer.state; // Write to rectangle\n\n    state.bindTexture(gl.TEXTURE_2D, this.texture);\n    gl.pixelStorei(gl.UNPACK_ALIGNMENT, 1);\n    gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, false);\n    gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, false);\n    return gl.texSubImage2D(gl.TEXTURE_2D, 0, x, y, w, h, this.format, this.type, data);\n  }\n\n  dispose() {\n    this.gl.deleteTexture(this.texture);\n    this.textureProperties.__webglInit = false;\n    this.textureProperties.__webglTexture = null;\n    this.textureProperties = null;\n    return this.textureObject = this.texture = null;\n  }\n\n}\n\nexports.DataTexture = DataTexture;\n};"],
"names":["shadow$provide","global","require","module","exports","_getRequireWildcardCache","nodeInterop","WeakMap","cacheBabelInterop","cacheNodeInterop","_interopRequireWildcard","obj","__esModule","default","cache","has","get","newObj","hasPropertyDescriptor","Object","defineProperty","getOwnPropertyDescriptor","key","prototype","hasOwnProperty","call","desc","set","value","DataTexture","CONST","UThree","_Texture","_Vector","constructor","renderer","width","height","channels","options","n","gl","getContext","magFilter","undefined","NearestFilter","type","FloatType","minFilter","paramToGL","ctor","paramToArrayStorage","build","state","texture","createTexture","format","LUMINANCE","LUMINANCE_ALPHA","RGB","RGBA","format3","LuminanceFormat","LuminanceAlphaFormat","RGBFormat","RGBAFormat","bindTexture","TEXTURE_2D","texParameteri","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","TEXTURE_MIN_FILTER","TEXTURE_MAG_FILTER","data","pixelStorei","UNPACK_ALIGNMENT","texImage2D","textureObject","Texture","Image","UVMapping","ClampToEdgeWrapping","textureProperties","properties","__webglInit","__webglTexture","unpackAlignment","flipY","generateMipmaps","uniforms","dataResolution","Vector2","dataTexture","write","x","y","w","h","UNPACK_FLIP_Y_WEBGL","UNPACK_PREMULTIPLY_ALPHA_WEBGL","texSubImage2D","dispose","deleteTexture"]
}
