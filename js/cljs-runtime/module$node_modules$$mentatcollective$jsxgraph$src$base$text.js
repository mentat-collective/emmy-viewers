shadow$provide.module$node_modules$$mentatcollective$jsxgraph$src$base$text=function(global,require,module,exports){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0});exports.default=void 0;var _jxg=_interopRequireDefault(require("module$node_modules$$mentatcollective$jsxgraph$src$jxg")),_constants=_interopRequireDefault(require("module$node_modules$$mentatcollective$jsxgraph$src$base$constants"));global=_interopRequireDefault(require("module$node_modules$$mentatcollective$jsxgraph$src$base$element"));
var _geonext=_interopRequireDefault(require("module$node_modules$$mentatcollective$jsxgraph$src$parser$geonext")),_env=_interopRequireDefault(require("module$node_modules$$mentatcollective$jsxgraph$src$utils$env")),_type=_interopRequireDefault(require("module$node_modules$$mentatcollective$jsxgraph$src$utils$type")),_math=_interopRequireDefault(require("module$node_modules$$mentatcollective$jsxgraph$src$math$math")),_coordselement=_interopRequireDefault(require("module$node_modules$$mentatcollective$jsxgraph$src$base$coordselement")),
JSCompiler_object_inline_HTMLSliderInputEventHandler_4907=function(){this._val=parseFloat(this.rendNodeRange.value);this.rendNodeOut.value=this.rendNodeRange.value;this.board.update()};_jxg.default.Text=function(board,coords,attributes,content){this.constructor(board,attributes,_constants.default.OBJECT_TYPE_TEXT,_constants.default.OBJECT_CLASS_TEXT);this.element=this.board.select(attributes.anchor);this.coordsConstructor(coords,_type.default.evaluate(this.visProp.islabel));this.plaintext=this.content=
"";this.plaintextOld=null;this.orgText="";this.hiddenByParent=this.needsSizeUpdate=!1;this.size=[1,1];this.id=this.board.setId(this,"T");this.board.renderer.drawText(this);this.board.finalizeAdding(this);this.setText(content);_type.default.isString(this.content)&&this.notifyParents(this.content);this.elType="text";this.methodMap=_type.default.deepCopy(this.methodMap,{setText:"setTextJessieCode",move:"setCoords"})};_jxg.default.Text.prototype=new global.default;_type.default.copyPrototypeMethods(_jxg.default.Text,
_coordselement.default,"coordsConstructor");_jxg.default.extend(_jxg.default.Text.prototype,{hasPoint:function(x,y){if(_type.default.isObject(_type.default.evaluate(this.visProp.precision))){var type=this.board._inputDevice;type=_type.default.evaluate(this.visProp.precision[type])}else type=this.board.options.precision.hasPoint;if(0<this.transformations.length){var lft=_math.default.matVecMult(_math.default.inverse(this.board.renderer.joinTransforms(this,this.transformations)),[1,x,y]);x=lft[1];y=
lft[2]}lft=this.getAnchorX();lft="right"===lft?this.coords.scrCoords[1]-this.size[0]:"middle"===lft?this.coords.scrCoords[1]-.5*this.size[0]:this.coords.scrCoords[1];var rt=lft+this.size[0];var top=this.getAnchorY();var bot="top"===top?this.coords.scrCoords[2]+this.size[1]:"middle"===top?this.coords.scrCoords[2]+.5*this.size[1]:this.coords.scrCoords[2];top=bot-this.size[1];return"all"===_type.default.evaluate(this.visProp.dragarea)?x>=lft-type&&x<rt+type&&y>=top-type&&y<=bot+type:y>=top-type&&y<=
bot+type&&(x>=lft-type&&x<=lft+2*type||x>=rt-2*type&&x<=rt+type)},_createFctUpdateText:function(text){var resolvedText,ev_p=_type.default.evaluate(this.visProp.parse),ev_um=_type.default.evaluate(this.visProp.usemathjax),ev_uk=_type.default.evaluate(this.visProp.usekatex),convertJessieCode=!1;this.orgText=text;if(_type.default.isFunction(text))this.updateText=function(){resolvedText=text().toString();this.plaintext=!ev_p||ev_um||ev_uk?resolvedText:this.replaceSub(this.replaceSup(this.convertGeonextAndSketchometry2CSS(resolvedText)))};
else if(_type.default.isNumber(text)?this.content=_type.default.toFixed(text,_type.default.evaluate(this.visProp.digits)):_type.default.isString(text)&&ev_p&&(_type.default.evaluate(this.visProp.useasciimathml)?this.content="'`"+text+"`'":ev_um||ev_uk?(this.content=this.valueTagToJessieCode(text),this.content=this.content.replace(/\\/g,"\\\\")):this.content=this.poorMansTeX(this.valueTagToJessieCode(text)),convertJessieCode=!0),convertJessieCode){var updateText=this.board.jc.snippet(this.content,
!0,"",!1);this.updateText=function(){this.plaintext=this.unescapeTicks(updateText())}}else this.updateText=function(){this.plaintext=text}},_setText:function(text){this._createFctUpdateText(text);this.updateText();this.fullUpdate();this.board.infobox&&this.id===this.board.infobox.id||this.updateSize();return this},setTextJessieCode:function(text){this.visProp.castext=text;var s=_type.default.isFunction(text)?function(){return _type.default.sanitizeHTML(text())}:_type.default.isNumber(text)?text:_type.default.sanitizeHTML(text);
return this._setText(s)},setText:function(text){return this._setText(text)},updateSize:function(){var tmp,ev_d=_type.default.evaluate(this.visProp.display);if(!_env.default.isBrowser||"no"===this.board.renderer.type)return this;var node=this.rendNode;if("html"===ev_d||"vml"===this.board.renderer.type)if(_type.default.exists(node.offsetWidth)){var that=this;window.setTimeout(function(){that.size=[node.offsetWidth,node.offsetHeight];that.needsUpdate=!0;that.updateRenderer()},0)}else this.size=this.crudeSizeEstimate();
else"internal"===ev_d&&("svg"===this.board.renderer.type?(that=this,window.setTimeout(function(){try{tmp=node.getBBox(),that.size=[tmp.width,tmp.height],that.needsUpdate=!0,that.updateRenderer()}catch(e){}},0)):"canvas"===this.board.renderer.type&&(this.size=this.crudeSizeEstimate()));return this},crudeSizeEstimate:function(){var ev_fs=parseFloat(_type.default.evaluate(this.visProp.fontsize));return[ev_fs*this.plaintext.length*.45,.9*ev_fs]},utf8_decode:function(string){return string.replace(/&#x(\w+);/g,
function(m,p1){return String.fromCharCode(parseInt(p1,16))})},replaceSub:function(te){if(!te.indexOf)return te;var j;for(j=te.indexOf("_{");0<=j;)te=te.substr(0,j)+te.substr(j).replace(/_\{/,"\x3csub\x3e"),j=te.substr(j).indexOf("}"),0<=j&&(te=te.substr(0,j)+te.substr(j).replace(/\}/,"\x3c/sub\x3e")),j=te.indexOf("_{");for(j=te.indexOf("_");0<=j;)te=te.substr(0,j)+te.substr(j).replace(/_(.?)/,"\x3csub\x3e$1\x3c/sub\x3e"),j=te.indexOf("_");return te},replaceSup:function(te){if(!te.indexOf)return te;
var j;for(j=te.indexOf("^{");0<=j;)te=te.substr(0,j)+te.substr(j).replace(/\^\{/,"\x3csup\x3e"),j=te.substr(j).indexOf("}"),0<=j&&(te=te.substr(0,j)+te.substr(j).replace(/\}/,"\x3c/sup\x3e")),j=te.indexOf("^{");for(j=te.indexOf("^");0<=j;)te=te.substr(0,j)+te.substr(j).replace(/\^(.?)/,"\x3csup\x3e$1\x3c/sup\x3e"),j=te.indexOf("^");return te},getSize:function(){return this.size},setCoords:function(x,y){_type.default.isArray(x)&&1<x.length&&(y=x[1],x=x[0]);if(_type.default.evaluate(this.visProp.islabel)&&
_type.default.exists(this.element)){var coordsAnchor=this.element.getLabelAnchor();x=(x-coordsAnchor.usrCoords[1])*this.board.unitX;y=-(y-coordsAnchor.usrCoords[2])*this.board.unitY;this.relativeCoords.setCoordinates(_constants.default.COORDS_BY_SCREEN,[x,y])}else this.coords.setCoordinates(_constants.default.COORDS_BY_USER,[x,y]);this.fullUpdate();return this},update:function(fromParent){if(!this.needsUpdate)return this;this.updateCoords(fromParent);this.updateText();"internal"===_type.default.evaluate(this.visProp.display)&&
_type.default.isString(this.plaintext)&&(this.plaintext=this.utf8_decode(this.plaintext));this.checkForSizeUpdate();this.needsSizeUpdate&&this.updateSize();return this},checkForSizeUpdate:function(){if(this.board.infobox&&this.id===this.board.infobox.id)this.needsSizeUpdate=!1;else if(this.needsSizeUpdate=this.plaintextOld!==this.plaintext)this.plaintextOld=this.plaintext},updateRenderer:function(){_type.default.evaluate(this.visProp.autoposition)&&this.setAutoPosition().updateConstraint();return this.updateRendererGeneric("updateText")},
expandShortMath:function(expr){return expr.replace(/([)0-9.])\s*([(a-zA-Z_])/g,"$1*$2")},generateTerm:function(contentStr,expand,avoidGeonext2JS){var plaintext='""';contentStr=(contentStr||"").replace(/\r/g,"");contentStr=contentStr.replace(/\n/g,"");contentStr=contentStr.replace(/"/g,"'");contentStr=contentStr.replace(/'/g,"\\'");contentStr=contentStr.replace(/&amp;arc;/g,"\x26ang;");contentStr=contentStr.replace(/<arc\s*\/>/g,"\x26ang;");contentStr=contentStr.replace(/&lt;arc\s*\/&gt;/g,"\x26ang;");
contentStr=contentStr.replace(/&lt;sqrt\s*\/&gt;/g,"\x26radic;");contentStr=contentStr.replace(/&lt;value&gt;/g,"\x3cvalue\x3e");contentStr=contentStr.replace(/&lt;\/value&gt;/g,"\x3c/value\x3e");var res=contentStr.indexOf("\x3cvalue\x3e");var j=contentStr.indexOf("\x3c/value\x3e");if(0<=res)for(;0<=res;)plaintext+=' + "'+this.replaceSub(this.replaceSup(contentStr.slice(0,res)))+'"',res=contentStr.slice(res+7,j),res=res.replace(/\s+/g,""),!0===expand&&(res=this.expandShortMath(res)),res=avoidGeonext2JS?
res:_geonext.default.geonext2JS(res,this.board),res=res.replace(/\\"/g,"'"),res=res.replace(/\\'/g,"'"),plaintext=0>res.indexOf("toFixed")?_type.default.isNumber(_type.default.bind(this.board.jc.snippet(res,!0,"",!1),this)())?plaintext+("+("+res+").toFixed("+_type.default.evaluate(this.visProp.digits)+")"):plaintext+("+("+res+")"):plaintext+("+("+res+")"),contentStr=contentStr.slice(j+8),res=contentStr.indexOf("\x3cvalue\x3e"),j=contentStr.indexOf("\x3c/value\x3e");plaintext+=' + "'+this.replaceSub(this.replaceSup(contentStr))+
'"';plaintext=this.convertGeonextAndSketchometry2CSS(plaintext);plaintext=plaintext.replace(/&amp;/g,"\x26");return plaintext=plaintext.replace(/"/g,"'")},valueTagToJessieCode:function(contentStr){var textComps=[];contentStr=(contentStr||"").replace(/\r/g,"");contentStr=contentStr.replace(/\n/g,"");contentStr=contentStr.replace(/&lt;value&gt;/g,"\x3cvalue\x3e");contentStr=contentStr.replace(/&lt;\/value&gt;/g,"\x3c/value\x3e");var res=contentStr.indexOf("\x3cvalue\x3e");var j=contentStr.indexOf("\x3c/value\x3e");
if(0<=res)for(;0<=res;)textComps.push('"'+this.escapeTicks(contentStr.slice(0,res))+'"'),res=contentStr.slice(res+7,j),res=res.replace(/\s+/g,""),res=this.expandShortMath(res),res=res.replace(/\\"/g,"'").replace(/\\'/g,"'"),0>res.indexOf("toFixed")?_type.default.isNumber(_type.default.bind(this.board.jc.snippet(res,!0,"",!1),this)())?textComps.push("("+res+").toFixed("+_type.default.evaluate(this.visProp.digits)+")"):textComps.push("("+res+")"):textComps.push("("+res+")"),contentStr=contentStr.slice(j+
8),res=contentStr.indexOf("\x3cvalue\x3e"),j=contentStr.indexOf("\x3c/value\x3e");textComps.push('"'+this.escapeTicks(contentStr)+'"');return textComps.join(" + ").replace(/&amp;/g,"\x26")},poorMansTeX:function(s){s=s.replace(/<arc\s*\/*>/g,"\x26ang;").replace(/&lt;arc\s*\/*&gt;/g,"\x26ang;").replace(/<sqrt\s*\/*>/g,"\x26radic;").replace(/&lt;sqrt\s*\/*&gt;/g,"\x26radic;");return this.convertGeonextAndSketchometry2CSS(this.replaceSub(this.replaceSup(s)))},escapeTicks:function(s){return s.replace(/"/g,
"%22").replace(/'/g,"%27")},unescapeTicks:function(s){return s.replace(/%22/g,'"').replace(/%27/g,"'")},convertGeonext2CSS:function(s){_type.default.isString(s)&&(s=s.replace(/(<|&lt;)overline(>|&gt;)/g,"\x3cspan style\x3dtext-decoration:overline;\x3e"),s=s.replace(/(<|&lt;)\/overline(>|&gt;)/g,"\x3c/span\x3e"),s=s.replace(/(<|&lt;)arrow(>|&gt;)/g,"\x3cspan style\x3dtext-decoration:overline;\x3e"),s=s.replace(/(<|&lt;)\/arrow(>|&gt;)/g,"\x3c/span\x3e"));return s},convertSketchometry2CSS:function(s){_type.default.isString(s)&&
(s=s.replace(/(<|&lt;)sketchofont(>|&gt;)/g,"\x3cspan style\x3dfont-family:sketchometry-light;font-weight:500;\x3e"),s=s.replace(/(<|&lt;)\/sketchofont(>|&gt;)/g,"\x3c/span\x3e"),s=s.replace(/(<|&lt;)sketchometry-light(>|&gt;)/g,"\x3cspan style\x3dfont-family:sketchometry-light;font-weight:500;\x3e"),s=s.replace(/(<|&lt;)\/sketchometry-light(>|&gt;)/g,"\x3c/span\x3e"));return s},convertGeonextAndSketchometry2CSS:function(s){s=this.convertGeonext2CSS(s);return s=this.convertSketchometry2CSS(s)},notifyParents:function(content){content=
content.replace(/&lt;value&gt;/g,"\x3cvalue\x3e");content=content.replace(/&lt;\/value&gt;/g,"\x3c/value\x3e");do{var search=/<value>([\w\s*/^\-+()[\],<>=!]+)<\/value>/;var res=search.exec(content);null!==res&&(_geonext.default.findDependencies(this,res[1],this.board),content=content.substr(res.index),content=content.replace(search,""))}while(null!==res);return this},getParents:function(){var p=void 0!==this.relativeCoords?[this.relativeCoords.usrCoords[1],this.relativeCoords.usrCoords[2],this.orgText]:
[this.Z(),this.X(),this.Y(),this.orgText];0!==this.parents.length&&(p=this.parents);return p},bounds:function(){var c=this.coords.usrCoords;return _type.default.evaluate(this.visProp.islabel)||0===this.board.unitY||0===this.board.unitX?[0,0,0,0]:[c[1],c[2]+this.size[1]/this.board.unitY,c[1]+this.size[0]/this.board.unitX,c[2]]},getAnchorX:function(){var a=_type.default.evaluate(this.visProp.anchorx);if("auto"===a)switch(this.visProp.position){case "top":case "bot":return"middle";case "rt":case "lrt":case "urt":return"left";
default:return"right"}return a},getAnchorY:function(){var a=_type.default.evaluate(this.visProp.anchory);if("auto"===a)switch(this.visProp.position){case "top":case "ulft":case "urt":return"bottom";case "bot":case "lrt":case "llft":return"top";default:return"middle"}return a},getNumberofConflicts:function(x,y,w,h){var count=0,le;var savePointPrecision=this.board.options.precision.hasPoint;this.board.options.precision.hasPoint=.25*(w+h);w=0;for(le=this.board.objectsList.length;w<le;w++)h=this.board.objectsList[w],
h.visPropCalc.visible&&"axis"!==h.elType&&"ticks"!==h.elType&&h!==this.board.infobox&&h!==this&&h.hasPoint(x,y)&&count++;this.board.options.precision.hasPoint=savePointPrecision;return count},setAutoPosition:function(){var w=this.size[0],h=this.size[1],JSCompiler_object_inline_r_4906,step=2*Math.PI/12;if(this===this.board.infobox||!this.visPropCalc.visible||!_type.default.evaluate(this.visProp.islabel)||!this.element)return this;var delta_r=_type.default.evaluate(this.visProp.offset);var cy=this.element.getLabelAnchor();
var cx=cy.scrCoords[1];cy=cy.scrCoords[2];var start_angle=delta_r[0];var angle=delta_r[1];var x=this.getNumberofConflicts(cx+start_angle,cy-angle,w,h);if(0===x)return this;var r=12;delta_r=.2*r;start_angle=Math.atan2(angle,start_angle);var JSCompiler_object_inline_conflicts_4904=x;var JSCompiler_object_inline_angle_4905=start_angle;for(JSCompiler_object_inline_r_4906=r;0<JSCompiler_object_inline_conflicts_4904&&28>r;){var j=1;for(angle=start_angle+step;12>j&&0<JSCompiler_object_inline_conflicts_4904;j++){x=
Math.cos(angle);var y=Math.sin(angle);x=cx+r*x;y=cy-r*y;x=this.getNumberofConflicts(x,y,w,h);x<JSCompiler_object_inline_conflicts_4904&&(JSCompiler_object_inline_conflicts_4904=x,JSCompiler_object_inline_angle_4905=angle,JSCompiler_object_inline_r_4906=r);if(0===JSCompiler_object_inline_conflicts_4904)break;angle+=step}r+=delta_r}r=JSCompiler_object_inline_r_4906;x=Math.cos(JSCompiler_object_inline_angle_4905);y=Math.sin(JSCompiler_object_inline_angle_4905);this.visProp.offset=[r*x,r*y];this.visProp.anchorx=
-.2>x?"right":.2<x?"left":"middle";return this}});_jxg.default.createText=function(board,parents,attributes){attributes=_type.default.copyAttributes(attributes,board.options,"text");var coords=parents.slice(0,-1),content=parents[parents.length-1];attributes.anchor=attributes.parent||attributes.anchor;board=_coordselement.default.create(_jxg.default.Text,board,coords,attributes,content);if(!board)throw Error("JSXGraph: Can't create text with parent types '"+typeof parents[0]+"' and '"+typeof parents[1]+
"'.\nPossible parent types: [x,y], [z,x,y], [element,transformation]");0!==attributes.rotate&&"internal"===attributes.display&&board.addRotation(attributes.rotate);return board};_jxg.default.registerElement("text",_jxg.default.createText);_jxg.default.createHTMLSlider=function(board,parents,attributes){attributes=_type.default.copyAttributes(attributes,board.options,"htmlslider");if(2!==parents.length||2!==parents[0].length||3!==parents[1].length)throw Error("JSXGraph: Can't create htmlslider with parent types '"+
typeof parents[0]+"' and '"+typeof parents[1]+"'.\nPossible parents are: [[x,y], [min, start, max]]");attributes.anchor=attributes.parent||attributes.anchor;attributes.fixed=attributes.fixed||!0;board=_jxg.default.createText(board,[parents[0][0],parents[0][1],'\x3cform style\x3d"display:inline"\x3e\x3cinput type\x3d"range" /\x3e\x3cspan\x3e\x3c/span\x3e\x3cinput type\x3d"text" /\x3e\x3c/form\x3e'],attributes);board.type=_type.default.OBJECT_TYPE_HTMLSLIDER;board.rendNodeForm=board.rendNode.childNodes[0];
board.rendNodeRange=board.rendNodeForm.childNodes[0];board.rendNodeRange.min=parents[1][0];board.rendNodeRange.max=parents[1][2];board.rendNodeRange.step=attributes.step;board.rendNodeRange.value=parents[1][1];board.rendNodeLabel=board.rendNodeForm.childNodes[1];board.rendNodeLabel.id=board.rendNode.id+"_label";attributes.withlabel&&(board.rendNodeLabel.innerHTML=board.name+"\x3d");board.rendNodeOut=board.rendNodeForm.childNodes[2];board.rendNodeOut.value=parents[1][1];try{board.rendNodeForm.id=board.rendNode.id+
"_form",board.rendNodeRange.id=board.rendNode.id+"_range",board.rendNodeOut.id=board.rendNode.id+"_out"}catch(e){_jxg.default.debug(e)}board.rendNodeRange.style.width=attributes.widthrange+"px";board.rendNodeRange.style.verticalAlign="middle";board.rendNodeOut.style.width=attributes.widthout+"px";board._val=parents[1][1];_jxg.default.supportsVML()?_env.default.addEvent(board.rendNodeForm,"change",JSCompiler_object_inline_HTMLSliderInputEventHandler_4907,board):_env.default.addEvent(board.rendNodeForm,
"input",JSCompiler_object_inline_HTMLSliderInputEventHandler_4907,board);board.Value=function(){return this._val};return board};_jxg.default.registerElement("htmlslider",_jxg.default.createHTMLSlider);exports.default={Text:_jxg.default.Text,createText:_jxg.default.createText,createHTMLSlider:_jxg.default.createHTMLSlider}}
//# sourceMappingURL=module$node_modules$$mentatcollective$jsxgraph$src$base$text.js.map
