{
"version":3,
"file":"module$node_modules$mathbox$build$esm$primitives$types$data$buffer.js",
"lineCount":5,
"mappings":"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",
"sources":["node_modules/mathbox/build/esm/primitives/types/data/buffer.js"],
"sourcesContent":["shadow$provide[\"module$node_modules$mathbox$build$esm$primitives$types$data$buffer\"] = function(global,require,module,exports) {\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Buffer = void 0;\n\nvar _data = require(\"./data.js\");\n\n// TODO: This file was created by bulk-decaffeinate.\n// Sanity-check the conversion and remove this comment.\n\n/*\n * decaffeinate suggestions:\n * DS102: Remove unnecessary code created because of implicit returns\n * DS202: Simplify dynamic range loops\n * DS205: Consider reworking code to avoid use of IIFEs\n * DS206: Consider reworking classes to avoid initClass\n * DS207: Consider shorter variations of null checks\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/master/docs/suggestions.md\n */\nclass Buffer extends _data.Data {\n  static initClass() {\n    this.traits = [\"node\", \"buffer\", \"active\", \"data\", \"source\", \"index\", \"texture\"];\n  }\n\n  init() {\n    this.bufferSlack = 0;\n    this.bufferFrames = 0;\n    this.bufferTime = 0;\n    this.bufferDelta = 0;\n    this.bufferClock = 0;\n    this.bufferStep = 0;\n    super.init();\n  }\n\n  make() {\n    super.make();\n    this.clockParent = this._inherit(\"clock\");\n    this.latchParent = this._inherit(\"latch\");\n  }\n\n  unmake() {\n    return super.unmake();\n  }\n\n  rawBuffer() {\n    return this.buffer;\n  }\n\n  emitter() {\n    const {\n      channels,\n      items\n    } = this.props;\n    return super.emitter(channels, items);\n  }\n\n  change(changed, touched, init) {\n    if (changed[\"buffer.fps\"] || init) {\n      const {\n        fps\n      } = this.props;\n      return this.bufferSlack = fps ? 0.5 / fps : 0;\n    }\n  }\n\n  syncBuffer(callback) {\n    let delta, step;\n\n    if (!this.buffer) {\n      return;\n    }\n\n    const {\n      live,\n      fps,\n      hurry,\n      limit,\n      realtime,\n      observe\n    } = this.props;\n    const filled = this.buffer.getFilled();\n\n    if (filled && !live) {\n      return;\n    }\n\n    if (this.latchParent && !this.latchParent.isDirty) {\n      return;\n    }\n\n    const time = this.clockParent.getTime();\n\n    if (fps != null) {\n      const slack = this.bufferSlack;\n      const speed = time.step / time.delta;\n      delta = realtime ? time.delta : time.step;\n      const frame = 1 / fps;\n      step = realtime && observe ? speed * frame : frame;\n\n      if (Math.abs(time.time - this.bufferTime) > time.step * limit) {\n        this.bufferTime = time.time;\n        this.bufferClock = time.clock;\n      }\n\n      this.bufferSlack = Math.min(limit / fps, slack + delta);\n      this.bufferDelta = delta;\n      this.bufferStep = step;\n      let frames = Math.min(hurry, Math.floor(slack * fps));\n\n      if (!filled) {\n        frames = Math.max(1, frames);\n      }\n\n      let stop = false;\n\n      const abort = () => stop = true;\n\n      return (() => {\n        const result = [];\n\n        for (let i = 0, end = frames, asc = 0 <= end; asc ? i < end : i > end; asc ? i++ : i--) {\n          this.bufferTime += delta;\n          this.bufferClock += step;\n\n          if (stop) {\n            break;\n          }\n\n          callback(abort, this.bufferFrames++, i, frames);\n          result.push(this.bufferSlack -= frame);\n        }\n\n        return result;\n      })();\n    } else {\n      this.bufferTime = time.time;\n      this.bufferDelta = time.delta;\n      this.bufferClock = time.clock;\n      this.bufferStep = time.step;\n      return callback(function () {}, this.bufferFrames++, 0, 1);\n    }\n  }\n\n  alignShader(dims, shader) {\n    const {\n      minFilter,\n      magFilter,\n      aligned\n    } = this.props;\n    const mixed = dims.items > 1 && dims.width > 1 || dims.height > 1 && dims.depth > 1;\n\n    if (aligned || !mixed) {\n      return;\n    }\n\n    const nearest = minFilter === this.node.attributes[\"texture.minFilter\"].enum.nearest && magFilter === this.node.attributes[\"texture.magFilter\"].enum.nearest;\n\n    if (!nearest) {\n      console.warn(`${this.node.toString()} - Cannot use linear min/magFilter with 3D/4D sampling`);\n    }\n\n    return shader.pipe(\"map.xyzw.align\");\n  }\n\n}\n\nexports.Buffer = Buffer;\nBuffer.initClass();\n};"],
"names":["shadow$provide","global","require","module","exports","Object","defineProperty","value","Buffer","_data","Data","initClass","traits","init","bufferStep","bufferClock","bufferDelta","bufferTime","bufferFrames","bufferSlack","make","clockParent","_inherit","latchParent","unmake","rawBuffer","buffer","emitter","channels","items","props","change","changed","touched","fps","syncBuffer","callback","delta","step","live","hurry","limit","realtime","observe","filled","getFilled","isDirty","time","getTime","slack","speed","frame","Math","abs","clock","min","frames","floor","max","stop","abort","result","i","end","asc","push","alignShader","dims","shader","minFilter","magFilter","aligned","mixed","width","height","depth","node","attributes","enum","nearest","console","warn","toString","pipe"]
}
