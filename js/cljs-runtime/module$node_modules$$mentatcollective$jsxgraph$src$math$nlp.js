shadow$provide.module$node_modules$$mentatcollective$jsxgraph$src$math$nlp=function(global,require,module,exports){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0});exports.default=void 0;global=_interopRequireDefault(require("module$node_modules$$mentatcollective$jsxgraph$src$jxg"));_interopRequireDefault(require("module$node_modules$$mentatcollective$jsxgraph$src$utils$type"));global.default.Math.Nlp={arr:function(n){return new Float64Array(n)},
arr2:function(n,m){for(var i=0,a=Array(n);i<n;)a[i]=this.arr(m),i++;return a},arraycopy:function(x,a,iox,b,n){for(var i=0;i<n;)iox[i+b]=x[i+a],i++},Normal:0,MaxIterationsReached:1,DivergingRoundingErrors:2,FindMinimum:function(calcfc,n$jscomp$0,m$jscomp$0,x,rhobeg,rhoend,iprint,maxfun){var mpp=m$jscomp$0+2,iox=this.arr(n$jscomp$0+1),that=this;iox[0]=0;this.arraycopy(x,0,iox,1,n$jscomp$0);m$jscomp$0=this.cobylb(function(n,m,thisx,con){var ix=that.arr(n);that.arraycopy(thisx,1,ix,0,n);thisx=that.arr(m);
n=calcfc(n,m,ix,thisx);that.arraycopy(thisx,0,con,1,m);return n},n$jscomp$0,m$jscomp$0,mpp,iox,rhobeg,rhoend,iprint,maxfun);this.arraycopy(iox,1,x,0,n$jscomp$0);return m$jscomp$0},cobylb:function(calcfc,n,m,mpp,x,rhobeg,rhoend,iprint,maxfun){var status=-1,f=0,resmax=0,total,np=n+1,mp=m+1,parmu=0,iflag=!1,ifull=!1,parsig=0,prerec=0,prerem=0,con=this.arr(1+mpp),sim=this.arr2(1+n,1+np),simi=this.arr2(1+n,1+n),datmat=this.arr2(1+mpp,1+np),a=this.arr2(1+n,1+mp),vsig=this.arr(1+n),veta=this.arr(1+n),sigbar=
this.arr(1+n),dx=this.arr(1+n),w=this.arr(1+n),i,k;2<=iprint&&console.log("The initial value of RHO is "+rhobeg+" and PARMU is set to zero.");var nfvals=0;var temp=1/rhobeg;for(i=1;i<=n;++i)sim[i][np]=x[i],sim[i][i]=rhobeg,simi[i][i]=temp;var jdrop=np;var ibrnch=!1;a:do{if(nfvals>=maxfun&&0<nfvals){status=this.MaxIterationsReached;break a}++nfvals;f=calcfc(n,m,x,con);resmax=0;for(k=1;k<=m;++k)resmax=Math.max(resmax,-con[k]);nfvals!==iprint-1&&3!==iprint||this.PrintIterationResult(nfvals,f,resmax,
x,n,iprint);con[mp]=f;con[mpp]=resmax;var skipVertexIdent=!0;if(!ibrnch){skipVertexIdent=!1;for(i=1;i<=mpp;++i)datmat[i][jdrop]=con[i];if(nfvals<=np){if(jdrop<=n)if(datmat[mp][np]<=f)x[jdrop]=sim[jdrop][np];else{sim[jdrop][np]=x[jdrop];for(k=1;k<=mpp;++k)datmat[k][jdrop]=datmat[k][np],datmat[k][np]=con[k];for(k=1;k<=jdrop;++k){sim[jdrop][k]=-rhobeg;temp=0;for(i=k;i<=jdrop;++i)temp-=simi[i][k];simi[jdrop][k]=temp}}if(nfvals<=n){jdrop=nfvals;x[jdrop]+=rhobeg;continue a}}ibrnch=!0}b:do{c:do{if(!skipVertexIdent){parsig=
datmat[mp][np]+parmu*datmat[mpp][np];iflag=np;for(i=1;i<=n;++i)temp=datmat[mp][i]+parmu*datmat[mpp][i],temp<parsig?(iflag=i,parsig=temp):temp===parsig&&0===parmu&&datmat[mpp][i]<datmat[mpp][iflag]&&(iflag=i);if(iflag<=n){for(i=1;i<=mpp;++i)temp=datmat[i][np],datmat[i][np]=datmat[i][iflag],datmat[i][iflag]=temp;for(i=1;i<=n;++i){temp=sim[i][iflag];sim[i][iflag]=0;sim[i][np]+=temp;parsig=0;for(k=1;k<=n;++k)sim[i][k]-=temp,parsig-=simi[k][i];simi[iflag][i]=parsig}}for(k=1;k<=mp;++k){con[k]=-datmat[k][np];
for(i=1;i<=n;++i)w[i]=datmat[k][i]+con[k];for(i=1;i<=n;++i)a[i][k]=(k===mp?-1:1)*this.DOT_PRODUCT_ROW_COL(w,-1,simi,i,1,n)}iflag=!0;parsig=.25*rhobeg;temp=2.1*rhobeg;for(i=1;i<=n;++i){var l=total=0;for(k=1;k<=n;++k)total+=simi[i][k]*simi[i][k],l+=sim[k][i]*sim[k][i];vsig[i]=1/Math.sqrt(total);veta[i]=Math.sqrt(l);if(vsig[i]<parsig||veta[i]>temp)iflag=!1}if(!ibrnch&&!iflag){jdrop=0;for(i=1;i<=n;++i)veta[i]>temp&&(jdrop=i,temp=veta[i]);if(0===jdrop)for(i=1;i<=n;++i)vsig[i]<temp&&(jdrop=i,temp=vsig[i]);
temp=.5*rhobeg*vsig[jdrop];for(k=1;k<=n;++k)dx[k]=temp*simi[jdrop][k];total=i=skipVertexIdent=0;for(k=1;k<=mp;++k)total=this.DOT_PRODUCT_ROW_COL(dx,-1,a,k,1,n),k<mp&&(temp=datmat[k][np],skipVertexIdent=Math.max(skipVertexIdent,-total-temp),i=Math.max(i,total-temp));skipVertexIdent=parmu*(skipVertexIdent-i)>2*total?-1:1;temp=0;for(i=1;i<=n;++i)dx[i]*=skipVertexIdent,sim[i][jdrop]=dx[i],temp+=simi[jdrop][i]*dx[i];for(k=1;k<=n;++k)simi[jdrop][k]/=temp;for(i=1;i<=n;++i){if(i!==jdrop)for(temp=this.DOT_PRODUCT_ROW_COL(simi,
i,dx,-1,1,n),k=1;k<=n;++k)simi[i][k]-=temp*simi[jdrop][k];x[i]=sim[i][np]+dx[i]}continue a}ifull=this.trstlp(n,m,a,con,rhobeg,dx);if(!ifull){temp=0;for(k=1;k<=n;++k)temp+=dx[k]*dx[k];if(temp<.25*rhobeg*rhobeg){ibrnch=!0;break c}}prerec=total=0;con[mp]=0;for(k=1;k<=mp;++k)total=con[k]-this.DOT_PRODUCT_ROW_COL(dx,-1,a,k,1,n),k<mp&&(prerec=Math.max(prerec,total));prerec=datmat[mpp][np]-prerec;k=0<prerec?total/prerec:0;if(parmu<1.5*k)for(parmu=2*k,2<=iprint&&console.log("Increase in PARMU to "+parmu),
k=datmat[mp][np]+parmu*datmat[mpp][np],i=1;i<=n;++i)if(temp=datmat[mp][i]+parmu*datmat[mpp][i],temp<k||temp===k&&0===parmu&&datmat[mpp][i]<datmat[mpp][np])continue b;prerem=parmu*prerec-total;for(k=1;k<=n;++k)x[k]=sim[k][np]+dx[k];ibrnch=!0;continue a}skipVertexIdent=!1;jdrop=datmat[mp][np]+parmu*datmat[mpp][np];k=f+parmu*resmax;total=jdrop-k;0===parmu&&f===datmat[mp][np]&&(prerem=prerec,total=datmat[mpp][np]-resmax);k=0>=total?1:0;jdrop=0;for(i=1;i<=n;++i)temp=Math.abs(this.DOT_PRODUCT_ROW_COL(simi,
i,dx,-1,1,n)),temp>k&&(jdrop=i,k=temp),sigbar[i]=temp*vsig[i];var edgmax=1.1*rhobeg;l=0;for(i=1;i<=n;++i)if(sigbar[i]>=parsig||sigbar[i]>=vsig[i]){temp=veta[i];if(0<total){temp=0;for(k=1;k<=n;++k)temp+=Math.pow(dx[k]-sim[k][i],2);temp=Math.sqrt(temp)}temp>edgmax&&(l=i,edgmax=temp)}0<l&&(jdrop=l);if(0!==jdrop){temp=0;for(i=1;i<=n;++i)sim[i][jdrop]=dx[i],temp+=simi[jdrop][i]*dx[i];for(k=1;k<=n;++k)simi[jdrop][k]/=temp;for(i=1;i<=n;++i)if(i!==jdrop)for(temp=this.DOT_PRODUCT_ROW_COL(simi,i,dx,-1,1,n),
k=1;k<=n;++k)simi[i][k]-=temp*simi[jdrop][k];for(k=1;k<=mpp;++k)datmat[k][jdrop]=con[k];if(0<total&&total>=.1*prerem)continue b}}while(0);if(!iflag){ibrnch=!1;continue b}if(rhobeg<=rhoend){status=this.Normal;break a}l=total=0;rhobeg*=.5;rhobeg<=1.5*rhoend&&(rhobeg=rhoend);if(0<parmu){edgmax=0;for(k=1;k<=mp;++k){l=total=datmat[k][np];for(i=1;i<=n;++i)total=Math.min(total,datmat[k][i]),l=Math.max(l,datmat[k][i]);k<=m&&total<.5*l&&(temp=Math.max(l,0)-total,edgmax=0>=edgmax?temp:Math.min(edgmax,temp))}0===
edgmax?parmu=0:l-total<parmu*edgmax&&(parmu=(l-total)/edgmax)}2<=iprint&&console.log("Reduction in RHO to "+rhobeg+"  and PARMU \x3d "+parmu);2===iprint&&this.PrintIterationResult(nfvals,datmat[mp][np],datmat[mpp][np],this.COL(sim,np),n,iprint)}while(1)}while(1);switch(status){case this.Normal:1<=iprint&&console.log("%nNormal return from subroutine COBYLA%n");if(ifull)return 1<=iprint&&this.PrintIterationResult(nfvals,f,resmax,x,n,iprint),status;break;case this.MaxIterationsReached:1<=iprint&&console.log("%nReturn from subroutine COBYLA because the MAXFUN limit has been reached.%n");
break;case this.DivergingRoundingErrors:1<=iprint&&console.log("%nReturn from subroutine COBYLA because rounding errors are becoming damaging.%n")}for(k=1;k<=n;++k)x[k]=sim[k][np];f=datmat[mp][np];resmax=datmat[mpp][np];1<=iprint&&this.PrintIterationResult(nfvals,f,resmax,x,n,iprint);return status},trstlp:function(n,m,a,b,rho,dx){var nactx=0,resold=0,z=this.arr2(1+n,1+n),zdota=this.arr(2+m),vmultc=this.arr(2+m),sdirn=this.arr(1+n),dxnew=this.arr(1+n),vmultd=this.arr(2+m),iact=this.arr(2+m),mcon=m,
nact=0,icon,i,k,optold;for(i=1;i<=n;++i)z[i][i]=1,dx[i]=0;var resmax=icon=0;if(1<=m){for(k=1;k<=m;++k)b[k]>resmax&&(resmax=b[k],icon=k);for(k=1;k<=m;++k)iact[k]=k,vmultc[k]=resmax-b[k]}var first=!0;do{a:do{if(!first||first&&0===resmax)icon=mcon=m+1,iact[mcon]=mcon,vmultc[mcon]=0;first=!1;var icount=optold=0;b:do{var temp=mcon===m?resmax:-this.DOT_PRODUCT_ROW_COL(dx,-1,a,mcon,1,n);0===icount||temp<optold?(optold=temp,nactx=nact,icount=3):nact>nactx?(nactx=nact,icount=3):--icount;if(0===icount)break a;
if(icon<=nact){if(icon<nact){var isave=iact[icon];var vsave=vmultc[icon];k=icon;do{var stpful=k+1;var kk=iact[stpful];var step=this.DOT_PRODUCT(this.PART(this.COL(z,k),1,n),this.PART(this.COL(a,kk),1,n));temp=Math.sqrt(step*step+zdota[stpful]*zdota[stpful]);var alpha=zdota[stpful]/temp;step/=temp;zdota[stpful]=alpha*zdota[k];zdota[k]=temp;for(i=1;i<=n;++i)temp=alpha*z[i][stpful]+step*z[i][k],z[i][stpful]=alpha*z[i][k]-step*z[i][stpful],z[i][k]=temp;iact[k]=kk;vmultc[k]=vmultc[stpful];k=stpful}while(k<
nact);iact[k]=isave;vmultc[k]=vsave}--nact;if(mcon>m)for(temp=1/zdota[nact],k=1;k<=n;++k)sdirn[k]=temp*z[k][nact];else for(temp=this.DOT_PRODUCT_ROW_COL(sdirn,-1,z,nact+1,1,n),k=1;k<=n;++k)sdirn[k]-=temp*z[k][nact+1]}else{kk=iact[icon];for(k=1;k<=n;++k)dxnew[k]=a[k][kk];var ratio=0;for(k=n;k>nact;){stpful=step=0;for(i=1;i<=n;++i)temp=z[i][k]*dxnew[i],step+=temp,stpful+=Math.abs(temp);temp=stpful+.1*Math.abs(step);i=stpful+.2*Math.abs(step);if(stpful>=temp||temp>=i)step=0;if(0===ratio)ratio=step;else for(stpful=
k+1,temp=Math.sqrt(step*step+ratio*ratio),alpha=step/temp,step=ratio/temp,ratio=temp,i=1;i<=n;++i)temp=alpha*z[i][k]+step*z[i][stpful],z[i][stpful]=alpha*z[i][stpful]-step*z[i][k],z[i][k]=temp;--k}if(0===ratio){ratio=-1;k=nact;do{stpful=step=0;for(i=1;i<=n;++i)temp=z[i][k]*dxnew[i],step+=temp,stpful+=Math.abs(temp);temp=stpful+.1*Math.abs(step);i=stpful+.2*Math.abs(step);if(stpful<temp&&temp<i){temp=step/zdota[k];0<temp&&iact[k]<=m&&(i=vmultc[k]/temp,0>ratio||i<ratio)&&(ratio=i);if(2<=k){var kw=iact[k];
for(i=1;i<=n;++i)dxnew[i]-=temp*a[i][kw]}vmultd[k]=temp}else vmultd[k]=0}while(0<--k);if(0>ratio)break a;for(k=1;k<=nact;++k)vmultc[k]=Math.max(0,vmultc[k]-ratio*vmultd[k]);if(icon<nact){isave=iact[icon];vsave=vmultc[icon];k=icon;do{stpful=k+1;kw=iact[stpful];step=this.DOT_PRODUCT(this.PART(this.COL(z,k),1,n),this.PART(this.COL(a,kw),1,n));temp=Math.sqrt(step*step+zdota[stpful]*zdota[stpful]);alpha=zdota[stpful]/temp;step/=temp;zdota[stpful]=alpha*zdota[k];zdota[k]=temp;for(i=1;i<=n;++i)temp=alpha*
z[i][stpful]+step*z[i][k],z[i][stpful]=alpha*z[i][k]-step*z[i][stpful],z[i][k]=temp;iact[k]=kw;vmultc[k]=vmultc[stpful];k=stpful}while(k<nact);iact[k]=isave;vmultc[k]=vsave}temp=this.DOT_PRODUCT(this.PART(this.COL(z,nact),1,n),this.PART(this.COL(a,kk),1,n));if(0===temp)break a;zdota[nact]=temp;vmultc[icon]=0;vmultc[nact]=ratio}else++nact,zdota[nact]=ratio,vmultc[icon]=vmultc[nact],vmultc[nact]=0;iact[icon]=iact[nact];iact[nact]=kk;if(mcon>m&&kk!==mcon){k=nact-1;step=this.DOT_PRODUCT(this.PART(this.COL(z,
k),1,n),this.PART(this.COL(a,kk),1,n));temp=Math.sqrt(step*step+zdota[nact]*zdota[nact]);alpha=zdota[nact]/temp;step/=temp;zdota[nact]=alpha*zdota[k];zdota[k]=temp;for(i=1;i<=n;++i)temp=alpha*z[i][nact]+step*z[i][k],z[i][nact]=alpha*z[i][k]-step*z[i][nact],z[i][k]=temp;iact[nact]=iact[k];iact[k]=kk;temp=vmultc[k];vmultc[k]=vmultc[nact];vmultc[nact]=temp}if(mcon>m)for(temp=1/zdota[nact],k=1;k<=n;++k)sdirn[k]=temp*z[k][nact];else for(kk=iact[nact],temp=(this.DOT_PRODUCT_ROW_COL(sdirn,-1,a,kk,1,n)-1)/
zdota[nact],k=1;k<=n;++k)sdirn[k]-=temp*z[k][nact]}k=rho*rho;kk=ratio=0;for(i=1;i<=n;++i)Math.abs(dx[i])>=1E-6*rho&&(k-=dx[i]*dx[i]),ratio+=dx[i]*sdirn[i],kk+=sdirn[i]*sdirn[i];if(0>=k)break a;temp=Math.sqrt(kk*k);Math.abs(ratio)>=1E-6*temp&&(temp=Math.sqrt(kk*k+ratio*ratio));step=stpful=k/(temp+ratio);if(mcon===m){temp=step+.1*resmax;i=step+.2*resmax;if(step>=temp||temp>=i)break b;step=Math.min(step,resmax)}for(k=1;k<=n;++k)dxnew[k]=dx[k]+step*sdirn[k];if(mcon===m)for(resold=resmax,resmax=0,k=1;k<=
nact;++k)kk=iact[k],temp=b[kk]-this.DOT_PRODUCT_ROW_COL(dxnew,-1,a,kk,1,n),resmax=Math.max(resmax,temp);k=nact;do{kk=icon=0;for(i=1;i<=n;++i)temp=z[i][k]*dxnew[i],icon+=temp,kk+=Math.abs(temp);temp=kk+.1*Math.abs(icon);i=kk+.2*Math.abs(icon);if(kk>=temp||temp>=i)icon=0;vmultd[k]=icon/zdota[k];if(2<=k)for(kk=iact[k],i=1;i<=n;++i)dxnew[i]-=vmultd[k]*a[i][kk]}while(2<=k--);mcon>m&&(vmultd[nact]=Math.max(0,vmultd[nact]));for(k=1;k<=n;++k)dxnew[k]=dx[k]+step*sdirn[k];if(mcon>nact)for(k=temp=nact+1;k<=
mcon;++k){kk=iact[k];icon=resmax-b[kk];ratio=resmax+Math.abs(b[kk]);for(i=1;i<=n;++i)temp=a[i][kk]*dxnew[i],icon+=temp,ratio+=Math.abs(temp);temp=ratio+.1*Math.abs(icon);i=ratio+.2*Math.abs(icon);if(ratio>=temp||temp>=i)icon=0;vmultd[k]=icon}ratio=1;icon=0;for(k=1;k<=mcon;++k)0>vmultd[k]&&(temp=vmultc[k]/(vmultc[k]-vmultd[k]),temp<ratio&&(ratio=temp,icon=k));temp=1-ratio;for(k=1;k<=n;++k)dx[k]=temp*dx[k]+ratio*dxnew[k];for(k=1;k<=mcon;++k)vmultc[k]=Math.max(0,temp*vmultc[k]+ratio*vmultd[k]);mcon===
m&&(resmax=resold+ratio*(resmax-resold))}while(0<icon);if(step===stpful)return!0}while(1)}while(mcon===m);return!1},PrintIterationResult:function(nfvals,f,resmax,x,n,iprint){1<iprint&&console.log("NFVALS \x3d "+nfvals+"  F \x3d "+f+"  MAXCV \x3d "+resmax);1<iprint&&console.log("X \x3d "+this.PART(x,1,n))},ROW:function(src,rowidx){return src[rowidx].slice()},COL:function(src,colidx){var row,rows=src.length,dest=[];for(row=0;row<rows;++row)dest[row]=src[row][colidx];return dest},PART:function(src,from,
to){return src.slice(from,to+1)},FORMAT:function(x){return x.join(",")},DOT_PRODUCT:function(lhs,rhs){var i,sum=0,len=lhs.length;for(i=0;i<len;++i)sum+=lhs[i]*rhs[i];return sum},DOT_PRODUCT_ROW_COL:function(lhs,row,rhs,col,start,end){var sum=0;if(-1===row)for(;start<=end;++start)sum+=lhs[start]*rhs[start][col];else if(-1===col)for(;start<=end;++start)sum+=lhs[row][start]*rhs[start];else for(;start<=end;++start)sum+=lhs[row][start]*rhs[start][col];return sum}};exports.default=global.default.Math.Nlp}
//# sourceMappingURL=module$node_modules$$mentatcollective$jsxgraph$src$math$nlp.js.map
