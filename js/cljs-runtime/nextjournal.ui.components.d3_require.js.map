{"version":3,"sources":["nextjournal/ui/components/d3_require.cljs"],"mappings":";;AAKA,6CAAA,oDAAAA,jGAAMI,0GACgDG;AADtD,AAAA,IAAAN,aAAAD;IAAAC,iBAAA,AAAAC,4BAAAD;eAAA,AAAAE,4CAAAF,eAAA,tEAAoBI;mBAApB,AAAAF,4CAAAF,eAAA,qEAAA,/IAA4BK;AAA5B,AAEE,IAAAE,gBAAA,AAAAC,8BAAA;AAAA,AAAA,IAAAC,2BAAAC;AAAA,AAAA,GAAA,CAAAD,4BAAA;AAAA;AAAA,IAAAE,yBAAAF;AAAA,AAAA,GAAA,CAAA,AAAAF,6BAAA,AAAAI;AAAA,AAAA,GAAAC;AAAA,AAAA,AAAA,EAAAC,wBAAAC,4BAAAC,eAAA,CAAA,iDAAA;;AAAA;;AAAA;;AAAA,CAAA,AAAAR,2BAAA,AAAAI;;;AAAA,IAAAK,YAAA,CAAA,AAAAT,yBAAA;oBAAA,EAAA,EAAAS,eAAA,AAAAC,cAAA,AAAAV,6BAAA,SAAA,CAAAA,cAAA,8DAAA,CAAAA,cAAA,nLAAaY,6GAAS,gDAAA,hDAACC;IAAvBF,WAAA,AACE,iBAAAG,WAAA,AAAAC,gBAAOH;AAAP,AAAA,GAAA,AAAAI,6CAAA,KAAAF;AACM,AACE,oCAAA,pCAACG,sBAAOL;;+BACJ,EAAI,OAASf,uBACX,AAACqB,uDAAWrB,UACZ,AAACsB,8CAAMD,uDAAWrB,rOACpB,IAAAuB;IAAAC,yBAAA,CAAAD,yBAAA;AAAA,AAAA,AAAAC,4BAAAD,yBAAA,WAAAE;AAAA,AAAe,2CAAAA,pCAACL,sBAAOL;;;AAC3Bd;;AAPR,GAAA,AAAAkB,6CAAA,2DAAAF;AAQWhB;;AARX,AASE,OAACyB,6CAAK,iBAAAC,WAAA,AAAAT,gBAAIH;AAAJ,AAAA,0EAAAY,wBAAAA,1FAACzB,kCAAAA,4CAAAA;;;;;;AAVX,AAAAY;;AAYF","names":["p__94824","map__94826","cljs.core/--destructure-map","cljs.core.get","nextjournal.ui.components.d3-require/with","package","loading-view","f","with-let94827","reagent.ratom/with-let-values","temp__5757__auto__","reagent.ratom/*ratom-context*","c__85371__auto__","reagent.debug/has-console","reagent.debug/tracking","reagent.debug/track-console","js/console","init94828","cljs.core/not","res94829","!package","reagent.core.atom","G__94839","cljs.core/deref","cljs.core._EQ_","cljs.core/reset!","js/module$node_modules$d3_require$dist$d3_require.require","cljs.core.apply","obj__83643__auto__","f__83644__auto__","p1__94818#","cljs.core.into","G__94844"],"sourcesContent":["(ns nextjournal.ui.components.d3-require\n  (:require [\"d3-require\" :as d3]\n            [applied-science.js-interop :as j]\n            [reagent.core :as r]))\n\n(defn with [{:keys [package loading-view]\n                     :or {loading-view \"Loading...\"}} f]\n  (r/with-let [!package (r/atom nil)]\n    (case @!package\n      nil (do\n            (reset! !package :loading)\n            (-> (if (string? package)\n                  (d3/require package)\n                  (apply d3/require package))\n                (j/call :then #(reset! !package %)))\n            loading-view)\n      :loading loading-view\n      (into (f @!package)))))\n\n(comment\n ;; Usage\n [with {:package [\"vega-embed@6.11.1\"]}\n  (j/fn [^:js {:keys [embed]}]\n    [:div {:ref #(when % (embed % (clj->js value)))}])])\n"]}