{
"version":3,
"file":"module$node_modules$mathbox$build$esm$primitives$types$text$text.js",
"lineCount":7,
"mappings":"AAAAA,cAAA,CAAA,gEAAA,CAAqF,QAAQ,CAACC,MAAD,CAAQC,OAAR,CAAgBC,MAAhB,CAAuBC,OAAvB,CAAgC,CAgB7HC,QAASA,yBAAwB,CAACC,oBAAD,CAAc,CAAE,GAAuB,UAAvB,GAAI,MAAOC,QAAX,CAAmC,MAAO,KAAM,KAAIC,kBAAoB,IAAID,OAA5B,CAA2CE,iBAAmB,IAAIF,OAAW,OAAO,CAACF,wBAAD,CAA4BA,QAAS,CAACC,WAAD,CAAc,CAAE,MAAOA,YAAA,CAAcG,gBAAd,CAAiCD,iBAA1C,CAAnD,EAAmHF,oBAAnH,CAAtI,CAb/CI,MAAOC,CAAAA,cAAP,CAAsBP,OAAtB,CAA+B,YAA/B,CAA6C,CAC3CQ,MAAO,CAAA,CADoC,CAA7C,CAGAR,QAAQS,CAAAA,IAAR,CAAe,IAAK,EAEpB,KAAIC,MAUJC,QAAgC,CAACC,GAAD;AAAMV,WAAN,CAAmB,CAAE,GAAI,CAACA,WAAL,EAAoBU,GAApB,EAA2BA,GAAIC,CAAAA,UAA/B,CAA6C,MAAOD,IAAO,IAAY,IAAZ,GAAIA,GAAJ,EAAmC,QAAnC,GAAoB,MAAOA,IAA3B,EAA8D,UAA9D,GAA+C,MAAOA,IAAtD,CAA4E,MAAO,CAAEE,QAASF,GAAX,CAAuE,KAA/CG,WAA+C,CAAvCd,wBAAA,CAAyBC,WAAzB,CAAuC,GAAaa,WAAMC,CAAAA,GAAN,CAAUJ,GAAV,CAAb,CAA+B,MAAOG,YAAME,CAAAA,GAAN,CAAUL,GAAV,CAAkB,KAAIM,OAAS,EAAb,CAAqBC,sBAAwBb,MAAOC,CAAAA,cAA/BY,EAAiDb,MAAOc,CAAAA,wBAA7E,CAAgHC,GAAT,KAASA,GAAT,GAAgBT,IAAhB,CAAuB,GAAY,SAAZ,GAAIS,GAAJ,EAAyBf,MAAOgB,CAAAA,SAAUC,CAAAA,cAAeC,CAAAA,IAAhC,CAAqCZ,GAArC,CAA0CS,GAA1C,CAAzB,CAAyE,CAAE,IAAII,KAAON,qBAAA,CAAwBb,MAAOc,CAAAA,wBAAP,CAAgCR,GAAhC,CAAqCS,GAArC,CAAxB,CAAoE,IAAUI;IAAJ,GAAaA,IAAKR,CAAAA,GAAlB,EAAyBQ,IAAKC,CAAAA,GAA9B,EAAsCpB,MAAOC,CAAAA,cAAP,CAAsBW,MAAtB,CAA8BG,GAA9B,CAAmCI,IAAnC,CAAtC,CAAyFP,MAAA,CAAOG,GAAP,CAAzF,CAAuGT,GAAA,CAAIS,GAAJ,CAA9L,CAA8MH,MAAOJ,CAAAA,OAAP,CAAiBF,GAASG,YAAJ,EAAaA,WAAMW,CAAAA,GAAN,CAAUd,GAAV,CAAeM,MAAf,CAA0B,OAAOA,OAAxuB,CAVvC,CAAwBpB,OAAA,CAAQ,iDAAR,CAAxB,CAAZ,CAEI6B,WAAa7B,OAAA,CAAQ,yCAAR,CAFjB,CAII8B,QAAU9B,OAAA,CAAQ,oEAAR,CAEV+B,OAAAA,CAAS/B,OAAA,CAAQ,mEAAR,CAgBb,MAAMW,KAAN,QAAmBoB,OAAOC,CAAAA,KAA1B,CACSC,gBAAS,EAAG,CACjB,IAAKC,CAAAA,MAAL;AAAc,iDAAA,CAAA,KAAA,CAAA,GAAA,CACd,KAAKC,CAAAA,QAAL,CAAgB,CACdC,UAAW,QADG,CAEdC,UAAW,QAFG,CAIhB,KAAKC,CAAAA,MAAL,CAAc,CACZC,SAAU,CADE,CANG,CAWnBC,IAAI,EAAG,CACL,KAAMA,CAAAA,IAAN,EACA,OAAO,KAAKC,CAAAA,KAAZ,CAAoB,IAFf,CAKPC,UAAU,CAACC,MAAD,CAAS,CACjB,MAAO,KAAKF,CAAAA,KAAME,CAAAA,MAAX,CAAkBA,MAAlB,CADU,CAInBC,SAAS,EAAG,CACV,MAAwB,EAAxB,CAAO,IAAKC,CAAAA,KAAMC,CAAAA,GADR,CAIZC,UAAU,EAAG,CACX,MAAO,KAAKF,CAAAA,KAAMG,CAAAA,MADP,CAIbC,IAAI,EAAG,CAEL,IAAI,CACFb,SADE,CAEFC,SAFE,CAGFa,IAHE,CAAA,CAIA,IAAKL,CAAAA,KAET,OAAM,CACJM,IADI,CAEJC,KAFI,CAGJC,OAHI,CAIJC,MAJI,CAKJN,MALI,CAMJF,GANI,CAAA,CAOF,IAAKD,CAAAA,KAET,KAAKJ,CAAAA,KAAL,CAAa,IAAKc,CAAAA,YAAaN,CAAAA,IAAlB,CAAuB,WAAvB,CAAoC,CAC/CE,IAD+C,CAE/CK,KAAMR,MAFyC,CAG/CI,KAH+C,CAI/CC,OAJ+C,CAK/CC,MAL+C,CAM/CG,QAASX,GANsC;AAO/CV,SAP+C,CAQ/CC,SAR+C,CAS/Ca,IAT+C,CAApC,CAab,KAAKb,CAAAA,SAAL,CADA,IAAKD,CAAAA,SACL,CADiBP,UAAW6B,CAAAA,aAE5B,KAAKR,CAAAA,IAAL,CAAYrB,UAAW8B,CAAAA,SAEvB7B,QAAQ8B,CAAAA,MAAOpC,CAAAA,SAAUyB,CAAAA,IAAKvB,CAAAA,IAA9B,CAAmC,IAAnC,CAGAU,UAAA,CAA8B,IAAlB,EAAA,IAAKA,CAAAA,SAAL,CAAyB,IAAKA,CAAAA,SAA9B,CAA0C,IAAKS,CAAAA,KAAMT,CAAAA,SACjEC,UAAA,CAA8B,IAAlB,EAAA,IAAKA,CAAAA,SAAL,CAAyB,IAAKA,CAAAA,SAA9B,CAA0C,IAAKQ,CAAAA,KAAMR,CAAAA,SACjEa,KAAA,CAAoB,IAAb,EAAA,IAAKA,CAAAA,IAAL,CAAoB,IAAKA,CAAAA,IAAzB,CAAgC,IAAKL,CAAAA,KAAMK,CAAAA,IAElD,KAAM,CACJW,KADI,CAAA,CAEF,IAAKhB,CAAAA,KAFT,CAGM,CACJiB,MADI,CAAA,CAEF,IAAKjB,CAAAA,KACT,OAAM,CACJkB,KADI,CAAA,CAEF,IAAKlB,CAAAA,KAFT,CAGMmB,SAAW,IAAKnB,CAAAA,KAAMoB,CAAAA,WAH5B,CAIMC,SAAW,IAAKrB,CAAAA,KAAMsB,CAAAA,YAJ5B,CAKMC,SAAW,IAAKvB,CAAAA,KAAMwB,CAAAA,WAL5B,CAMM,CACJ9B,QADI,CAAA;AAEF,IAAKM,CAAAA,KART,CASM,CACJyB,KADI,CAAA,CAEF,IAAKzB,CAAAA,KACL0B,MAAAA,CAAO,IAAKC,CAAAA,IAAZD,CAAmB,CACrBhC,QADqB,CAErB+B,KAFqB,CAGrBT,KAHqB,CAIrBC,MAJqB,CAKrBC,KALqB,CAOvB,KAAKO,CAAAA,KAAL,CAAaC,KAAKD,CAAAA,KAClB,KAAK/B,CAAAA,QAAL,CAAgBgC,KAAKhC,CAAAA,QAErB,EAAM,CACJ,KAAAkC,MADI,CAAN,CAEI,IAAK5B,CAAAA,KAFT,CAGA0B,MAAA,CAAO3D,KAAM8D,CAAAA,aAAN,CAAoBD,MAApB,CAA0BF,KAA1B,CACP,EAAM,CACJ,MAAAI,MADI,CAAN,CAEI,IAFJ,CAGAA,OAAMd,CAAAA,KAAN,CAAce,IAAKC,CAAAA,GAAL,CAASb,QAAT,CAAmBO,KAAKV,CAAAA,KAAxB,EAAiC,CAAjC,CACdc,OAAMb,CAAAA,MAAN,CAAec,IAAKC,CAAAA,GAAL,CAASX,QAAT,CAAmBK,KAAKT,CAAAA,MAAxB,EAAkC,CAAlC,CACfa,OAAMZ,CAAAA,KAAN,CAAca,IAAKC,CAAAA,GAAL,CAAST,QAAT,CAAmBG,KAAKR,CAAAA,KAAxB,EAAiC,CAAjC,CAEd,KAAKe,CAAAA,MAAL,CAAc,IAAKvB,CAAAA,YAAaN,CAAAA,IAAlB,CAAuB,IAAK8B,CAAAA,OAA5B,CAAqC,CACjDlB,MAAOc,MAAMd,CAAAA,KADoC,CAEjDC,OAAQa,MAAMb,CAAAA,MAFmC,CAGjDC,MAAOY,MAAMZ,CAAAA,KAHoC,CAIjDxB,SAAU,CAJuC,CAKjD+B,KALiD,CAMjDlC,SANiD;AAOjDC,SAPiD,CAQjDa,IARiD,CAArC,CAWd,OAAM,CACJT,KADI,CAAA,CAEF,IAFJ,CAGM,CACJuC,IADI,CAAA,CAEF,IAAKF,CAAAA,MAAOG,CAAAA,QAChB,OAAO,KAAKH,CAAAA,MAAOG,CAAAA,QAASD,CAAAA,IAA5B,CAAmCE,IAAAC,EAAQ1C,KAAM2C,CAAAA,GAAN,CAAUF,IAAV,CAAgBF,IAAhB,CAhGtC,CAmGPK,MAAM,EAAG,CACP,KAAMA,CAAAA,MAAN,EAEA,IAAI,IAAK5C,CAAAA,KAAT,CAEE,MADA,KAAKA,CAAAA,KAAM6C,CAAAA,OAAX,EACO,CAAA,IAAK7C,CAAAA,KAAL,CAAa,IALf,CAST8C,MAAM,EAAG,CACP,IAAK9C,CAAAA,KAAM+C,CAAAA,KAAX,EACA,MAAMD,CAAAA,MAAN,EACA,OAAO,KAAK9C,CAAAA,KAAMgD,CAAAA,GAAX,EAHA,CAMTC,MAAM,CAACC,OAAD,CAAUC,OAAV,CAAmBpD,IAAnB,CAAyB,CAC7B,MAAIoD,QAAA,CAAA,IAAJ,CACS,IAAKC,CAAAA,OAAL,EADT,CAIO,KAAMH,CAAAA,MAAN,CAAaC,OAAb,CAAsBC,OAAtB,CAA+BpD,IAA/B,CALsB,CA/IjC,CAyJAtC,OAAQS,CAAAA,IAAR,CAAeA,IACfA,KAAKsB,CAAAA,SAAL,EAxL6H;",
"sources":["node_modules/mathbox/build/esm/primitives/types/text/text.js"],
"sourcesContent":["shadow$provide[\"module$node_modules$mathbox$build$esm$primitives$types$text$text\"] = function(global,require,module,exports) {\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Text = void 0;\n\nvar UData = _interopRequireWildcard(require(\"../../../util/data.js\"));\n\nvar _constants = require(\"three/src/constants.js\");\n\nvar _buffer = require(\"../data/buffer.js\");\n\nvar _voxel = require(\"../data/voxel.js\");\n\nfunction _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== \"function\") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function (nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }\n\nfunction _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== \"object\" && typeof obj !== \"function\") { return { default: obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\n\n// TODO: This file was created by bulk-decaffeinate.\n// Sanity-check the conversion and remove this comment.\n\n/*\n * decaffeinate suggestions:\n * DS102: Remove unnecessary code created because of implicit returns\n * DS206: Consider reworking classes to avoid initClass\n * DS207: Consider shorter variations of null checks\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/master/docs/suggestions.md\n */\nclass Text extends _voxel.Voxel {\n  static initClass() {\n    this.traits = [\"node\", \"buffer\", \"active\", \"data\", \"texture\", \"voxel\", \"text\", \"font\"];\n    this.defaults = {\n      minFilter: \"linear\",\n      magFilter: \"linear\"\n    };\n    this.finals = {\n      channels: 1\n    };\n  }\n\n  init() {\n    super.init();\n    return this.atlas = null;\n  }\n\n  textShader(shader) {\n    return this.atlas.shader(shader);\n  }\n\n  textIsSDF() {\n    return this.props.sdf > 0;\n  }\n\n  textHeight() {\n    return this.props.detail;\n  }\n\n  make() {\n    // Read sampling parameters\n    let {\n      minFilter,\n      magFilter,\n      type\n    } = this.props; // Read font parameters\n\n    const {\n      font,\n      style,\n      variant,\n      weight,\n      detail,\n      sdf\n    } = this.props; // Prepare text atlas\n\n    this.atlas = this._renderables.make(\"textAtlas\", {\n      font,\n      size: detail,\n      style,\n      variant,\n      weight,\n      outline: sdf,\n      minFilter,\n      magFilter,\n      type\n    }); // Underlying data buffer needs no filtering\n\n    this.minFilter = _constants.NearestFilter;\n    this.magFilter = _constants.NearestFilter;\n    this.type = _constants.FloatType; // Skip voxel::make(), as we need 4 channels internally in our buffer to store sprite x/y/w/h per string\n\n    _buffer.Buffer.prototype.make.call(this); // Read sampling parameters\n\n\n    minFilter = this.minFilter != null ? this.minFilter : this.props.minFilter;\n    magFilter = this.magFilter != null ? this.magFilter : this.props.magFilter;\n    type = this.type != null ? this.type : this.props.type; // Read given dimensions\n\n    const {\n      width\n    } = this.props;\n    const {\n      height\n    } = this.props;\n    const {\n      depth\n    } = this.props;\n    const reserveX = this.props.bufferWidth;\n    const reserveY = this.props.bufferHeight;\n    const reserveZ = this.props.bufferDepth;\n    const {\n      channels\n    } = this.props;\n    const {\n      items\n    } = this.props;\n    let dims = this.spec = {\n      channels,\n      items,\n      width,\n      height,\n      depth\n    };\n    this.items = dims.items;\n    this.channels = dims.channels; // Init to right size if data supplied\n\n    const {\n      data\n    } = this.props;\n    dims = UData.getDimensions(data, dims);\n    const {\n      space\n    } = this;\n    space.width = Math.max(reserveX, dims.width || 1);\n    space.height = Math.max(reserveY, dims.height || 1);\n    space.depth = Math.max(reserveZ, dims.depth || 1); // Create text voxel buffer\n\n    this.buffer = this._renderables.make(this.storage, {\n      width: space.width,\n      height: space.height,\n      depth: space.depth,\n      channels: 4,\n      items,\n      minFilter,\n      magFilter,\n      type\n    }); // Hook buffer emitter to map atlas text\n\n    const {\n      atlas\n    } = this;\n    const {\n      emit\n    } = this.buffer.streamer;\n    return this.buffer.streamer.emit = text => atlas.map(text, emit);\n  }\n\n  unmake() {\n    super.unmake();\n\n    if (this.atlas) {\n      this.atlas.dispose();\n      return this.atlas = null;\n    }\n  }\n\n  update() {\n    this.atlas.begin();\n    super.update();\n    return this.atlas.end();\n  }\n\n  change(changed, touched, init) {\n    if (touched[\"font\"]) {\n      return this.rebuild();\n    }\n\n    return super.change(changed, touched, init);\n  }\n\n}\n\nexports.Text = Text;\nText.initClass();\n};"],
"names":["shadow$provide","global","require","module","exports","_getRequireWildcardCache","nodeInterop","WeakMap","cacheBabelInterop","cacheNodeInterop","Object","defineProperty","value","Text","UData","_interopRequireWildcard","obj","__esModule","default","cache","has","get","newObj","hasPropertyDescriptor","getOwnPropertyDescriptor","key","prototype","hasOwnProperty","call","desc","set","_constants","_buffer","_voxel","Voxel","initClass","traits","defaults","minFilter","magFilter","finals","channels","init","atlas","textShader","shader","textIsSDF","props","sdf","textHeight","detail","make","type","font","style","variant","weight","_renderables","size","outline","NearestFilter","FloatType","Buffer","width","height","depth","reserveX","bufferWidth","reserveY","bufferHeight","reserveZ","bufferDepth","items","dims","spec","data","getDimensions","space","Math","max","buffer","storage","emit","streamer","text","this.buffer.streamer.emit","map","unmake","dispose","update","begin","end","change","changed","touched","rebuild"]
}
