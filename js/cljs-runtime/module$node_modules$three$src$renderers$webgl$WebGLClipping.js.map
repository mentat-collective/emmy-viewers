{
"version":3,
"file":"module$node_modules$three$src$renderers$webgl$WebGLClipping.js",
"lineCount":6,
"mappings":"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",
"sources":["node_modules/three/src/renderers/webgl/WebGLClipping.js"],
"sourcesContent":["shadow$provide[\"module$node_modules$three$src$renderers$webgl$WebGLClipping\"] = function(global,require,module,exports) {\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.WebGLClipping = WebGLClipping;\n\nvar _Matrix = require(\"../../math/Matrix3.js\");\n\nvar _Plane = require(\"../../math/Plane.js\");\n\nfunction WebGLClipping(properties) {\n  const scope = this;\n  let globalState = null,\n      numGlobalPlanes = 0,\n      localClippingEnabled = false,\n      renderingShadows = false;\n  const plane = new _Plane.Plane(),\n        viewNormalMatrix = new _Matrix.Matrix3(),\n        uniform = {\n    value: null,\n    needsUpdate: false\n  };\n  this.uniform = uniform;\n  this.numPlanes = 0;\n  this.numIntersection = 0;\n\n  this.init = function (planes, enableLocalClipping, camera) {\n    const enabled = planes.length !== 0 || enableLocalClipping || // enable state of previous frame - the clipping code has to\n    // run another frame in order to reset the state:\n    numGlobalPlanes !== 0 || localClippingEnabled;\n    localClippingEnabled = enableLocalClipping;\n    globalState = projectPlanes(planes, camera, 0);\n    numGlobalPlanes = planes.length;\n    return enabled;\n  };\n\n  this.beginShadows = function () {\n    renderingShadows = true;\n    projectPlanes(null);\n  };\n\n  this.endShadows = function () {\n    renderingShadows = false;\n    resetGlobalState();\n  };\n\n  this.setState = function (material, camera, useCache) {\n    const planes = material.clippingPlanes,\n          clipIntersection = material.clipIntersection,\n          clipShadows = material.clipShadows;\n    const materialProperties = properties.get(material);\n\n    if (!localClippingEnabled || planes === null || planes.length === 0 || renderingShadows && !clipShadows) {\n      // there's no local clipping\n      if (renderingShadows) {\n        // there's no global clipping\n        projectPlanes(null);\n      } else {\n        resetGlobalState();\n      }\n    } else {\n      const nGlobal = renderingShadows ? 0 : numGlobalPlanes,\n            lGlobal = nGlobal * 4;\n      let dstArray = materialProperties.clippingState || null;\n      uniform.value = dstArray; // ensure unique state\n\n      dstArray = projectPlanes(planes, camera, lGlobal, useCache);\n\n      for (let i = 0; i !== lGlobal; ++i) {\n        dstArray[i] = globalState[i];\n      }\n\n      materialProperties.clippingState = dstArray;\n      this.numIntersection = clipIntersection ? this.numPlanes : 0;\n      this.numPlanes += nGlobal;\n    }\n  };\n\n  function resetGlobalState() {\n    if (uniform.value !== globalState) {\n      uniform.value = globalState;\n      uniform.needsUpdate = numGlobalPlanes > 0;\n    }\n\n    scope.numPlanes = numGlobalPlanes;\n    scope.numIntersection = 0;\n  }\n\n  function projectPlanes(planes, camera, dstOffset, skipTransform) {\n    const nPlanes = planes !== null ? planes.length : 0;\n    let dstArray = null;\n\n    if (nPlanes !== 0) {\n      dstArray = uniform.value;\n\n      if (skipTransform !== true || dstArray === null) {\n        const flatSize = dstOffset + nPlanes * 4,\n              viewMatrix = camera.matrixWorldInverse;\n        viewNormalMatrix.getNormalMatrix(viewMatrix);\n\n        if (dstArray === null || dstArray.length < flatSize) {\n          dstArray = new Float32Array(flatSize);\n        }\n\n        for (let i = 0, i4 = dstOffset; i !== nPlanes; ++i, i4 += 4) {\n          plane.copy(planes[i]).applyMatrix4(viewMatrix, viewNormalMatrix);\n          plane.normal.toArray(dstArray, i4);\n          dstArray[i4 + 3] = plane.constant;\n        }\n      }\n\n      uniform.value = dstArray;\n      uniform.needsUpdate = true;\n    }\n\n    scope.numPlanes = nPlanes;\n    scope.numIntersection = 0;\n    return dstArray;\n  }\n}\n};"],
"names":["shadow$provide","global","require","module","exports","Object","defineProperty","value","WebGLClipping","properties","resetGlobalState","uniform","globalState","needsUpdate","numGlobalPlanes","scope","numPlanes","numIntersection","projectPlanes","planes","camera","dstOffset","skipTransform","nPlanes","length","dstArray","flatSize","viewMatrix","matrixWorldInverse","viewNormalMatrix","getNormalMatrix","Float32Array","i","i4","plane","copy","applyMatrix4","normal","toArray","constant","localClippingEnabled","renderingShadows","_Plane","Plane","_Matrix","Matrix3","init","this.init","enableLocalClipping","enabled","beginShadows","this.beginShadows","endShadows","this.endShadows","setState","this.setState","material","useCache","clippingPlanes","clipIntersection","clipShadows","materialProperties","get","nGlobal","lGlobal","clippingState"]
}
