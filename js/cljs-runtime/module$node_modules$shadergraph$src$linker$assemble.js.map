{
"version":3,
"file":"module$node_modules$shadergraph$src$linker$assemble.js",
"lineCount":8,
"mappings":"AAAAA,cAAA,CAAA,mDAAA,CAAwE,QAAQ,CAACC,MAAD,CAAQC,OAAR,CAAgBC,eAAhB,CAAuBC,OAAvB,CAAgC,CAYhHC,QAASA,yBAAwB,CAACC,oBAAD,CAAc,CAAE,GAAuB,UAAvB,GAAI,MAAOC,QAAX,CAAmC,MAAO,KAAM,KAAIC,kBAAoB,IAAID,OAA5B,CAA2CE,iBAAmB,IAAIF,OAAW,OAAO,CAACF,wBAAD,CAA4BA,QAAS,CAACC,WAAD,CAAc,CAAE,MAAOA,YAAA,CAAcG,gBAAd,CAAiCD,iBAA1C,CAAnD,EAAmHF,oBAAnH,CAAtI,CAE/CI,QAASA,wBAAuB,CAACC,GAAD,CAAML,WAAN,CAAmB,CAAE,GAAI,CAACA,WAAL,EAAoBK,GAApB,EAA2BA,GAAIC,CAAAA,UAA/B,CAA6C,MAAOD,IAAO;GAAY,IAAZ,GAAIA,GAAJ,EAAmC,QAAnC,GAAoB,MAAOA,IAA3B,EAA8D,UAA9D,GAA+C,MAAOA,IAAtD,CAA4E,MAAO,CAAEE,QAASF,GAAX,CAAuE,KAA/CG,WAA+C,CAAvCT,wBAAA,CAAyBC,WAAzB,CAAuC,GAAaQ,WAAMC,CAAAA,GAAN,CAAUJ,GAAV,CAAb,CAA+B,MAAOG,YAAME,CAAAA,GAAN,CAAUL,GAAV,CAAkB,KAAIM,OAAS,EAAb,CAAqBC,sBAAwBC,MAAOC,CAAAA,cAA/BF,EAAiDC,MAAOE,CAAAA,wBAA7E,CAAgHC,GAAT,KAASA,GAAT,GAAgBX,IAAhB,CAAuB,GAAY,SAAZ,GAAIW,GAAJ,EAAyBH,MAAOI,CAAAA,SAAUC,CAAAA,cAAeC,CAAAA,IAAhC,CAAqCd,GAArC,CAA0CW,GAA1C,CAAzB,CAAyE,CAAE,IAAII,KAAOR,qBAAA,CAAwBC,MAAOE,CAAAA,wBAAP,CAAgCV,GAAhC,CAAqCW,GAArC,CAAxB,CAAoE,IAAUI,KAAJ,GAAaA,IAAKV,CAAAA,GAAlB,EAAyBU,IAAKC,CAAAA,GAA9B,EAAsCR,MAAOC,CAAAA,cAAP,CAAsBH,MAAtB,CAA8BK,GAA9B;AAAmCI,IAAnC,CAAtC,CAAyFT,MAAA,CAAOK,GAAP,CAAzF,CAAuGX,GAAA,CAAIW,GAAJ,CAA9L,CAA8ML,MAAOJ,CAAAA,OAAP,CAAiBF,GAASG,YAAJ,EAAaA,WAAMa,CAAAA,GAAN,CAAUhB,GAAV,CAAeM,MAAf,CAA0B,OAAOA,OAAxuB,CAXnDE,MAAOC,CAAAA,cAAP,CAAsBhB,OAAtB,CAA+B,YAA/B,CAA6C,CAC3CwB,MAAO,CAAA,CADoC,CAA7C,CAGAxB,QAAQyB,CAAAA,QAAR,CAAmB,IAAK,EAExB,KAAIC,MAAQpB,uBAAA,CAAwBR,OAAA,CAAQ,iDAAR,CAAxB,CAAZ,CAEI6B,SAAWrB,uBAAA,CAAwBR,OAAA,CAAQ,qDAAR,CAAxB,CAqOfE,QAAQyB,CAAAA,QAAR,CA/MiBA,QAAS,CAACG,QAAD,CAAWC,kBAAX,CAAsBC,cAAtB,CAA6BC,QAA7B,CAAuC,CAE/D,MAAMC,UAAY,EAAlB,CACMC,QAAU,EADhB,CAEMC,SAAW,EAFjB,CAGMC;AAAW,EAHjB,CAIMC,WAAa,EAJnB,CAKMC,QAAU,EALhB,CA4DMC,OAASR,KAAAQ,EAAS,CACtB,IAAIC,CAEJT,MAAA,CAAS,CAAA,EAAA,EAAM,CACb,MAAMU,OAAS,EAEf,KAAK,MAAMC,EAAX,GAAiBX,MAAjB,CACES,CACA,CADIT,KAAA,CAAMW,EAAN,CACJ,CAAAD,MAAOE,CAAAA,IAAP,CAAYH,CAAZ,CAGF,OAAOC,OARM,CAAN,CAAD,EAWRV,MAAMa,CAAAA,IAAN,CAAW,CAACC,CAAD,CAAIC,CAAJ,CAAA,EAAUA,CAAEC,CAAAA,QAAZ,CAAuBF,CAAEE,CAAAA,QAApC,CAEA,OAAMzB,KAAO,CAAC0B,IAAD,CAAOhD,MAAP,CAAe+C,QAAf,CAAAzB,EAA4B,CACvC2B,OAAA,CAAQD,IAAR,CAAchD,MAAd,CAAsB+C,QAAtB,CACA,EAAM,CACJ,KAAAG,QADI,CAAN,CAEIlD,MAFJ,CAGA,EAAM,CACJ,MAAAmD,MADI,CAAN,CAEInD,MAFJ,CAQA,OA1Fa6B,SA0FGP,CAAAA,IAAT,CAJS8B,IAAAC,EAAQC,MAAA,CAAON,IAAP,CAAaI,IAAb,CAIjB,CAFWA,IAAAG,EAAQC,UAAA,CAAWR,IAAX,CAAiBI,IAAjB,CAEnB,CAAkCD,MAAlC,CAAyCD,QAAKO,CAAAA,SAA9C,CAAyDC,IAAzD,CAbgC,CAAzC,CAgBMA,KA7FS7B,QA6FO6B,CAAAA,IAAT,EAEb,KAAKlB,CAAL,GAAUmB,MAAMC,CAAAA,IAAN,CAAW7B,KAAX,CAAV,CACET,IAAA,CAAKkB,CAAEQ,CAAAA,IAAP,CAAaR,CAAExC,CAAAA,MAAf,CAAuBwC,CAAEO,CAAAA,QAAzB,CAGF,OAAO,CAACW,IAAD,CAAO3B,KAAP,CAtCe,CA5DxB;AAsGM8B,MAAQA,QAAS,CAAC/B,SAAD,CAAYgC,IAAZ,CAAkBf,QAAlB,CAA4B,CACjD,MAAMgB,OAASzB,OAAA,CAAQR,SAAR,CAEf,OAAc,KAAd,EAAIiC,MAAJ,CACSA,MAAOhB,CAAAA,QADhB,CAC2BnB,QAASoC,CAAAA,GAAT,CAAaD,MAAOhB,CAAAA,QAApB,CAA8BA,QAA9B,CAD3B,CAGST,OAAA,CAAQR,SAAR,CAHT,CAG8B,CAC1BgC,IAD0B,CAE1Bf,QAF0B,CANmB,CAtGnD,CAoHME,QAAUA,QAAS,CAACD,IAAD,CAAOhD,MAAP,CAAe+C,QAAf,CAAyB,CAChD,IAAS5B,GACT4B,SAAA,CAAWnB,QAASqC,CAAAA,IAAT,CAAclB,QAAd,CAEX,KAAK,MAAML,EAAX,GAAiB1C,OAAOsC,CAAAA,OAAxB,CAAiC,CAC/B,MAAM4B,IAAMlE,MAAOsC,CAAAA,OAAP,CAAeI,EAAf,CACZmB,MAAA,CAAMnB,EAAN,CAAUwB,GAAIJ,CAAAA,IAAd,CAAoBlC,QAASuC,CAAAA,IAAT,CAAcpB,QAAd,CAAwBmB,GAAInB,CAAAA,QAA5B,CAApB,CAF+B,CAMjCc,KAAA,CAAM7D,MAAO8B,CAAAA,SAAb,CAAwB9B,MAAO0D,CAAAA,IAA/B,CAAqCX,QAArC,CAEA,KAAK5B,GAAL,GAAYnB,OAAOmC,CAAAA,QAAnB,CACEiC,QACA,CADMpE,MAAOmC,CAAAA,QAAP,CAAgBhB,GAAhB,CACN,CAAAgB,QAAA,CAAShB,GAAT,CAAA,CAAgBiD,QAGlB;IAAKjD,GAAL,GAAYnB,OAAOoC,CAAAA,QAAnB,CACEgC,QACA,CADMpE,MAAOoC,CAAAA,QAAP,CAAgBjB,GAAhB,CACN,CAAAiB,QAAA,CAASjB,GAAT,CAAA,CAAgBiD,QAGlB,KAAKjD,GAAL,GAAYnB,OAAOqC,CAAAA,UAAnB,CACE+B,QACA,CADMpE,MAAOqC,CAAAA,UAAP,CAAkBlB,GAAlB,CACN,CAAAkB,UAAA,CAAWlB,GAAX,CAAA,CAAkBiD,QAGpB,OAAOC,SAAA,CAASrB,IAAT,CAAehD,MAAf,CA3ByC,CApHlD,CAkJMqE,SAAW,CAACrB,IAAD,CAAOhD,MAAP,CAAAqE,EACZ,CACH,MAAM5B,OAAS,EAEf,KAAK,MAAMtB,GAAX,GAAkBwC,MAAMC,CAAAA,IAAN,CAAW5D,MAAOkC,CAAAA,OAAlB,CAAlB,CAA8C,CAC5C,MAAMoC,IAAMtE,MAAOiC,CAAAA,SAAP,CAAiBd,GAAjB,CAEZ,IAAIqC,UAAA,CAAWR,IAAX,CAAiBsB,GAAIlB,CAAAA,IAArB,CAAJ,CAAgC,CAC9B,MAAMmB,KAAO,EAEb,KAAK,MAAMC,CAAX,GAAgBF,IAAhB,CAEEC,IAAA,CAAKC,CAAL,CAAA,CADUF,GAAAG,CAAID,CAAJC,CAIZF,KAAKnB,CAAAA,IAAL,CAAYE,MAAA,CAAON,IAAP,CAAasB,GAAIlB,CAAAA,IAAjB,CACZnB,UAAA,CAAUd,GAAV,CAAA,CAAiBoD,IACjB9B,OAAOE,CAAAA,IAAP,CAAYT,OAAQS,CAAAA,IAAR,CAAaxB,GAAb,CAAZ,CAV8B,CAAhC,IAYEsB,OAAOE,CAAAA,IAAP,CAAY+B,IAAAA,EAAZ,CAf0C,CAH3C,MAsBIjC,OAtBJ,CAnJL;AA6KMe,WAAaA,QAAS,CAACR,IAAD,CAAOI,IAAP,CAAa,CACjCuB,IAAAA,CAAS3B,IAAKnC,CAAAA,GAAL,CAASuC,IAAT,CAEf,IAAIuB,IAAOC,CAAAA,KAAX,GAAqBjD,KAAMkD,CAAAA,EAA3B,CACE,MAAwB,KAAxB,GAAOF,IAAOG,CAAAA,KACT,IAAIH,IAAOC,CAAAA,KAAX,GAAqBjD,KAAMoD,CAAAA,GAA3B,CACL,MAAgC,EAAhC,GAAOJ,IAAOK,CAAAA,MAAOC,CAAAA,MANgB,CA7KzC,CAwLM3B,OAASA,QAAS,CAACN,IAAD,CAAOI,IAAP,CAAa,CAE/BuB,IAAAA,CAAS3B,IAAKnC,CAAAA,GAAL,CAASuC,IAAT,CAEb,IAAI,CAACuB,IAAL,CACE,MAAO,KAGLA,KAAOG,CAAAA,KAAX,GACEH,IADF,CACWA,IAAOG,CAAAA,KADlB,CAIA,EAAC,CACC1B,IADD,CAAD,CAEIuB,IAFJ,CAGA,OAAOA,KAAOO,CAAAA,EAfqB,CAkBrC,OAnMgBC,SAAS,EAAG,CAE1B,IAAIzC,EAEJ,KAAKA,EAAL,GAAWV,SAAX,CAAqB,CACboD,IAAAA,KAAIpD,QAAA,CAASU,EAAT,CACV2B,SAAA,CAASe,IAAEpC,CAAAA,IAAX,CAAiBoC,IAAEpF,CAAAA,MAAnB,CAFmB,CAKrB,CAAC0D,IAAD,CAAO3B,cAAP,CAAA,CAAgB4B,KAAMC,CAAAA,IAAN,CAAWrB,MAAA,CAAOR,cAAP,CAAX,CAEC,KAAjB,EAAID,kBAAJ,GACE4B,IAAKP,CAAAA,KADP,CACerB,kBADf,CAIMoB,KAAAA;AAvBSrB,QAuBOwD,CAAAA,KAAT,CAAe3B,IAAf,CAAqB3B,cAArB,CAab,KAAMuD,SAXU,CAAA,EAAA,EAAM,CACpB,MAAM7C,OAAS,EAEf,KAAKC,EAAL,GAAWJ,QAAX,CAEEG,MAAOE,CAAAA,IAAP,CADYL,OAAA4B,CAAQxB,EAARwB,CACZ,CAGF,OAAOzB,OARa,CAAN,CAAD,EASVG,CAAAA,IATU2C,CASL,CAAC1C,CAAD,CAAIC,CAAJ,CAAA,EAAUlB,QAAS4D,CAAAA,OAAT,CAAiB3C,CAAEE,CAAAA,QAAnB,CAA6BD,CAAEC,CAAAA,QAA/B,CATLwC,CAWSE,CAAAA,GAAP,CAAWC,CAAA,EAAKA,CAAE5B,CAAAA,IAAlB,CACjBwB,SAAS3C,CAAAA,IAAT,CAAcO,IAAKY,CAAAA,IAAnB,CACMA,SAAAA,CAtCSjC,QAsCO8D,CAAAA,KAAT,CAAeL,QAAf,CAEb,OAAO,CACLxD,UAAWoB,IAAKE,CAAAA,IADX,CAELd,OAFK,CAILoB,KAAMR,IAAKY,CAAAA,IAJN,CAMLA,KAAAA,QANK,CAQLZ,KAAAA,IARK,CAULC,MAAOD,IAAKE,CAAAA,IAVP,CAYLlB,OAZK,CAaLD,SAbK,CAcLE,QAdK,CAeLC,QAfK,CAgBLC,UAhBK,CAhCmB,CAmMrB,EA5MwD,CAhC+C;",
"sources":["node_modules/shadergraph/src/linker/assemble.js"],
"sourcesContent":["shadow$provide[\"module$node_modules$shadergraph$src$linker$assemble\"] = function(global,require,module,exports) {\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.assemble = void 0;\n\nvar Graph = _interopRequireWildcard(require(\"../graph\"));\n\nvar Priority = _interopRequireWildcard(require(\"./priority\"));\n\nfunction _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== \"function\") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function (nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }\n\nfunction _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== \"object\" && typeof obj !== \"function\") { return { default: obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\n\n/*\n * decaffeinate suggestions:\n * DS101: Remove unnecessary use of Array.from\n * DS102: Remove unnecessary code created because of implicit returns\n * DS205: Consider reworking code to avoid use of IIFEs\n * DS207: Consider shorter variations of null checks\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/master/docs/suggestions.md\n */\n\n/*\n  Program assembler\n\n  Builds composite program that can act as new module/snippet\n  Unconnected input/outputs and undefined callbacks are exposed in the new global/main scope\n  If there is only one call with an identical call signature, a #define is output instead.\n*/\nconst assemble = function (language, namespace, calls, requires) {\n  const generate = language;\n  const externals = {};\n  const symbols = [];\n  const uniforms = {};\n  const varyings = {};\n  const attributes = {};\n  const library = {};\n\n  const process = function () {\n    let body;\n    let ns;\n\n    for (ns in requires) {\n      const r = requires[ns];\n      required(r.node, r.module);\n    }\n\n    [body, calls] = Array.from(handle(calls));\n\n    if (namespace != null) {\n      body.entry = namespace;\n    }\n\n    const main = generate.build(body, calls);\n\n    const sorted = (() => {\n      const result = [];\n\n      for (ns in library) {\n        const lib = library[ns];\n        result.push(lib);\n      }\n\n      return result;\n    })().sort((a, b) => Priority.compare(a.priority, b.priority));\n\n    const includes = sorted.map(x => x.code);\n    includes.push(main.code);\n    const code = generate.lines(includes); // Build new virtual snippet\n\n    return {\n      namespace: main.name,\n      library,\n      // Included library functions\n      body: main.code,\n      // Snippet body\n      code,\n      // Complete snippet (tests/debug)\n      main,\n      // Function signature\n      entry: main.name,\n      // Entry point name\n      symbols,\n      externals,\n      uniforms,\n      varyings,\n      attributes\n    };\n  }; // Sort and process calls\n\n\n  const handle = calls => {\n    let c;\n\n    calls = (() => {\n      const result = [];\n\n      for (const ns in calls) {\n        c = calls[ns];\n        result.push(c);\n      }\n\n      return result;\n    })();\n\n    calls.sort((a, b) => b.priority - a.priority); // Call module in DAG chain\n\n    const call = (node, module, priority) => {\n      include(node, module, priority);\n      const {\n        main\n      } = module;\n      const {\n        entry\n      } = module;\n\n      const _lookup = name => lookup(node, name);\n\n      const _dangling = name => isDangling(node, name);\n\n      return generate.call(_lookup, _dangling, entry, main.signature, body);\n    };\n\n    const body = generate.body();\n\n    for (c of Array.from(calls)) {\n      call(c.node, c.module, c.priority);\n    }\n\n    return [body, calls];\n  }; // Adopt given code as a library at given priority\n\n\n  const adopt = function (namespace, code, priority) {\n    const record = library[namespace];\n\n    if (record != null) {\n      return record.priority = Priority.max(record.priority, priority);\n    } else {\n      return library[namespace] = {\n        code,\n        priority\n      };\n    }\n  }; // Include snippet for a call\n\n\n  const include = function (node, module, priority) {\n    let def, key;\n    priority = Priority.make(priority); // Adopt snippet's libraries\n\n    for (const ns in module.library) {\n      const lib = module.library[ns];\n      adopt(ns, lib.code, Priority.nest(priority, lib.priority));\n    } // Adopt snippet body as library\n\n\n    adopt(module.namespace, module.body, priority); // Adopt GL vars\n\n    for (key in module.uniforms) {\n      def = module.uniforms[key];\n      uniforms[key] = def;\n    }\n\n    for (key in module.varyings) {\n      def = module.varyings[key];\n      varyings[key] = def;\n    }\n\n    for (key in module.attributes) {\n      def = module.attributes[key];\n      attributes[key] = def;\n    }\n\n    return required(node, module);\n  };\n\n  const required = (node, module // Adopt external symbols\n  ) => (() => {\n    const result = [];\n\n    for (const key of Array.from(module.symbols)) {\n      const ext = module.externals[key];\n\n      if (isDangling(node, ext.name)) {\n        const copy = {};\n\n        for (const k in ext) {\n          const v = ext[k];\n          copy[k] = v;\n        }\n\n        copy.name = lookup(node, ext.name);\n        externals[key] = copy;\n        result.push(symbols.push(key));\n      } else {\n        result.push(undefined);\n      }\n    }\n\n    return result;\n  })(); // Check for dangling input/output\n\n\n  const isDangling = function (node, name) {\n    const outlet = node.get(name);\n\n    if (outlet.inout === Graph.IN) {\n      return outlet.input === null;\n    } else if (outlet.inout === Graph.OUT) {\n      return outlet.output.length === 0;\n    }\n  }; // Look up unique name for outlet\n\n\n  const lookup = function (node, name) {\n    // Traverse graph edge\n    let outlet = node.get(name);\n\n    if (!outlet) {\n      return null;\n    }\n\n    if (outlet.input) {\n      outlet = outlet.input;\n    }\n\n    ({\n      name\n    } = outlet);\n    return outlet.id;\n  };\n\n  return process();\n};\n\nexports.assemble = assemble;\n};"],
"names":["shadow$provide","global","require","module","exports","_getRequireWildcardCache","nodeInterop","WeakMap","cacheBabelInterop","cacheNodeInterop","_interopRequireWildcard","obj","__esModule","default","cache","has","get","newObj","hasPropertyDescriptor","Object","defineProperty","getOwnPropertyDescriptor","key","prototype","hasOwnProperty","call","desc","set","value","assemble","Graph","Priority","language","namespace","calls","requires","externals","symbols","uniforms","varyings","attributes","library","handle","c","result","ns","push","sort","a","b","priority","node","include","main","entry","name","_lookup","lookup","_dangling","isDangling","signature","body","Array","from","adopt","code","record","max","make","lib","nest","def","required","ext","copy","k","v","undefined","outlet","inout","IN","input","OUT","output","length","id","process","r","build","includes","sorted","compare","map","x","lines"]
}
