shadow$provide.module$node_modules$css_what$lib$commonjs$parse=function(global,require,module,exports){function isTraversal(selector){switch(selector.type){case types_1.SelectorType.Adjacent:case types_1.SelectorType.Child:case types_1.SelectorType.Descendant:case types_1.SelectorType.Parent:case types_1.SelectorType.Sibling:case types_1.SelectorType.ColumnCombinator:return!0;default:return!1}}function funescape(_,escaped,escapedWhitespace){_=parseInt(escaped,16)-65536;return _!==_||escapedWhitespace?
escaped:0>_?String.fromCharCode(_+65536):String.fromCharCode(_>>10|55296,_&1023|56320)}function isQuote(c){return 39===c||34===c}function isWhitespace(c){return 32===c||9===c||10===c||12===c||13===c}function parseSelector(subselects,selector,selectorIndex){function getName(offset){var match=selector.slice(selectorIndex+offset).match(reName);if(!match)throw Error("Expected name, found ".concat(selector.slice(selectorIndex)));match=match[0];selectorIndex+=offset+match.length;return match.replace(reEscape,
funescape)}function stripWhitespace(offset){for(selectorIndex+=offset;selectorIndex<selector.length&&isWhitespace(selector.charCodeAt(selectorIndex));)selectorIndex++}function readValueWithParenthesis(){for(var start=selectorIndex+=1,counter=1;0<counter&&selectorIndex<selector.length;selectorIndex++)40!==selector.charCodeAt(selectorIndex)||isEscaped(selectorIndex)?41!==selector.charCodeAt(selectorIndex)||isEscaped(selectorIndex)||counter--:counter++;if(counter)throw Error("Parenthesis not matched");
return selector.slice(start,selectorIndex-1).replace(reEscape,funescape)}function isEscaped(pos){for(var slashCount=0;92===selector.charCodeAt(--pos);)slashCount++;return 1===(slashCount&1)}function ensureNotTraversal(){if(0<tokens.length&&isTraversal(tokens[tokens.length-1]))throw Error("Did not expect successive traversals.");}function addTraversal(type){0<tokens.length&&tokens[tokens.length-1].type===types_1.SelectorType.Descendant?tokens[tokens.length-1].type=type:(ensureNotTraversal(),tokens.push({type}))}
function addSpecialAttribute(name,action){tokens.push({type:types_1.SelectorType.Attribute,name,action,value:getName(1),namespace:null,ignoreCase:"quirks"})}function finalizeSubselector(){tokens.length&&tokens[tokens.length-1].type===types_1.SelectorType.Descendant&&tokens.pop();if(0===tokens.length)throw Error("Empty sub-selector");subselects.push(tokens)}var tokens=[];stripWhitespace(0);if(selector.length===selectorIndex)return selectorIndex;a:for(;selectorIndex<selector.length;){var firstChar=
selector.charCodeAt(selectorIndex);switch(firstChar){case 32:case 9:case 10:case 12:case 13:if(0===tokens.length||tokens[0].type!==types_1.SelectorType.Descendant)ensureNotTraversal(),tokens.push({type:types_1.SelectorType.Descendant});stripWhitespace(1);break;case 62:addTraversal(types_1.SelectorType.Child);stripWhitespace(1);break;case 60:addTraversal(types_1.SelectorType.Parent);stripWhitespace(1);break;case 126:addTraversal(types_1.SelectorType.Sibling);stripWhitespace(1);break;case 43:addTraversal(types_1.SelectorType.Adjacent);
stripWhitespace(1);break;case 46:addSpecialAttribute("class",types_1.AttributeAction.Element);break;case 35:addSpecialAttribute("id",types_1.AttributeAction.Equals);break;case 91:stripWhitespace(1);firstChar=void 0;var namespace=null;124===selector.charCodeAt(selectorIndex)?firstChar=getName(1):selector.startsWith("*|",selectorIndex)?(namespace="*",firstChar=getName(2)):(firstChar=getName(0),124===selector.charCodeAt(selectorIndex)&&61!==selector.charCodeAt(selectorIndex+1)&&(namespace=firstChar,
firstChar=getName(1)));stripWhitespace(0);var action$jscomp$0=types_1.AttributeAction.Exists,possibleAction=actionTypes.get(selector.charCodeAt(selectorIndex));if(possibleAction){action$jscomp$0=possibleAction;if(61!==selector.charCodeAt(selectorIndex+1))throw Error("Expected `\x3d`");stripWhitespace(2)}else 61===selector.charCodeAt(selectorIndex)&&(action$jscomp$0=types_1.AttributeAction.Equals,stripWhitespace(1));var value="";possibleAction=null;if("exists"!==action$jscomp$0){if(isQuote(selector.charCodeAt(selectorIndex))){value=
selector.charCodeAt(selectorIndex);for(var sectionEnd=selectorIndex+1;sectionEnd<selector.length&&(selector.charCodeAt(sectionEnd)!==value||isEscaped(sectionEnd));)sectionEnd+=1;if(selector.charCodeAt(sectionEnd)!==value)throw Error("Attribute value didn't end");value=selector.slice(selectorIndex+1,sectionEnd).replace(reEscape,funescape);selectorIndex=sectionEnd+1}else{for(value=selectorIndex;selectorIndex<selector.length&&(!isWhitespace(selector.charCodeAt(selectorIndex))&&93!==selector.charCodeAt(selectorIndex)||
isEscaped(selectorIndex));)selectorIndex+=1;value=selector.slice(value,selectorIndex).replace(reEscape,funescape)}stripWhitespace(0);sectionEnd=selector.charCodeAt(selectorIndex)|32;115===sectionEnd?(possibleAction=!1,stripWhitespace(1)):105===sectionEnd&&(possibleAction=!0,stripWhitespace(1))}if(93!==selector.charCodeAt(selectorIndex))throw Error("Attribute selector didn't terminate");selectorIndex+=1;tokens.push({type:types_1.SelectorType.Attribute,name:firstChar,action:action$jscomp$0,value,namespace,
ignoreCase:possibleAction});break;case 58:if(58===selector.charCodeAt(selectorIndex+1)){tokens.push({type:types_1.SelectorType.PseudoElement,name:getName(2).toLowerCase(),data:40===selector.charCodeAt(selectorIndex)?readValueWithParenthesis():null});continue}namespace=getName(1).toLowerCase();firstChar=null;if(40===selector.charCodeAt(selectorIndex))if(unpackPseudos.has(namespace)){if(isQuote(selector.charCodeAt(selectorIndex+1)))throw Error("Pseudo-selector ".concat(namespace," cannot be quoted"));
firstChar=[];selectorIndex=parseSelector(firstChar,selector,selectorIndex+1);if(41!==selector.charCodeAt(selectorIndex))throw Error("Missing closing parenthesis in :".concat(namespace," (").concat(selector,")"));selectorIndex+=1}else firstChar=readValueWithParenthesis(),stripQuotesFromPseudos.has(namespace)&&(action$jscomp$0=firstChar.charCodeAt(0),action$jscomp$0===firstChar.charCodeAt(firstChar.length-1)&&isQuote(action$jscomp$0)&&(firstChar=firstChar.slice(1,-1))),firstChar=firstChar.replace(reEscape,
funescape);tokens.push({type:types_1.SelectorType.Pseudo,name:namespace,data:firstChar});break;case 44:finalizeSubselector();tokens=[];stripWhitespace(1);break;default:if(selector.startsWith("/*",selectorIndex)){namespace=selector.indexOf("*/",selectorIndex+2);if(0>namespace)throw Error("Comment was not terminated");selectorIndex=namespace+2;0===tokens.length&&stripWhitespace(0)}else{namespace=null;action$jscomp$0=void 0;if(42===firstChar)selectorIndex+=1,action$jscomp$0="*";else if(124===firstChar){if(action$jscomp$0=
"",124===selector.charCodeAt(selectorIndex+1)){addTraversal(types_1.SelectorType.ColumnCombinator);stripWhitespace(2);break}}else if(reName.test(selector.slice(selectorIndex)))action$jscomp$0=getName(0);else break a;124===selector.charCodeAt(selectorIndex)&&124!==selector.charCodeAt(selectorIndex+1)&&(namespace=action$jscomp$0,42===selector.charCodeAt(selectorIndex+1)?(action$jscomp$0="*",selectorIndex+=2):action$jscomp$0=getName(1));tokens.push("*"===action$jscomp$0?{type:types_1.SelectorType.Universal,
namespace}:{type:types_1.SelectorType.Tag,name:action$jscomp$0,namespace})}}}finalizeSubselector();return selectorIndex}Object.defineProperty(exports,"__esModule",{value:!0});exports.parse=exports.isTraversal=void 0;var types_1=require("module$node_modules$css_what$lib$commonjs$types"),reName=/^[^\\#]?(?:\\(?:[\da-f]{1,6}\s?|.)|[\w\-\u00b0-\uFFFF])+/,reEscape=/\\([\da-f]{1,6}\s?|(\s)|.)/gi,actionTypes=new Map([[126,types_1.AttributeAction.Element],[94,types_1.AttributeAction.Start],[36,types_1.AttributeAction.End],
[42,types_1.AttributeAction.Any],[33,types_1.AttributeAction.Not],[124,types_1.AttributeAction.Hyphen]]),unpackPseudos=new Set("has not matches is where host host-context".split(" "));exports.isTraversal=isTraversal;var stripQuotesFromPseudos=new Set(["contains","icontains"]);exports.parse=function(selector){var subselects=[],endIndex=parseSelector(subselects,"".concat(selector),0);if(endIndex<selector.length)throw Error("Unmatched selector: ".concat(selector.slice(endIndex)));return subselects}}
//# sourceMappingURL=module$node_modules$css_what$lib$commonjs$parse.js.map
