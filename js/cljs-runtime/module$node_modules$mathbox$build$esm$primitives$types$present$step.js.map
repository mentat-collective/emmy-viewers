{
"version":3,
"file":"module$node_modules$mathbox$build$esm$primitives$types$present$step.js",
"lineCount":5,
"mappings":"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",
"sources":["node_modules/mathbox/build/esm/primitives/types/present/step.js"],
"sourcesContent":["shadow$provide[\"module$node_modules$mathbox$build$esm$primitives$types$present$step\"] = function(global,require,module,exports) {\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Step = void 0;\n\nvar _track = require(\"./track.js\");\n\n// TODO: This file was created by bulk-decaffeinate.\n// Sanity-check the conversion and remove this comment.\n\n/*\n * decaffeinate suggestions:\n * DS101: Remove unnecessary use of Array.from\n * DS102: Remove unnecessary code created because of implicit returns\n * DS104: Avoid inline assignments\n * DS206: Consider reworking classes to avoid initClass\n * DS207: Consider shorter variations of null checks\n * Full docs: https://github.com/decaffeinate/decaffeinate/blob/master/docs/suggestions.md\n */\nclass Step extends _track.Track {\n  static initClass() {\n    this.traits = [\"node\", \"track\", \"step\", \"trigger\", \"bind\"];\n  }\n\n  make() {\n    super.make();\n\n    const clock = this._inherit(\"clock\");\n\n    if (this.actualIndex == null) {\n      this.actualIndex = null;\n    }\n\n    this.animateIndex = this._animator.make(this._types.number(0), {\n      clock,\n      realtime: this.props.realtime,\n      step: value => {\n        return this.actualIndex = value;\n      }\n    });\n\n    if (this.lastIndex == null) {\n      this.lastIndex = null;\n    }\n\n    this.animateStep = this._animator.make(this._types.number(0), {\n      clock,\n      realtime: this.props.realtime,\n      step: value => {\n        this.playhead = value;\n        return this.update();\n      }\n    });\n    this.stops = this.props.stops != null ? this.props.stops : __range__(0, this.script.length, false); // Seek instantly after reset\n\n    this._listen(\"slide\", \"slide.reset\", _e => {\n      return this.lastIndex = null;\n    }); // Update playhead in response to slide change\n\n\n    return this._listen(\"slide\", \"slide.step\", e => {\n      let left;\n      let {\n        duration\n      } = this.props;\n      const {\n        delay,\n        pace,\n        speed,\n        playback,\n        rewind,\n        skip,\n        trigger\n      } = this.props; // Note: enter phase is from index 0 to 1\n\n      const i = Math.max(0, Math.min(this.stops.length - 1, e.index - trigger)); // Animation range\n\n      const from = this.playhead;\n      const to = this.stops[i]; // Seek if first step after reset\n\n      if (this.lastIndex == null && trigger) {\n        this.lastIndex = i;\n        this.animateStep.set(to);\n        this.animateIndex.set(i);\n        return;\n      } // Calculate actual step from current offset (may be still animating)\n\n\n      let last = (left = this.actualIndex != null ? this.actualIndex : this.lastIndex) != null ? left : 0;\n      const step = i - last; // Don't count duped stops\n\n      const skips = this.stops.slice(Math.min(last, i), Math.max(last, i));\n      let free = 0;\n      last = skips.shift();\n\n      for (const stop of Array.from(skips)) {\n        if (last === stop) {\n          free++;\n        }\n\n        last = stop;\n      } // Remember last intended stop\n\n\n      this.lastIndex = i; // Apply rewind factor\n\n      let factor = speed * (e.step >= 0 ? 1 : rewind); // Pass through multiple steps at faster rate if skip is enabled\n\n      factor *= skip ? Math.max(1, Math.abs(step) - free) : 1; // Apply pace\n\n      duration += Math.abs(to - from) * pace / factor;\n\n      if (from !== to) {\n        this.animateIndex.immediate(i, {\n          delay,\n          duration,\n          ease: playback\n        });\n        return this.animateStep.immediate(to, {\n          delay,\n          duration,\n          ease: playback\n        });\n      }\n    });\n  }\n\n  made() {\n    return this.update();\n  }\n\n  unmake() {\n    this.animateIndex.dispose();\n    this.animateStep.dispose();\n    this.animateIndex = this.animateStep = null;\n    return super.unmake();\n  }\n\n  change(changed, touched, init) {\n    if (changed[\"step.stops\"] || changed[\"step.realtime\"]) {\n      return this.rebuild();\n    }\n\n    return super.change(changed, touched, init);\n  }\n\n}\n\nexports.Step = Step;\nStep.initClass();\n\nfunction __range__(left, right, inclusive) {\n  const range = [];\n  const ascending = left < right;\n  const end = !inclusive ? right : ascending ? right + 1 : right - 1;\n\n  for (let i = left; ascending ? i < end : i > end; ascending ? i++ : i--) {\n    range.push(i);\n  }\n\n  return range;\n}\n};"],
"names":["shadow$provide","global","require","module","exports","__range__","left","right","inclusive","range","ascending","end","i","push","Object","defineProperty","value","Step","_track","Track","initClass","traits","make","clock","_inherit","actualIndex","animateIndex","_animator","_types","number","realtime","props","step","lastIndex","animateStep","playhead","update","stops","script","length","_listen","_e","e","duration","delay","pace","speed","playback","rewind","skip","trigger","Math","max","min","index","from","to","set","last","skips","slice","free","shift","stop","Array","factor","abs","immediate","ease","made","unmake","dispose","change","changed","touched","init","rebuild"]
}
