{"version":3,"sources":["demo/jsxgraph.cljs"],"mappings":"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","names":["demo.jsxgraph/to-fixed","x","p","js/module$node_modules$$mentatcollective$jsxgraph$src$index.default","var_args","args__4870__auto__","len__4864__auto__","i__4865__auto__","argseq__4871__auto__","cljs.core/IndexedSeq","demo.jsxgraph/JSXGraph","p__77410","map__77411","cljs.core/--destructure-map","cljs.core.get","seq77404","G__77406","cljs.core/first","cljs.core/next","self__4851__auto__","id","style","_","!board","reagent.core.atom","!force","cljs.core.atom","or__4253__auto__","Math/random","kill!","board","init!","props","cljs.core/clj->js","temp__5753__auto__","ref","reagent.core.create_class","this","js/console.log","cljs.core/reset!","reagent.core/props","_this","cljs.core.swap_BANG_","old-argv","old-props","cljs.core/second","cljs.core/map?","new-props","cljs.core._EQ_","old-board","cljs.core/deref","reagent.core/current-component","children","reagent.core/children","extras","cljs.core/inc","cljs.core.into","cljs.core.map","p__77417","vec__77418","seq__77419","cljs.core/seq","first__77420","a","more","demo.jsxgraph/add-item!","name","elems","cljs.core.dissoc","f","point","demo.jsxgraph/element","_props","_elems","!item","mount!","_old-argv","vec__77421","cljs.core.nth","reagent.core/argv","item","vec__77424","demo.jsxgraph/Angle","demo.jsxgraph/Arc","demo.jsxgraph/Arrow","demo.jsxgraph/ArrowParallel","demo.jsxgraph/Axis","demo.jsxgraph/Bisector","demo.jsxgraph/Bisectorlines","demo.jsxgraph/Boxplot","demo.jsxgraph/Button","demo.jsxgraph/CardinalSpline","demo.jsxgraph/Chart","demo.jsxgraph/Checkbox","demo.jsxgraph/Circle","demo.jsxgraph/Circumcenter","demo.jsxgraph/Circumcircle","demo.jsxgraph/CircumcircleArc","demo.jsxgraph/CircumcircleSector","demo.jsxgraph/Comb","demo.jsxgraph/Conic","demo.jsxgraph/Curve","demo.jsxgraph/Curve3D","demo.jsxgraph/CurveDifference","demo.jsxgraph/CurveIntersection","demo.jsxgraph/CurveUnion","demo.jsxgraph/Derivative","demo.jsxgraph/Ellipse","demo.jsxgraph/ForeignObject","demo.jsxgraph/FunctionGraph","demo.jsxgraph/FunctionGraph3D","demo.jsxgraph/Glider","demo.jsxgraph/Grid","demo.jsxgraph/Group","demo.jsxgraph/Hatch","demo.jsxgraph/Hyperbola","demo.jsxgraph/Image","demo.jsxgraph/Incenter","demo.jsxgraph/Incircle","demo.jsxgraph/Inequality","demo.jsxgraph/Input","demo.jsxgraph/Integral","demo.jsxgraph/Intersection","demo.jsxgraph/Label","demo.jsxgraph/Legend","demo.jsxgraph/Line","demo.jsxgraph/Line3D","demo.jsxgraph/Locus","demo.jsxgraph/MajorArc","demo.jsxgraph/MajorSector","demo.jsxgraph/MetapostSpline","demo.jsxgraph/Midpoint","demo.jsxgraph/MinorArc","demo.jsxgraph/MinorSector","demo.jsxgraph/MirrorElement","demo.jsxgraph/MirrorPoint","demo.jsxgraph/NonReflexAngle","demo.jsxgraph/Normal","demo.jsxgraph/OrthogonalProjection","demo.jsxgraph/OtherIntersection","demo.jsxgraph/Parabola","demo.jsxgraph/Parallel","demo.jsxgraph/ParallelPoint","demo.jsxgraph/ParametricSurface3D","demo.jsxgraph/Perpendicular","demo.jsxgraph/PerpendicularPoint","demo.jsxgraph/PerpendicularSegment","demo.jsxgraph/Point","demo.jsxgraph/Point3D","demo.jsxgraph/PolarLine","demo.jsxgraph/PolePoint","demo.jsxgraph/Polygon","demo.jsxgraph/PolygonalChain","demo.jsxgraph/RadicalAxis","demo.jsxgraph/Reflection","demo.jsxgraph/ReflexAngle","demo.jsxgraph/RegularPolygon","demo.jsxgraph/RiemannSum","demo.jsxgraph/Sector","demo.jsxgraph/Segment","demo.jsxgraph/Semicircle","demo.jsxgraph/Slider","demo.jsxgraph/SlopeTriangle","demo.jsxgraph/Spline","demo.jsxgraph/StepFunction","demo.jsxgraph/Tangent","demo.jsxgraph/TapeMeasure","demo.jsxgraph/Text","demo.jsxgraph/Ticks","demo.jsxgraph/TraceCurve","demo.jsxgraph/Transformation","demo.jsxgraph/Turtle","demo.jsxgraph/View3D","p__77433","map__77434","demo.jsxgraph/Multi","n","m","i->c","i","vec__77438","seq__77439","first__77440","component","cljs.core.range","demo.jsxgraph/PointLine","cljs.core.assoc"],"sourcesContent":["(ns demo.jsxgraph\n  \"Eventually this will contain wrapper forms for jsxgraph. For now ignore the\n  reactish part and just blow away the full jsxgraph whenever the input\n  change.\n\n  This is currently using my fork of jsxgraph at\n  https://github.com/sritchie/jsxgraph and published to\n  https://www.npmjs.com/package/@mentatcollective/jsxgraph, but these changes\n  should appear upstream soon and we can back off to the official library.\"\n  (:require [\"@mentatcollective/jsxgraph\" :default jsx]\n            [reagent.core :as re :include-macros true]))\n\n;; Utilities\n\n(defn to-fixed [x p]\n  (.toFixed jsx x p))\n\n;; TODO extract various event handlers and attached\n;;\n;; TODO probably ALSO switch the order so that props always come first, THEN parents.\n\n;; Components\n\n(defn JSXGraph\n  \"TODO note that you can either add children etc... OR you can supply a ref that\n  just does all of this crap for you.\n\n  TODO can I have a component that just messes with the board itself?\"\n  [{:keys [id style]} & _]\n  (let [!board  (re/atom nil)\n        !force  (atom 0)\n        id (or id (-> (Math/random)\n                      (.toString 36)\n                      (.substr 2 9)))\n        style (or style {:height \"400px\" :width \"100%\"})\n        kill! (fn [board]\n                (.suspendUpdate board)\n                (-> (.-JSXGraph jsx) (.freeBoard board))\n                nil)\n        init! (fn [props]\n                (let [board (-> (.-JSXGraph jsx)\n                                (.initBoard id (clj->js props)))]\n                  ;; initialize.\n                  (when-let [ref (:ref props)]\n                    (ref board))\n                  board))]\n    (re/create-class\n     {:display-name  \"JSXGraph\"\n\n      ;;called after render.\n      :component-did-mount\n      (fn [this]\n        (js/console.log \"board mounted\")\n        (reset! !board (init! (re/props this))))\n\n      :component-will-unmount\n      (fn [_this]\n        (js/console.log \"bye bye board\")\n        (swap! !board kill!))\n\n      ;; Update if the props change. Not so bad!!\n      :component-did-update\n      (fn [this old-argv]\n        (js/console.log \"board-did-update\")\n        (let [old-props (let [p (second old-argv)]\n                          (if (map? p) p {}))\n              new-props (or (re/props this) {})]\n          (when-not (= old-props new-props)\n            (js/console.log (str \"board resetting!\"))\n            (swap! !board (fn [old-board]\n                            (when old-board (kill! old-board))\n                            (init! new-props))))))\n\n      :reagent-render\n      (fn [& _]\n        (let [this     (re/current-component)\n              children (re/children this)\n              extras   {:board @!board :force @!force}]\n          (js/console.log \"rendering board\")\n          ;; TODO note that this trick is forcing the children to re-render\n          ;; basically every single time. We are using react as a hack here :)\n          ;;\n          ;; But this means that, for now, you can't be updating this stuff with\n          ;; changing properties. You need to use a function that is going to\n          ;; access some state. That should be fine!\n          (swap! !force inc)\n          (into [:div {:id id :style style}]\n                (map\n                 (fn [[a props & more]]\n                   (if (map? props)\n                     (into [a (into props extras)] more)\n                     (into [a extras props] more))))\n                children)))})))\n\n(defn add-item! [name board elems props]\n  (let [p (.create board\n                   name\n                   (clj->js elems)\n                   (clj->js (dissoc props :board)))]\n    ;; Okay, SO, we can definitely get updates. but we want to UNREGISTER these\n    ;; if we can when the element gets taken out of commission.\n    #_(if-let [coords (.-coords p)]\n        (.on coords \"update\" (fn [_] (js/console.log (str (pr-str props) name \" coords update fired\"))))\n        (.on board \"update\" (fn [_] (js/console.log (str (.getType p) \" update fired\")))))\n\n    ;; TODO what are the possible events for OTHER types??\n    (when-let [f (props :on-drag)]\n\n      ;; events can be\n      ;; drag, mousedrag, touchdrag\n      ;; move, mousemove, touchmove\n      ;; over, mouseover\n      ;; out, mouseout\n      ;; up, mouseup, touchend\n      ;; down, mousedown, touchstart\n      (.on p \"drag\" (fn [_]\n                      (this-as point\n                        (f point)))))\n    p))\n\n(defn element [name]\n  (fn [_props _elems]\n    (let [!item (atom nil)\n          mount!\n          (fn [this _old-argv]\n            (let [[_ props elems] (re/argv this)]\n              (when-let [board (:board props)]\n                (swap! !item\n                       (fn [item]\n                         (when item\n                           (.removeObject board item))\n                         (add-item! name board elems props))))))]\n      (re/create-class\n       {:display-name name\n        :component-did-mount mount!\n        :component-did-update mount!\n        :component-will-unmount\n        (fn [this]\n          (let [[_ props] (re/argv this)]\n            (when-let [board (:board props)]\n              (swap! !item\n                     (fn [item]\n                       (when item\n                         (.removeObject board item))\n                       nil)))))\n        :reagent-render\n        (fn [_props _elems] nil)}))))\n\n;; ## Elements\n;;\n;; see `ElementType` in index.d.ts.\n\n(def Angle (element \"angle\"))\n(def Arc (element \"arc\"))\n(def Arrow (element \"arrow\"))\n(def ArrowParallel (element \"arrowparallel\"))\n(def Axis (element \"axis\"))\n(def Bisector (element \"bisector\"))\n(def Bisectorlines (element \"bisectorlines\"))\n(def Boxplot (element \"boxplot\"))\n(def Button (element \"button\"))\n(def CardinalSpline (element \"cardinalspline\"))\n(def Chart (element \"chart\"))\n(def Checkbox (element \"checkbox\"))\n(def Circle (element \"circle\"))\n(def Circumcenter (element \"circumcenter\"))\n(def Circumcircle (element \"circumcircle\"))\n(def CircumcircleArc (element \"Circumcirclearc\"))\n(def CircumcircleSector (element \"Circumcirclesector\"))\n(def Comb (element \"comb\"))\n(def Conic (element \"conic\"))\n(def Curve (element \"curve\"))\n(def Curve3D (element \"Curve3d\"))\n(def CurveDifference (element \"Curvedifference\"))\n(def CurveIntersection (element \"Curveintersection\"))\n(def CurveUnion (element \"Curveunion\"))\n(def Derivative (element \"derivative\"))\n(def Ellipse (element \"ellipse\"))\n(def ForeignObject (element \"Foreignobject\"))\n(def FunctionGraph (element \"functiongraph\"))\n(def FunctionGraph3D (element \"Functiongraph3d\"))\n(def Glider (element \"glider\"))\n(def Grid (element \"grid\"))\n(def Group (element \"group\"))\n(def Hatch (element \"hatch\"))\n(def Hyperbola (element \"hyperbola\"))\n(def Image (element \"image\"))\n(def Incenter (element \"incenter\"))\n(def Incircle (element \"incircle\"))\n(def Inequality (element \"inequality\"))\n(def Input (element \"input\"))\n(def Integral (element \"integral\"))\n(def Intersection (element \"intersection\"))\n(def Label (element \"label\"))\n(def Legend (element \"legend\"))\n(def Line (element \"line\"))\n(def Line3D (element \"Line3d\"))\n(def Locus (element \"locus\"))\n(def MajorArc (element \"Majorarc\"))\n(def MajorSector (element \"Majorsector\"))\n(def MetapostSpline (element \"metapostspline\"))\n(def Midpoint (element \"midpoint\"))\n(def MinorArc (element \"Minorarc\"))\n(def MinorSector (element \"Minorsector\"))\n(def MirrorElement (element \"mirrorelement\"))\n(def MirrorPoint (element \"mirrorpoint\"))\n(def NonReflexAngle (element \"NonReflexangle\"))\n(def Normal (element \"normal\"))\n(def OrthogonalProjection (element \"orthogonalprojection\"))\n(def OtherIntersection (element \"Otherintersection\"))\n(def Parabola (element \"parabola\"))\n(def Parallel (element \"parallel\"))\n(def ParallelPoint (element \"parallelpoint\"))\n(def ParametricSurface3D (element \"ParametricSurface3d\"))\n(def Perpendicular (element \"perpendicular\"))\n(def PerpendicularPoint (element \"Perpendicularpoint\"))\n(def PerpendicularSegment (element \"Perpendicularsegment\"))\n(def Point (element \"point\"))\n(def Point3D (element \"Point3d\"))\n(def PolarLine (element \"Polarline\"))\n(def PolePoint (element \"Polepoint\"))\n(def Polygon (element \"polygon\"))\n(def PolygonalChain (element \"Polygonalchain\"))\n(def RadicalAxis (element \"Radicalaxis\"))\n(def Reflection (element \"reflection\"))\n(def ReflexAngle (element \"Reflexangle\"))\n(def RegularPolygon (element \"Regularpolygon\"))\n(def RiemannSum (element \"riemannsum\"))\n(def Sector (element \"sector\"))\n(def Segment (element \"segment\"))\n(def Semicircle (element \"semicircle\"))\n(def Slider (element \"slider\"))\n(def SlopeTriangle (element \"slopetriangle\"))\n(def Spline (element \"spline\"))\n(def StepFunction (element \"stepfunction\"))\n(def Tangent (element \"tangent\"))\n(def TapeMeasure (element \"tapemeasure\"))\n(def Text (element \"text\"))\n(def Ticks (element \"ticks\"))\n(def TraceCurve (element \"tracecurve\"))\n(def Transformation (element \"transformation\"))\n(def Turtle (element \"turtle\"))\n(def View3D (element \"view3D\"))\n\n;; ## Extensions\n;;\n;; TODO handle :<> in the children update for the board?? otherwise we can't use\n;; that without this trick.\n\n(defn Multi [{:keys [n] :or {n 1} :as m} i->c]\n  (letfn [(f [i]\n            (let [[component props & more] (i->c i)]\n              (into [component (into m props)] more)))]\n    (into [:<>] (map f) (range n))))\n\n(defn PointLine\n  \"Annoyingly, if you want to make NEW components that wrap the others, you need\n  to be careful about passing along props down the line.\n\n  ```\n  [jsx/PointLine {} 3]\n  ```\"\n  [props x]\n  (letfn [(f [i]\n            [Point [(- i) i] (assoc props :name (str i) :strokecolor \"red\")])]\n    (into [:<>] (map f) (range x))))\n\n;; TODO\n;;\n;; - add jsxgraph prefix to my special keywords like board, etc so they don't clash, counter too.\n;; - document the madness\n;; - rebuild one of the Sam Zhang essays using mathbox and jsxgraph. Get some!\n"]}